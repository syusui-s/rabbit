import{s as z,t as f,d as I,c as U,i as n,a as l,h as k,u as S,j as L,F,aB as ae,b as R,f as T,aC as t,aD as te,n as re,aE as ce,aF as de,aG as ue,r as fe,y as ge,aH as me,aI as pe,ag as be}from"./index-CbXZld-o.js";import{A as $e}from"./arrow-left-PF39QuaU.js";import{y as he,z as ve,U as ne,X as N,b as ye,f as _e,g as le,m as xe,i as we,P as ke,F as Ce}from"./SideBar-QP03rlVs.js";import{B as oe}from"./BasicModal-B9d-jVDT.js";import{L as X,E as Se}from"./EventDisplay-B_C4ZLJn.js";import{S as J}from"./SafeLink-DlGj2HXs.js";import{s as je}from"./url-DPIb-kBm.js";import"./resolveAsset-0WSS-QY2.js";const Ee=f('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12c1.292 4.338 5.31 7.5 10.066 7.5.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88">'),Ie=(r={})=>(()=>{const e=Ee();return z(e,r,!0),e})(),Re=f('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128m0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42">'),Le=(r={})=>(()=>{const e=Re();return z(e,r,!0),e})(),Fe=f('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M5.25 14.25h13.5m-13.5 0a3 3 0 0 1-3-3m3 3a3 3 0 1 0 0 6h13.5a3 3 0 1 0 0-6m-16.5-3a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3m-19.5 0a4.5 4.5 0 0 1 .9-2.7L5.737 5.1a3.375 3.375 0 0 1 2.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 0 1 .9 2.7m0 0a3 3 0 0 1-3 3m0 3h.008v.008h-.008zm0-6h.008v.008h-.008zm-3 6h.008v.008h-.008zm0-6h.008v.008h-.008z">'),Ue=(r={})=>(()=>{const e=Fe();return z(e,r,!0),e})(),Te=f('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m19.5 8.25-7.5 7.5-7.5-7.5">'),Oe=(r={})=>(()=>{const e=Te();return z(e,r,!0),e})(),Me=f('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m4.5 15.75 7.5-7.5 7.5 7.5">'),Pe=(r={})=>(()=>{const e=Me();return z(e,r,!0),e})(),Ne=f('<div class="border-t border-border p-2">'),ze=f('<div class="mb-2 rounded border border-border shadow hover:shadow-md"><h3 class="text-lg font-bold"><button type=button class="flex w-full items-center p-2 text-start"><span class="flex-1 hover:text-fg-secondary"></span><span class="inline-block size-4 shrink-0 text-fg">'),C=r=>{const[e,c]=U(r.initialOpened??!0),$=()=>c(m=>!m);return(()=>{const m=ze(),d=m.firstChild,o=d.firstChild,i=o.firstChild,g=i.nextSibling;return o.$$click=()=>$(),n(i,()=>r.title),n(g,l(k,{get when(){return e()},get fallback(){return l(Oe,{})},get children(){return l(Pe,{})}})),n(m,l(k,{get when(){return e()},get children(){const s=Ne();return n(s,()=>r.children),s}}),null),m})()};I(["click"]);const De=f('<div class="scrollbar flex flex-col overflow-y-auto rounded-md border border-border">'),qe=f('<button type=button class="border-t border-border px-2 py-1 text-left first:border-none">'),Be=()=>{const r=S(),{config:e,setConfig:c}=L(),$=d=>{const o=e().colorTheme;return o.type==="specific"?o.id===d:!1},m=d=>{c(o=>({...o,colorTheme:{type:"specific",id:d}}))};return l(C,{get title(){return r.t("config.display.colorTheme")},get children(){const d=De();return n(d,l(F,{get each(){return Object.values(ae)},children:o=>(()=>{const i=qe();return i.$$click=()=>m(o.id),n(i,()=>o.name),R(g=>{const s=!!$(o.id),u=!!$(o.id),b=!$(o.id);return s!==g._v$&&i.classList.toggle("bg-primary",g._v$=s),u!==g._v$2&&i.classList.toggle("text-primary-fg",g._v$2=u),b!==g._v$3&&i.classList.toggle("text-fg",g._v$3=b),g},{_v$:void 0,_v$2:void 0,_v$3:void 0}),i})()})),d}})};I(["click"]);const Ae=f('<div class="flex flex-col justify-evenly gap-2 sm:flex-row">'),Ke=f('<div class="flex flex-1 flex-row items-center gap-1 sm:flex-col"><button type=button class="w-48 rounded border border-primary p-2 font-bold sm:w-full"></button><div class=text-xs>'),Je=()=>{const r=S(),{config:e,setConfig:c}=L(),$=[{id:"relative",name:r.t("config.display.relativeTimeNotation"),example:r.t("config.display.relativeTimeNotationExample")},{id:"absolute-short",name:r.t("config.display.absoluteTimeNotationShort"),example:r.t("config.display.absoluteTimeNotationShortExample")},{id:"absolute-long",name:r.t("config.display.absoluteTimeNotationLong"),example:r.t("config.display.absoluteTimeNotationLongExample")}],m=d=>{c(o=>({...o,dateFormat:d}))};return l(C,{get title(){return r.t("config.display.timeNotation")},get children(){const d=Ae();return n(d,l(F,{each:$,children:({id:o,name:i,example:g})=>(()=>{const s=Ke(),u=s.firstChild,b=u.nextSibling;return u.$$click=()=>m(o),n(u,i),n(b,g),R(a=>{const p=e().dateFormat===o,h=e().dateFormat===o,y=e().dateFormat!==o,w=e().dateFormat!==o;return p!==a._v$&&u.classList.toggle("bg-primary",a._v$=p),h!==a._v$2&&u.classList.toggle("text-primary-fg",a._v$2=h),y!==a._v$3&&u.classList.toggle("bg-bg",a._v$3=y),w!==a._v$4&&u.classList.toggle("text-primary",a._v$4=w),a},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),s})()})),d}})};I(["click"]);const He=f('<button class="flex h-[24px] w-[48px] items-center rounded-full border border-primary/80 px-1"><span class="m-[-3px] inline-block size-5 rounded-full border bg-primary-fg shadow">'),O=r=>(()=>{const e=He();return e.$$click=c=>r.onClick(c),R(c=>{const $=!r.value,m=!r.value,d=!!r.value,o=!!r.value,i=r.value;return $!==c._v$&&e.classList.toggle("bg-bg-tertiary",c._v$=$),m!==c._v$2&&e.classList.toggle("justify-start",c._v$2=m),d!==c._v$3&&e.classList.toggle("bg-primary",c._v$3=d),o!==c._v$4&&e.classList.toggle("justify-end",c._v$4=o),i!==c._v$5&&T(e,"area-label",c._v$5=i),c},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),e})();I(["click"]);const Ge=f("<p>"),Xe=f('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1>YouTube</div></div><div class="flex w-full"><div class=flex-1>X (Twitter)</div></div><div class="flex w-full"><div class=flex-1>OGP'),Ve=()=>{const r=S(),{config:e,setConfig:c}=L(),$=m=>{c(d=>({...d,embedding:{...d.embedding,[m]:!d.embedding[m]}}))};return l(C,{get title(){return r.t("config.display.embedding")},get children(){return[(()=>{const m=Ge();return n(m,()=>r.t("config.display.embeddingDescription")),m})(),(()=>{const m=Xe(),d=m.firstChild;d.firstChild;const o=d.nextSibling;o.firstChild;const i=o.nextSibling;return i.firstChild,n(d,l(O,{get value(){return e().embedding.youtube},onClick:()=>$("youtube")}),null),n(o,l(O,{get value(){return e().embedding.twitter},onClick:()=>$("twitter")}),null),n(i,l(O,{get value(){return e().embedding.ogp},onClick:()=>$("ogp")}),null),m})()]}})},Qe=f('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),Ye=()=>{const r=S(),{config:e,setConfig:c}=L(),$=()=>{c(o=>({...o,keepOpenPostForm:!(o.keepOpenPostForm??!1)}))},m=()=>{c(o=>({...o,showMedia:!(o.showMedia??!0)}))},d=()=>{c(o=>({...o,hideCount:!(o.hideCount??!1)}))};return l(C,{get title(){return r.t("config.display.others")},get children(){const o=Qe(),i=o.firstChild,g=i.firstChild,s=i.nextSibling,u=s.firstChild,b=s.nextSibling,a=b.firstChild;return n(g,()=>r.t("config.display.keepOpenPostForm")),n(i,l(O,{get value(){return e().keepOpenPostForm},onClick:()=>$()}),null),n(u,()=>r.t("config.display.showMediaByDefault")),n(s,l(O,{get value(){return e().showMedia},onClick:()=>m()}),null),n(a,()=>r.t("config.display.hideNumbers")),n(b,l(O,{get value(){return e().hideCount},onClick:()=>d()}),null),o}})},We=f('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),Ze=()=>{const r=S(),{config:e,setConfig:c}=L(),$=()=>{c(d=>({...d,useEmojiReaction:!(d.useEmojiReaction??!1)}))},m=()=>{c(d=>({...d,showEmojiReaction:!(d.showEmojiReaction??!1)}))};return l(C,{get title(){return r.t("config.display.reaction")},get children(){const d=We(),o=d.firstChild,i=o.firstChild,g=o.nextSibling,s=g.firstChild;return n(i,()=>r.t("config.display.enableEmojiReaction")),n(o,l(O,{get value(){return e().useEmojiReaction},onClick:()=>$()}),null),n(s,()=>r.t("config.display.showEmojiReaction")),n(g,l(O,{get value(){return e().showEmojiReaction},onClick:()=>m()}),null),d}})},W=t.string().length(64).regex(/^[0-9a-f]{64}$/),V=t.string().regex(/^\w+$/),et=t.object({shortcode:V,url:t.string().url(),keywords:t.optional(t.array(V))}),tt=t.object({manifest:t.literal("emojipack_v1"),name:t.string(),emojis:t.array(et),description:t.optional(t.string()),author:t.optional(W),publisher:t.optional(W)}).refine(r=>he(r.emojis,c=>c.shortcode).length===r.emojis.length,{message:"shortcodes should be unique"}),ie=t.record(V,t.string().url());tt.or(ie);const rt=r=>Object.entries(r).map(([e,c])=>({shortcode:e,url:c})),nt=f("<p>"),lt=f('<form class="flex flex-col gap-2"><textarea class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"name=json placeholder="{ &quot;smiley&quot;: &quot;https://example.com/smiley.png&quot; }"></textarea><button type=submit class="w-24 self-end rounded bg-primary p-2 font-bold text-primary-fg">'),ot=()=>{const r=S(),{saveEmojis:e}=L(),[c,$]=U(""),m=d=>{if(d.preventDefault(),c().length!==0)try{const o=ie.parse(JSON.parse(c())),i=rt(o);e(i),$("")}catch(o){const i=o instanceof Error?`:${o.message}`:"";window.alert(`JSONの読み込みに失敗しました${i}`)}};return l(C,{get title(){return r.t("config.customEmoji.emojiImport")},get children(){return[(()=>{const d=nt();return n(d,()=>r.t("config.customEmoji.emojiImportDescription")),d})(),(()=>{const d=lt(),o=d.firstChild,i=o.nextSibling;return d.addEventListener("submit",m),o.addEventListener("change",g=>$(g.currentTarget.value)),n(i,()=>r.t("config.customEmoji.importEmoji")),R(()=>o.value=c()),d})()]}})},it=f('<form class="flex flex-col gap-2"><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=shortcode placeholder=smiley pattern=^\\w+$ required></label><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=url placeholder=https://example.com/smiley.png required></label><button type=submit class="w-24 self-end rounded bg-primary p-2 font-bold text-primary-fg">'),st=f('<ul class="mt-4 flex max-h-[40vh] min-h-64 flex-wrap overflow-y-auto border-t border-border">'),at=f('<div class="flex min-w-24 flex-col items-center rounded border border-border bg-bg shadow"><div class="flex items-center p-1"><img class="h-20 max-w-20 object-contain"></div><div class="p-1 text-center text-sm"></div><div class="w-full border-t border-border"><button type=button class="w-full px-2 py-1 text-danger">'),ct=f('<li class="min-w-0 basis-1/2 sm:basis-1/4"><button type=button class="flex w-full flex-col items-center gap-1 rounded p-2 hover:bg-bg-tertiary/20 hover:shadow"><div class="w-full truncate text-xs text-fg-secondary">'),dt=f("<div class=size-8>"),ut=f('<div class="flex h-8 max-w-8 items-center"><img class=object-contain>'),ft=()=>{const r=S(),{config:e,saveEmoji:c,removeEmoji:$}=L(),[m,d]=U(""),[o,i]=U(""),g=s=>{s.preventDefault(),!(m().length===0||o().length===0)&&(c({shortcode:m(),url:o()}),d(""),i(""))};return l(C,{get title(){return r.t("config.customEmoji.customEmoji")},get children(){return[(()=>{const s=it(),u=s.firstChild,b=u.firstChild,a=b.nextSibling,p=u.nextSibling,h=p.firstChild,y=h.nextSibling,w=p.nextSibling;return s.addEventListener("submit",g),n(b,()=>r.t("config.customEmoji.shortcode")),a.addEventListener("change",x=>d(x.currentTarget.value)),n(h,()=>r.t("config.customEmoji.url")),y.addEventListener("change",x=>i(x.currentTarget.value)),T(y,"pattern",te),n(w,()=>r.t("config.customEmoji.addEmoji")),R(()=>a.value=m()),R(()=>y.value=o()),s})(),(()=>{const s=st();return n(s,l(F,{get each(){return Object.values(e().customEmojis)},children:({shortcode:u,url:b})=>{const a=ve(()=>({popup:(()=>{const p=at(),h=p.firstChild,y=h.firstChild,w=h.nextSibling,x=w.nextSibling,j=x.firstChild;return T(y,"src",b),T(y,"alt",u),n(w,u),j.$$click=()=>$(u),n(j,()=>r.t("config.customEmoji.removeEmoji")),p})()}));return(()=>{const p=ct(),h=p.firstChild,y=h.firstChild,w=a.targetRef;return typeof w=="function"?re(w,p):a.targetRef=p,h.$$click=()=>a.open(),n(h,l(X,{get fallback(){return dt()},children:()=>(()=>{const x=ut(),j=x.firstChild;return T(j,"src",b),T(j,"alt",u),x})()}),y),n(y,u),n(p,()=>a.popup(),null),p})()}})),s})()]}})};I(["click"]);const gt=f('<ul class="flex max-h-[50vh] min-h-64 flex-col overflow-y-auto">'),mt=f('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border focus:border-border focus:ring-primary"type=text name=keyword><button type=submit class="rounded bg-primary p-2 font-bold text-primary-fg">'),pt=f('<ul class="mt-2 flex max-h-[50vh] min-h-64 flex-col overflow-y-auto border-t border-border">'),bt=f('<ul class="flex max-h-[50vh] min-h-64 flex-col gap-1 overflow-y-auto">'),Z=f('<li class="flex items-center border-b border-border pr-4"><div class="flex-1 truncate"></div><button class="size-3 shrink-0">'),ee=f("<div class=h-4>"),$t=f('<li class="flex items-center"><div class="flex-1 truncate rounded border border-border p-2"></div><button class=p-4><span class="inline-block size-4">'),ht=()=>{const r=S(),{config:e,removeMutedPubkey:c,removeMutedThread:$,addMutedKeyword:m,removeMutedKeyword:d}=L(),[o,i]=U(""),g=s=>{s.preventDefault(),o().length!==0&&(m(o()),i(""))};return[l(C,{get title(){return r.t("config.mute.mutedUsers")},initialOpened:!1,get children(){const s=gt();return n(s,l(F,{get each(){return e().mutedPubkeys},children:u=>(()=>{const b=Z(),a=b.firstChild,p=a.nextSibling;return n(a,l(X,{get fallback(){return ee()},children:()=>l(ne,{pubkey:u})})),p.$$click=()=>c(u),n(p,l(N,{})),b})()})),s}}),l(C,{get title(){return r.t("config.mute.mutedKeywords")},initialOpened:!1,get children(){return[(()=>{const s=mt(),u=s.firstChild,b=u.nextSibling;return s.addEventListener("submit",g),u.addEventListener("change",a=>i(a.currentTarget.value)),n(b,()=>r.t("config.mute.add")),R(()=>u.value=o()),s})(),(()=>{const s=pt();return n(s,l(F,{get each(){return e().mutedKeywords},children:u=>(()=>{const b=Z(),a=b.firstChild,p=a.nextSibling;return n(a,u),p.$$click=()=>d(u),n(p,l(N,{})),b})()})),s})()]}}),l(C,{get title(){return r.t("config.mute.mutedThreads")},initialOpened:!1,get children(){const s=bt();return n(s,l(F,{get each(){return e().mutedThreads},children:u=>(()=>{const b=$t(),a=b.firstChild,p=a.nextSibling,h=p.firstChild;return n(a,l(X,{get fallback(){return ee()},children:()=>l(Se,{eventId:u,actions:!1,displayForcibly:!0})})),p.$$click=()=>$(u),n(h,l(N,{})),b})()})),s}})]};I(["click"]);const vt=f('<div class="scrollbar mt-2 flex flex-col divide-y divide-border overflow-y-auto rounded-md border border-border">'),yt=f('<form class="mt-2 flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=url placeholder=https://...><button type=submit class="rounded bg-primary p-2 font-bold text-primary-fg">'),_t=f('<button type=button><span class="inline-block size-4">'),xt=f('<div class="flex px-2 py-1 text-left text-fg"><button type=button class="flex-1 text-start">'),wt=()=>{const r=S(),{config:e,setFileServer:c,addCustomFileServer:$,removeCustomFileServer:m}=L(),[d,o]=U(""),i=s=>{s.preventDefault(),$({type:"nip96",name:d(),serverUrl:d()}),s.currentTarget.reset()},g=()=>[...ce.map(s=>({...s,custom:!1})),...e().customFileServers.map(s=>({...s,custom:!0}))];return l(C,{get title(){return r.t("config.posting.fileServer")},get children(){return[(()=>{const s=vt();return n(s,l(F,{get each(){return g()},children:u=>{const b=()=>u.name===e().fileServer.name;return(()=>{const a=xt(),p=a.firstChild;return p.$$click=()=>c(u),n(p,()=>u.name),n(a,l(k,{get when(){return u.custom},get children(){const h=_t(),y=h.firstChild;return h.$$click=()=>m(u.name),n(y,l(N,{})),h}}),null),R(h=>{const y=!!b(),w=!!b(),x=!b();return y!==h._v$&&a.classList.toggle("bg-primary",h._v$=y),w!==h._v$2&&a.classList.toggle("text-primary-fg",h._v$2=w),x!==h._v$3&&a.classList.toggle("text-fg",h._v$3=x),h},{_v$:void 0,_v$2:void 0,_v$3:void 0}),a})()}})),s})(),(()=>{const s=yt(),u=s.firstChild,b=u.nextSibling;return s.addEventListener("submit",i),u.addEventListener("change",a=>o(a.currentTarget.value)),T(u,"pattern",te),n(b,()=>r.t("config.posting.addCustomFileServer")),R(()=>u.value=d()),s})()]}})};I(["click"]);const kt=f('<div class="flex gap-2 py-1"><button class="rounded border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded border border-primary px-4 py-1 font-bold text-primary">'),Ct=f("<input type=file hidden name=config accept=application/json>"),St=()=>{let r;const e=S(),c=L(),$=()=>{const i=JSON.stringify(c.config(),null,2),g=new Blob([i],{type:"application/json"}),s=URL.createObjectURL(g),u=new Date().toISOString(),b=document.createElement("a");b.href=s,b.download=`rabbit-${u}.json`,b.click()},m=()=>{r?.click()},d=async i=>{try{const g=await i.text(),s=de.parse(JSON.parse(g));c.setConfig(s),window.alert(e.t("config.account.restored")),window.location.reload()}catch(g){g instanceof Error?window.alert(`${e.t("config.account.failedToRestore")}: ${g.message}`):window.alert(e.t("config.account.failedToRestore"))}},o=i=>{i.preventDefault();const g=[...i.currentTarget.files??[]];if(g.length!==1)return;const s=g[0];d(s).catch(u=>console.log(u))};return l(C,{get title(){return e.t("config.account.backupConfig")},get children(){return[(()=>{const i=kt(),g=i.firstChild,s=g.nextSibling;return g.$$click=$,n(g,()=>e.t("config.account.save")),s.$$click=m,n(s,()=>e.t("config.account.restore")),i})(),(()=>{const i=Ct();i.addEventListener("change",o);const g=r;return typeof g=="function"?re(g,i):r=i,i.multiple=!1,i})()]}})};I(["click"]);const jt=f('<div class="flex gap-2 py-1"><button class="rounded border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded border border-primary px-4 py-1 font-bold text-primary">'),Et=()=>{const r=S(),e=ye(),{showProfile:c,showProfileEdit:$}=le();return l(C,{get title(){return r.t("config.account.profile")},get children(){const m=jt(),d=m.firstChild,o=d.nextSibling;return d.$$click=()=>_e([e()])(([i])=>{c(i)}),n(d,()=>r.t("config.account.openProfile")),o.$$click=()=>$(),n(o,()=>r.t("config.account.editProfile")),m}})};I(["click"]);const It=t.object({max_message_length:t.optional(t.number()),max_subscriptions:t.optional(t.number()),max_filters:t.optional(t.number()),max_limit:t.optional(t.number()),max_subid_length:t.optional(t.number()),max_event_tags:t.optional(t.number()),max_content_length:t.optional(t.number()),min_pow_difficulty:t.optional(t.number()),auth_required:t.optional(t.boolean()),payment_required:t.optional(t.boolean()),restricted_writes:t.optional(t.boolean()),created_at_lower_limit:t.optional(t.number()),created_at_upper_limit:t.optional(t.number())}),Rt=t.array(t.object({kinds:t.array(t.union([t.number(),t.array(t.number())])),time:t.nullable(t.number())})),H=t.object({amount:t.number(),unit:t.string(),period:t.optional(t.number()),kinds:t.optional(t.array(t.number()))}),Lt=t.object({admission:t.optional(t.array(H)),subscription:t.optional(t.array(H)),publication:t.optional(t.array(H))}),Ft=t.object({name:t.optional(t.string()),description:t.optional(t.string()),pubkey:t.optional(t.string().refine(ue)),contact:t.optional(t.string()),supported_nips:t.optional(t.array(t.number())),software:t.optional(t.string()),version:t.optional(t.string()),icon:t.optional(t.string().url()),limitation:t.optional(It),retention:t.optional(Rt),relay_countries:t.optional(t.array(t.string())),language_tags:t.optional(t.array(t.string())),tags:t.optional(t.array(t.string())),posting_policy:t.optional(t.string().url()),payments_url:t.optional(t.string().url()),fees:t.optional(Lt)}),Ut=r=>{const e=new URL(r);if(e.protocol==="wss:")e.protocol="https";else if(e.protocol==="ws:")e.protocol="http";else throw new Error("unexpected protocol");return e},Tt=async r=>{const e=Ut(r),c=await fetch(e,{headers:{Accept:"application/nostr+json"},mode:"cors"});if(c.status!==200)throw new Error("failed to fetch relay info: status was not 200");const $=await c.json();if(!me(Ft)($))throw new Error("failed to fetch relay info: unexpected form of data");return $},se=r=>{const e=fe(r),c=ge(()=>({queryKey:["useRelayInfo",e()],queryFn:({queryKey:$})=>{const[,m]=$;if(m!=null)return Tt(m.relayUrl)},enabled:e()!=null,staleTime:5*60*1e3,gcTime:90*24*60*60*1e3}));return{relayInfo:()=>c.data,query:c}},Ot=f('<div class="scrollbar max-h-24 overflow-scroll whitespace-pre-wrap break-words px-4 py-2">'),Mt=f('<pre class="w-full overflow-scroll rounded-lg border border-border p-4">'),Pt=f('<div class="divide-y divide-border"><div class="flex max-w-full items-center gap-4 p-4"><div class="min-w-0 flex-1"><h3 class="truncate text-2xl font-bold"></h3><div class="truncate text-sm"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex flex-col gap-2 p-4"><button class="select-text rounded-lg border border-border bg-bg-tertiary/20 p-2 text-fg-secondary hover:bg-bg-tertiary">'),Nt=f('<div class="size-16 overflow-hidden rounded-lg shadow-md"><img alt="icon of relay"class="size-full object-cover">'),K=f("<div>"),zt=f('<div class="whitespace-normal break-words"><button class="inline select-text underline">'),G=f('<div class="whitespace-pre-wrap break-all">'),Dt=f('<div class="flex-1 shrink-0 border-t border-border px-4 py-2"><div class="text-sm text-fg-secondary"></div><div class="scrollbar flex w-full gap-1 overflow-x-scroll pt-1">'),qt=f('<span class="inline-block w-12 rounded-xl border border-border py-2 text-center hover:border-fg-tertiary hover:text-fg-secondary">'),Bt=r=>`https://github.com/nostr-protocol/nips/blob/master/${r.toString(10).padStart(2,"0")}.md`,At=r=>{const e=S(),{relayInfo:c}=se(()=>({relayUrl:r.relayUrl})),[$,m]=U(!1),d=()=>m(i=>!i),{showProfile:o}=le();return l(oe,{get onClose(){return r.onClose},get children(){const i=Pt(),g=i.firstChild,s=g.firstChild,u=s.firstChild,b=u.nextSibling,a=g.nextSibling,p=a.firstChild,h=p.firstChild,y=p.nextSibling,w=y.firstChild,x=a.nextSibling,j=x.firstChild,D=j.firstChild,q=j.nextSibling,B=q.firstChild,M=x.nextSibling,P=M.firstChild;return n(g,l(k,{get when(){return c()?.icon},keyed:!0,children:v=>(()=>{const _=Nt(),E=_.firstChild;return T(E,"src",v),_})()}),s),n(u,()=>c()?.name??r.relayUrl),n(b,()=>r.relayUrl),n(i,l(k,{get when(){return c()?.description},keyed:!0,get children(){const v=Ot();return n(v,()=>c()?.description),v}}),a),n(h,()=>e.t("relayInfo.administrator")),n(p,l(k,{get when(){return c()?.pubkey},get fallback(){return(()=>{const v=K();return n(v,()=>e.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=zt(),E=_.firstChild;return E.$$click=()=>o(v),n(E,l(ne,{pubkey:v})),_})()}),null),n(w,()=>e.t("relayInfo.contact")),n(y,l(k,{get when(){return c()?.contact},get fallback(){return(()=>{const v=K();return n(v,()=>e.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=G();return n(_,l(J,{class:"underline",href:v,children:v})),_})()}),null),n(D,()=>e.t("relayInfo.software")),n(j,l(k,{get when(){return c()?.software},get fallback(){return(()=>{const v=K();return n(v,()=>e.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=G();return n(_,l(k,{get when(){return je(v)},fallback:v,keyed:!0,children:E=>l(J,{class:"underline",href:E})})),_})()}),null),n(B,()=>e.t("relayInfo.version")),n(q,l(k,{get when(){return c()?.version},get fallback(){return(()=>{const v=K();return n(v,()=>e.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=G();return n(_,v),_})()}),null),n(i,l(k,{get when(){return c()?.supported_nips},keyed:!0,children:v=>(()=>{const _=Dt(),E=_.firstChild,A=E.nextSibling;return n(E,()=>e.t("relayInfo.supportedNips")),n(A,l(F,{each:v,children:Q=>l(J,{get href(){return Bt(Q)},get children(){const Y=qt();return n(Y,Q),Y}})})),_})()}),M),P.$$click=d,n(P,()=>e.t("relayInfo.showJSON")),n(M,l(k,{get when(){return $()},get children(){const v=Mt();return n(v,()=>JSON.stringify(c(),null,2)),v}}),null),i}})};I(["click"]);const Kt=f("<p class=py-1>"),Jt=f('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=relayUrl placeholder=wss://...><button type=submit class="rounded bg-primary p-2 font-bold text-primary-fg">'),Ht=f('<ul class="mt-2 divide-y divide-border rounded border border-border">'),Gt=f('<button type=button class="rounded bg-primary p-2 font-bold text-primary-fg">'),Xt=f('<li class=flex><button class="flex flex-1 items-center truncate rounded py-1 text-start hover:bg-bg-tertiary"><div class="shrink-0 px-2"><span class="inline-block size-2 rounded-full"aria-label=""></span></div><div class="min-w-0 flex-1"><div class=truncate></div><div class="truncate text-xs text-fg-secondary"></div></div></button><button class="flex shrink-0 items-center justify-center pe-6 ps-4"><span class=size-3>'),Vt=()=>{const r=S(),{config:e,addRelay:c,removeRelay:$}=L(),m=xe(),[d,o]=U(""),[i,g]=U(null),s=()=>g(null),u=a=>{a.preventDefault(),d().length!==0&&(c(d()),o(""))},b=async()=>{if(window.nostr==null)return;const a=Object.entries(await window.nostr?.getRelays?.()??[]),p=a.map(([x])=>x).join(`
`);if(a.length===0){window.alert(r.t("config.relays.notConfigured"));return}if(!window.confirm(`${r.t("config.relays.askImport")}

${p}`))return;const h=e().relayUrls.length;be(()=>{a.forEach(([x])=>{c(x)})});const w=e().relayUrls.length-h;window.alert(r.t("config.relays.imported",{count:w}))};return[l(C,{get title(){return r.t("config.relays.relays")},get children(){return[(()=>{const a=Kt();return n(a,()=>r.t("config.relays.numOfRelays",{count:e().relayUrls.length})),a})(),(()=>{const a=Jt(),p=a.firstChild,h=p.nextSibling;return a.addEventListener("submit",u),p.addEventListener("change",y=>o(y.currentTarget.value)),T(p,"pattern",pe),n(h,()=>r.t("config.relays.addRelay")),R(()=>p.value=d()),a})(),(()=>{const a=Ht();return n(a,l(F,{get each(){return e().relayUrls},children:p=>{const{relayInfo:h}=se(()=>({relayUrl:p})),y=()=>m().getRelay(p)?.connected??!1;return(()=>{const w=Xt(),x=w.firstChild,j=x.firstChild,D=j.firstChild,q=j.nextSibling,B=q.firstChild,M=B.nextSibling,P=x.nextSibling,v=P.firstChild;return x.$$click=()=>g({type:"RelayInfo",relayUrl:p}),n(B,()=>h()?.name??p),n(M,p),P.$$click=()=>$(p),n(v,l(N,{})),R(_=>{const E=!y(),A=!!y();return E!==_._v$&&D.classList.toggle("bg-rose-500",_._v$=E),A!==_._v$2&&D.classList.toggle("bg-green-500",_._v$2=A),_},{_v$:void 0,_v$2:void 0}),w})()}})),a})()]}}),l(C,{get title(){return r.t("config.relays.importRelays")},get children(){const a=Gt();return a.$$click=()=>{b().catch(p=>{console.error("failed to import relays",p),window.alert(r.t("config.relays.failedToImport"))})},n(a,()=>r.t("config.relays.importFromExtension")),a}}),l(k,{get when(){return i()},keyed:!0,children:a=>l(k,{get when(){return a.type==="RelayInfo"},get children(){return l(At,{get relayUrl(){return a.relayUrl},onClose:()=>s()})}})})]};I(["click"]);const Qt=f("<div class=p-4>"),Yt=f('<h2 class="flex-1 text-center text-lg font-bold">'),Wt=f('<ul class="flex flex-col">'),Zt=f('<li class=w-full><button class="flex w-full gap-2 py-3 hover:text-primary"><span class="inline-block size-6">'),er=f('<div class="flex flex-col"><div><button class="pr-4 text-fg hover:text-fg-secondary"><span class="inline-block size-6"></span></button></div><div class="w-full flex-1 pt-4">'),cr=r=>{const e=S(),[c,$]=U(null),m=[{name:()=>e.t("config.account.profile"),icon:()=>l(we,{}),render:()=>[l(Et,{}),l(St,{})]},{name:()=>e.t("config.relays.relays"),icon:()=>l(Ue,{}),render:()=>l(Vt,{})},{name:()=>e.t("config.posting.posting"),icon:()=>l(ke,{}),render:()=>l(wt,{})},{name:()=>e.t("config.display.display"),icon:()=>l(Le,{}),render:()=>[l(Be,{}),l(Je,{}),l(Ze,{}),l(Ve,{}),l(Ye,{})]},{name:()=>e.t("config.customEmoji.customEmoji"),icon:()=>l(Ce,{}),render:()=>[l(ft,{}),l(ot,{})]},{name:()=>e.t("config.mute.mute"),icon:()=>l(Ie,{}),render:()=>l(ht,{})}],d=()=>{const o=c();return o==null?null:m[o]};return l(oe,{get onClose(){return r.onClose},get children(){const o=Qt();return n(o,l(k,{get when(){return d()},get fallback(){return[(()=>{const i=Yt();return n(i,()=>e.t("config.config")),i})(),(()=>{const i=Wt();return n(i,l(F,{each:m,children:(g,s)=>(()=>{const u=Zt(),b=u.firstChild,a=b.firstChild;return b.$$click=()=>$(s),n(a,()=>g.icon()),n(b,()=>g.name(),null),u})()})),i})()]},keyed:!0,children:i=>(()=>{const g=er(),s=g.firstChild,u=s.firstChild,b=u.firstChild,a=s.nextSibling;return u.$$click=()=>$(null),n(b,l($e,{})),n(a,()=>i.render()),g})()})),o}})};I(["click"]);export{cr as default};
//# sourceMappingURL=Config-CKbh_IdC.js.map
