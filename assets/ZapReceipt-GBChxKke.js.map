{"version":3,"file":"ZapReceipt-GBChxKke.js","sources":["../../node_modules/heroicons/24/solid/bolt.svg","../../src/components/event/ZapReceipt.tsx"],"sourcesContent":["export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path fill-rule=\"evenodd\" d=\"M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143\" clip-rule=\"evenodd\"/></svg>","import { Component, Show, createMemo } from 'solid-js';\n\nimport Bolt from 'heroicons/24/solid/bolt.svg';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport EventDisplayById from '@/components/event/EventDisplayById';\nimport UserDisplayName from '@/components/UserDisplayName';\nimport useConfig from '@/core/useConfig';\nimport useModalState from '@/hooks/useModalState';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport ZapReceipt from '@/nostr/event/ZapReceipt';\nimport useLnurlEndpoint from '@/nostr/useLnurlEndpoint';\nimport useProfile from '@/nostr/useProfile';\nimport lud06ToLnurlPayUrl from '@/nostr/zap/lud06ToLnurlPayUrl';\nimport lud16ToLnurlPayUrl from '@/nostr/zap/lud16ToLnurlPayUrl';\nimport ensureNonNull from '@/utils/ensureNonNull';\nimport { formatSiPrefix } from '@/utils/siPrefix';\nimport { thumbnailUrl } from '@/utils/url';\n\nexport type ZapReceiptProps = {\n  event: NostrEvent;\n};\n\nconst ZapReceiptDisplay: Component<ZapReceiptProps> = (props) => {\n  const i18n = useTranslation();\n  const { shouldMuteEvent } = useConfig();\n  const { showProfile } = useModalState();\n\n  const event = createMemo(() => new ZapReceipt(props.event));\n\n  const { profile: senderProfile } = useProfile(() => ({\n    pubkey: event().senderPubkey(),\n  }));\n\n  const { profile: recipientProfile } = useProfile(() =>\n    ensureNonNull([event().zappedPubkey()])(([pubkey]) => ({ pubkey })),\n  );\n\n  const lnurlPayUrlLud06 = () => {\n    const lud06 = recipientProfile()?.lud06;\n    if (lud06 == null) return null;\n    return lud06ToLnurlPayUrl(lud06);\n  };\n\n  const lnurlPayUrlLud16 = () => {\n    const lud16 = recipientProfile()?.lud16;\n    if (lud16 == null) return null;\n    return lud16ToLnurlPayUrl(lud16);\n  };\n\n  const lnurlEndpointLud06 = useLnurlEndpoint(() =>\n    ensureNonNull([lnurlPayUrlLud06()] as const)(([lnurlPayUrl]) => ({\n      lnurlPayUrl,\n    })),\n  );\n\n  const lnurlEndpointLud16 = useLnurlEndpoint(() =>\n    ensureNonNull([lnurlPayUrlLud16()] as const)(([lnurlPayUrl]) => ({\n      lnurlPayUrl,\n    })),\n  );\n\n  const amountSi = () => {\n    const amountSats = event().amountSats();\n    if (amountSats == null) return null;\n    return formatSiPrefix(amountSats);\n  };\n\n  const isZapReceiptVerified = () =>\n    lnurlEndpointLud06.isZapReceiptVerified(props.event) ||\n    lnurlEndpointLud16.isZapReceiptVerified(props.event);\n\n  return (\n    <Show when={!shouldMuteEvent(props.event) && isZapReceiptVerified()}>\n      <div class=\"flex items-center gap-1 text-sm\">\n        <div class=\"flex w-6 flex-col items-center\">\n          <div class=\"size-4 shrink-0 text-amber-500\" aria-hidden=\"true\">\n            <Bolt />\n          </div>\n          <div class=\"mt-[-2px] shrink-0 text-xs\">{amountSi()}</div>\n        </div>\n        <div class=\"notification-user flex gap-1 overflow-hidden\">\n          <div class=\"author-icon size-5 shrink-0 overflow-hidden rounded\">\n            <Show when={senderProfile()?.picture} keyed>\n              {(url) => (\n                <img\n                  src={thumbnailUrl(url, 'icon')}\n                  alt=\"icon\"\n                  // TODO autofit\n                  class=\"size-full object-cover\"\n                />\n              )}\n            </Show>\n          </div>\n          <div class=\"flex min-w-0 flex-1 overflow-hidden\">\n            <button\n              class=\"select-text truncate font-bold hover:text-link hover:underline\"\n              onClick={() => showProfile(event().senderPubkey())}\n            >\n              <UserDisplayName pubkey={event().senderPubkey()} />\n            </button>\n            <span class=\"shrink-0\">{i18n.t('notification.zapped')}</span>\n          </div>\n        </div>\n      </div>\n      <Show when={event().description().content.length > 0}>\n        <div class=\"ml-7 whitespace-pre-wrap break-all rounded border border-border px-1 text-sm\">\n          {event().description().content}\n        </div>\n      </Show>\n      <Show when={event().zappedEventId() != null}>\n        <div class=\"notification-event py-1\">\n          <EventDisplayById eventId={event().zappedEventId()} />\n        </div>\n      </Show>\n    </Show>\n  );\n};\n\nexport default ZapReceiptDisplay;\n"],"names":["Bolt","props","_el$","_tmpl$","_$spread","ZapReceiptDisplay","i18n","useTranslation","shouldMuteEvent","useConfig","showProfile","useModalState","event","createMemo","ZapReceipt","profile","senderProfile","useProfile","pubkey","senderPubkey","recipientProfile","ensureNonNull","zappedPubkey","lnurlPayUrlLud06","lud06","lud06ToLnurlPayUrl","lnurlPayUrlLud16","lud16","lud16ToLnurlPayUrl","lnurlEndpointLud06","useLnurlEndpoint","lnurlPayUrl","lnurlEndpointLud16","amountSi","amountSats","formatSiPrefix","isZapReceiptVerified","_$createComponent","Show","when","_$memo","children","_el$2","firstChild","_el$3","_el$4","nextSibling","_el$5","_el$6","_el$7","_el$8","_el$9","_$insert","picture","keyed","url","_el$12","_tmpl$4","_$effect","_$setAttribute","thumbnailUrl","$$click","UserDisplayName","t","description","content","length","_el$10","_tmpl$2","zappedEventId","_el$11","_tmpl$3","EventDisplayById","eventId","_$delegateEvents"],"mappings":"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","x_google_ignoreList":[0]}