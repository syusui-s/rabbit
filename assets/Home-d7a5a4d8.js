import{s as H,t as d,d as D,c as T,i as a,a as n,S as E,M as w,b as G,u as $,e as te,f as me,g as S,h as J,j as B,k as de,F as z,l as A,T as ge,m as he,n as re,o as p,p as j,q as fe,r as oe,v as ve,w as ye,x as X,y as Q,z as le,A as xe,B as $e,_ as ke,R as we,C as Ce,Z as be,D as _e,E as Ie,G as Te}from"./index-0dea95bd.js";import{A as Ee}from"./arrow-left-c52527d6.js";import{u as L,T as K,a as Se,b as Re,C as M,E as pe,c as Me,d as Le,e as Fe,f as Pe,t as Be,g as ce,R as De}from"./useFollowings-2b546950.js";import{u as Y,a as se,b as ie,p as Ue,r as Ne,t as Oe,B as qe,e as ee,c as Ae,d as He,f as je,U as Ke,g as ze,h as Qe,S as Ge,G as Ve,i as Ze}from"./SideBar-7055a5c9.js";import{H as We,B as Je,M as Xe}from"./magnifying-glass-717c9c97.js";import{U as Ye}from"./user-c9f117de.js";import{H as en,G as nn}from"./globe-alt-4350ebc7.js";import{u as tn}from"./usePersistStatus-cc308159.js";import"./LazyLoad-dba75178.js";const rn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0">'),on=(e={})=>(()=>{const t=rn();return H(t,e,!0,!0),t})(),ln=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ue=(e={})=>(()=>{const t=ln();return H(t,e,!0,!0),t})(),cn=d('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"><span class=truncate></span></h2><button class="flex h-full place-items-center px-2"><span class="inline-block h-4 w-4">'),sn=d('<span class="inline-block h-4 w-4 shrink-0 text-fg-secondary">'),U=e=>{const[t,r]=T(!1),s=()=>r(l=>!l);return(()=>{const l=cn(),o=l.firstChild,c=o.firstChild,i=c.firstChild,u=c.nextSibling,h=u.firstChild;return a(c,n(E,{get when(){return e.icon},keyed:!0,children:f=>(()=>{const m=sn();return a(m,f),m})()}),i),a(i,()=>e.name),u.$$click=()=>s(),a(h,n(ue,{})),a(l,n(E,{get when(){return t()},get children(){return e.settings()}}),null),l})()};D(["click"]);const un=e=>{const t=[e.id],r=e.rootEvent()?.id;r!=null&&t.push(r);const s=e.replyingToEvent()?.id;return s!=null&&t.push(s),te(t)},an=e=>{const{config:t}=$(),r=()=>me(e.event),{events:s}=L(()=>({relayUrls:t().relayUrls,filters:[{kinds:[1],ids:un(r()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return n(K,{get events(){return[...s()].reverse()}})},mn=e=>n(G,{get children(){return n(w,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:t=>n(an,{get event(){return t.event}})})}}),dn=d('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),gn=d('<div class="shrink-0 border-b border-border">'),hn=d('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),fn=d('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block h-4 w-4"></div><div>'),vn=d('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),F=e=>{let t;const r=Se(),s=S(),l=()=>e.width??"medium";return Y(()=>({commandType:"moveToColumn",handler:o=>{o.command==="moveToColumn"&&o.columnIndex===e.columnIndex&&t?.scrollIntoView({behavior:"smooth",inline:"center"})}})),Y(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&t?.scrollIntoView({behavior:"smooth"})}})),n(Re.Provider,{value:r,get children(){const o=dn(),c=t;return typeof c=="function"?J(c,o):t=o,a(o,n(E,{get when(){return r.timelineState.content},keyed:!0,get fallback(){return[(()=>{const i=gn();return a(i,()=>e.header),i})(),(()=>{const i=hn(),u=e.timelineRef;return typeof u=="function"?J(u,i):e.timelineRef=i,a(i,()=>e.children),i})()]},children:i=>[(()=>{const u=fn(),h=u.firstChild,f=h.firstChild,m=f.nextSibling;return h.$$click=()=>r?.clearTimeline(),a(f,n(Ee,{})),a(m,()=>s()("column.back")),u})(),(()=>{const u=vn();return a(u,n(mn,{timelineContent:i})),u})()]})),B(i=>de(o,{"sm:w-[500px]":l()==="widest","sm:w-[360px]":l()==="wide","sm:w-[320px]":l()==="medium","sm:w-[280px]":l()==="narrow"},i)),o}})};D(["click"]);const yn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),xn=(e={})=>(()=>{const t=yn();return H(t,e,!0,!0),t})(),$n=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m8.25 4.5 7.5 7.5-7.5 7.5">'),kn=(e={})=>(()=>{const t=$n();return H(t,e,!0,!0),t})(),wn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),Cn=(e={})=>(()=>{const t=wn();return H(t,e,!0,!0),t})(),bn=d('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),_n=d('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),In=d('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block h-4 w-4"></span></button><button class="py-4 pr-2"><span class="inline-block h-4 w-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block h-4 w-4">'),Tn=d('<button class="rounded-md border px-4 text-fg-secondary">'),En=e=>(()=>{const t=bn(),r=t.firstChild,s=r.nextSibling;return a(r,()=>e.title),a(s,()=>e.children),t})(),P=e=>{const t=S(),{saveColumn:r,removeColumn:s,moveColumn:l}=$(),o=se(),c=u=>{r({...e.column,width:u})},i=u=>{l(e.column.id,u),o({command:"moveToColumn",columnIndex:u}).catch(h=>console.error(h))};return(()=>{const u=In(),h=u.firstChild,f=h.firstChild,m=f.firstChild,g=f.nextSibling,v=g.firstChild,C=g.nextSibling,b=C.nextSibling,I=b.firstChild;return a(u,n(En,{get title(){return t()("column.config.columnWidth")},get children(){const y=_n();return a(y,n(z,{each:["widest","wide","medium","narrow"],children:_=>(()=>{const k=Tn();return k.$$click=()=>c(_),a(k,()=>t()(`column.config.${_}`)),B(x=>{const q=e.column.width===_,V=e.column.width===_,Z=e.column.width!==_,W=e.column.width!==_;return q!==x._v$5&&k.classList.toggle("border-fg-secondary",x._v$5=q),V!==x._v$6&&k.classList.toggle("font-bold",x._v$6=V),Z!==x._v$7&&k.classList.toggle("border-border",x._v$7=Z),W!==x._v$8&&k.classList.toggle("font-normal",x._v$8=W),x},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),k})()})),y}}),h),f.$$click=()=>i(e.columnIndex-1),a(m,n(xn,{})),g.$$click=()=>i(e.columnIndex+1),a(v,n(kn,{})),b.$$click=()=>s(e.column.id),a(I,n(Cn,{})),B(y=>{const _=t()("column.config.moveLeft"),k=t()("column.config.moveRight"),x=t()("column.config.removeColumn"),q=t()("column.config.removeColumn");return _!==y._v$&&A(f,"title",y._v$=_),k!==y._v$2&&A(g,"title",y._v$2=k),x!==y._v$3&&A(b,"title",y._v$3=x),q!==y._v$4&&A(I,"aria-label",y._v$4=q),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),u})()};D(["click"]);class Sn extends he{constructor(t){super(),this.tags=t}}const Rn=e=>{try{const t=ge.parse(JSON.parse(e));return new Sn(t)}catch(t){throw new TypeError("failed to parse tags schema: ",{cause:t})}},[ne,pn]=re(()=>T({})),[Mn,Ln]=re(()=>T({})),Fn=e=>{const t=ie(),[r,s]=T(null);return p(()=>{const l=e();if(l==null)return;const{encrypted:o}=l;if(o in ne()){s(ne()[o]);return}const c=t();c!=null&&(Mn()[o]||(Ln(i=>({...i,[o]:!0})),window.nostr?.nip04?.decrypt?.(c,o)?.then(i=>{pn(u=>({...u,[o]:i})),s(i)}).catch(i=>{console.error(`failed to decrypt "${o}"`,i)})))}),r},Pn=e=>{const t=j(()=>fe(e.event)),r=Fn(()=>{const{content:o}=t();return o==null||o.length===0?null:{id:t().id,encrypted:o}}),s=()=>{const o=r();if(o==null)return[];console.log(o);try{return Rn(o).taggedEventIds()}catch(c){return console.warn(c),[]}},l=()=>t().taggedEventIds();return n(z,{get each(){return[...l(),...s()]},children:o=>n(M,{get children(){return n(pe,{eventId:o,get ensureKinds(){return[oe]}})}})})},Bn=e=>{const t=ve(),r=j(e),s=()=>["useFollowings",r()],l=ye(()=>({queryKey:s(),queryFn:({queryKey:c,signal:i})=>{console.debug("useFollowings");const[,u]=c;if(u==null)return Promise.resolve(null);const{kind:h,author:f,identifier:m}=u,g=new qe({type:"ParameterizedReplaceableEvent",kind:h,author:f,identifier:m}),v=g.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${h}:${f}:${m}`)});return g.onUpdate(C=>{const b=Ue(C);t.setQueryData(c,b)}),Ne({task:g,signal:i}),Oe(15e3,`useParameterizedReplaceableEvent: ${h}:${f}:${m}`)(v)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>l.data??null,query:l}},Dn=e=>{const t=S(),{removeColumn:r}=$(),{event:s}=Bn(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.bookmark")},get icon(){return n(on,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(E,{get when(){return s()},keyed:!0,children:l=>n(Pn,{event:l})})}})},Un=()=>{const[e,t]=T();return{targetRef:t,currentPosition:()=>e()?.scrollTop??0,scrollToTop:()=>{const o=e();o?.scrollTo(0,0)},scrollToBottom:()=>{const o=e();o?.scrollTo(0,o.scrollHeight)}}},Nn=d('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary"><span>'),On=d('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary disabled:text-fg-secondary/30"><span>'),N=e=>{const t=j(e),r=v=>{const{duration:C}=t();if(C!=null)return v-C},[s,l]=T([]),[o,c]=T(r(ee())),[i,u]=T(),h=()=>i()==null,f=Un(),m=()=>{X(()=>{u(void 0),c(r(ee()))}),f.scrollToTop()},g=()=>{const v=Ae(s());v!=null&&(X(()=>{u(v.created_at),c(r(v.created_at))}),f.scrollToTop())};return{timelineRef:f.targetRef,setEvents:l,since:o,until:i,continuous:h,loadLatest:m,loadOld:g}},O=e=>{const t=S();return[n(E,{get when(){return!e.loadMore.continuous()},get children(){return n(M,{get children(){const r=Nn(),s=r.firstChild;return r.$$click=()=>e.loadMore.loadLatest(),a(s,()=>t()("column.loadLatest")),r}})}}),j(()=>e.children),n(M,{get children(){const r=On(),s=r.firstChild;return r.$$click=()=>e.loadMore.loadOld(),a(s,()=>t()("column.loadOld")),B(()=>r.disabled=!e.eose),r}})]};D(["click"]);const R=e=>t=>{switch(e.filterType){case"AND":return e.children.every(r=>R(r)(t));case"OR":return e.children.some(r=>R(r)(t));case"NOT":return!R(e.child)(t);case"Text":return t.includes(e.text);case"Regex":return new RegExp(e.regex,e.flag).test(t);default:console.error("unsupported content filter type");break}return!1},qn=e=>{const t=S(),{config:r,removeColumn:s}=$(),{followingPubkeys:l}=Me(()=>({pubkey:e.column.pubkey})),o=N(()=>({duration:4*60*60})),{events:c,eose:i}=L(()=>{const u=te([...l()]);return u.length===0?null:{debugId:"following",relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:u,limit:20,since:o.since(),until:o.until()}],eoseLimit:20,continuous:o.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:h=>e.column.contentFilter==null?!0:R(e.column.contentFilter)(h.content)}});return p(()=>{console.log("home",c()),o.setEvents(c())}),Q(()=>console.log("home timeline mounted")),le(()=>console.log("home timeline unmounted")),n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.home")},get icon(){return n(We,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return o.timelineRef},get children(){return n(O,{loadMore:o,get eose(){return i()},get children(){return n(K,{get events(){return c()}})}})}})},An=d('<div class="flex items-center gap-1 pl-[2px] text-sm"><div class="notification-icon flex max-w-[64px] place-items-center"></div><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon h-5 w-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class=shrink-0></span></div></div><div class=text-xs>'),Hn=d('<div class="notification-event py-1">'),jn=d('<img alt=icon class="h-full w-full object-cover">'),Kn=d("<div class=truncate> "),zn=e=>{const t=S(),r=Le(),{shouldMuteEvent:s}=$(),{showProfile:l}=ze(),o=()=>xe(e.event),c=()=>o().lastTaggedEventId(),{profile:i}=He(()=>({pubkey:e.event.pubkey})),{event:u,query:h}=Fe(()=>je([c()])(([m])=>({eventId:m}))),f=()=>h.isSuccess&&u()==null;return n(E,{get when(){return j(()=>!f())()&&!s(e.event)},get children(){return[(()=>{const m=An(),g=m.firstChild,v=g.nextSibling,C=v.firstChild,b=C.nextSibling,I=b.firstChild,y=I.nextSibling,_=v.nextSibling;return a(g,n(Pe,{get reactionTypes(){return o().toReactionTypes()}})),a(C,n(E,{get when(){return i()?.picture},keyed:!0,children:k=>(()=>{const x=jn();return B(()=>A(x,"src",Be(k,"icon"))),x})()})),I.$$click=()=>l(e.event.pubkey),a(I,n(Ke,{get pubkey(){return e.event.pubkey}})),a(y,()=>t()("notification.reacted")),a(_,()=>r(o().createdAtAsDate())),m})(),(()=>{const m=Hn();return a(m,n(E,{get when(){return u()},get fallback(){return(()=>{const g=Kn(),v=g.firstChild;return a(g,()=>t()("general.loading"),v),a(g,c,null),g})()},keyed:!0,children:g=>n(ce,{event:g})})),m})()]}})};D(["click"]);const Qn=d("<div>unknown event"),Gn=$e(()=>ke(()=>import("./ZapReceipt-63e2113d.js"),["assets/ZapReceipt-63e2113d.js","assets/index-0dea95bd.js","assets/index-a2e1f46d.css","assets/useFollowings-2b546950.js","assets/SideBar-7055a5c9.js","assets/usePersistStatus-cc308159.js","assets/globe-alt-4350ebc7.js","assets/LazyLoad-dba75178.js","assets/lud16ToLnurlPayUrl-8a6b3d00.js","assets/_baseClone-3a3982f9.js"])),ae=e=>{const{shouldMuteEvent:t}=$();return n(z,{get each(){return e.events},children:r=>n(E,{get when(){return!t(r)},get children(){return n(G,{get fallback(){return Qn()},get children(){return[n(w,{get when(){return r.kind===oe},get children(){return n(M,{get children(){return n(ce,{event:r})}})}}),n(w,{get when(){return r.kind===we},get children(){return n(M,{get children(){return n(zn,{event:r})}})}}),n(w,{get when(){return r.kind===Ce},get children(){return n(M,{get children(){return n(De,{event:r})}})}}),n(w,{get when(){return r.kind===be},get children(){return n(M,{get children(){return n(Gn,{event:r})}})}})]}})}})})},Vn=e=>{const t=S(),{config:r,removeColumn:s}=$(),l=N(()=>({duration:null})),{events:o,eose:c}=L(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6,7,9735],"#p":[e.column.pubkey],limit:20,since:l.since(),until:l.until()}],eoseLimit:20,clientEventFilter:i=>e.column.contentFilter==null?!0:R(e.column.contentFilter)(i.content)}));return p(()=>l.setEvents(o())),n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.notification")},get icon(){return n(Je,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return l.timelineRef},get children(){return n(O,{loadMore:l,get eose(){return c()},get children(){return n(ae,{get events(){return o()}})}})}})},Zn=e=>{const t=S(),{config:r,removeColumn:s}=$(),l=N(()=>({duration:null})),{events:o,eose:c}=L(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:R(e.column.contentFilter)(i.content)}));return p(()=>l.setEvents(o())),n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.posts")},get icon(){return n(Ye,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return l.timelineRef},get children(){return n(O,{loadMore:l,get eose(){return c()},get children(){return n(K,{get events(){return o()}})}})}})},Wn=e=>{const t=S(),{config:r,removeColumn:s}=$(),l=N(()=>({duration:null})),{events:o,eose:c}=L(()=>({relayUrls:r().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:R(e.column.contentFilter)(i.content)}));return p(()=>l.setEvents(o())),n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.reactions")},get icon(){return n(en,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return l.timelineRef},get children(){return n(O,{loadMore:l,get eose(){return c()},get children(){return n(ae,{get events(){return o()}})}})}})},Jn=e=>{const t=S(),{removeColumn:r}=$(),s=N(()=>({duration:4*60*60})),{events:l,eose:o}=L(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:s.since(),until:s.until()}],eoseLimit:20,clientEventFilter:c=>e.column.contentFilter==null?!0:R(e.column.contentFilter)(c.content)}));return p(()=>s.setEvents(l())),n(F,{get header(){return n(U,{get name(){return e.column.name??t()("column.relay")},get icon(){return n(nn,{})},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return s.timelineRef},get children(){return n(O,{loadMore:s,get eose(){return o()},get children(){return n(K,{get events(){return l()}})}})}})},Xn=d('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block h-4 w-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class="h-4 w-4">'),Yn=e=>{const[t,r]=T(!1),[s,l]=T(""),{saveColumn:o}=$(),c=()=>r(m=>!m),i=()=>{s()!==e.column.query&&o({...e.column,query:s()})},u=()=>{i()},h=m=>{l(m.currentTarget.value)},f=m=>{m.preventDefault(),i()};return Q(()=>{l(e.column.query)}),(()=>{const m=Xn(),g=m.firstChild,v=g.firstChild,C=v.firstChild,b=v.nextSibling,I=b.firstChild,y=b.nextSibling;return a(C,n(Xe,{})),b.addEventListener("submit",f),I.addEventListener("blur",u),I.addEventListener("change",h),y.$$click=()=>c(),a(y,n(ue,{})),a(m,n(E,{get when(){return t()},get children(){return e.settings()}}),null),B(()=>I.value=s()),m})()},et=e=>{const{removeColumn:t}=$(),r=N(()=>({duration:null})),{events:s,eose:l}=L(()=>{const{query:o}=e.column;return o.length===0?null:{relayUrls:_e,filters:[{kinds:[1],search:o,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:c=>c.tags.findIndex(([i])=>i==="mostr"||i==="proxy")>=0?!1:e.column.contentFilter==null?!0:R(e.column.contentFilter)(c.content)}});return p(()=>{r.setEvents(s())}),n(F,{get header(){return n(Yn,{get column(){return e.column},settings:()=>n(P,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>t(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get timelineRef(){return r.timelineRef},get children(){return n(O,{loadMore:r,get eose(){return l()},get children(){return n(K,{get events(){return s()}})}})}})};D(["click"]);const nt=d('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),tt=()=>{const{config:e}=$();return(()=>{const t=nt();return a(t,n(z,{get each(){return e().columns},children:(r,s)=>{const l=()=>s()+1,o=()=>l()===e().columns.length;return n(G,{get children(){return[n(w,{get when(){return r.columnType==="Following"&&r},keyed:!0,children:c=>n(qn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Notification"&&r},keyed:!0,children:c=>n(Vn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Posts"&&r},keyed:!0,children:c=>n(Zn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Reactions"&&r},keyed:!0,children:c=>n(Wn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Relays"&&r},keyed:!0,children:c=>n(Jn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Bookmark"&&r},keyed:!0,children:c=>n(Dn,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})}),n(w,{get when(){return r.columnType==="Search"&&r},keyed:!0,children:c=>n(et,{column:c,get columnIndex(){return l()},get lastColumn(){return o()}})})]}})}})),t})()},rt=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],ot=e=>{const t=new Map;return e.forEach(r=>{t.set(r.key,r)}),t},lt=({shortcuts:e=rt,onShortcut:t})=>{const r=ot(e);Q(()=>{const s=Qe(l=>{if(l.type!=="keydown"||l.ctrlKey||l.altKey||l.metaKey||l.target instanceof HTMLTextAreaElement||l.target instanceof HTMLInputElement)return;const o=r.get(l.key);o!=null&&t(o)},50);window.addEventListener("keydown",s),le(()=>{window.removeEventListener("keydown",s)})})},ct=()=>{const e=se();lt({onShortcut:t=>{e(t.command).then(()=>console.debug(`shortcut key '${t.key}' was processed successfully`),r=>console.error(r))}})},st=d('<div class="absolute inset-0 flex h-svh w-screen touch-manipulation flex-row overflow-hidden">'),yt=()=>{ct();const e=Ie(),{persistStatus:t}=tn(),r=Ze(),{config:s,initializeColumns:l}=$(),o=ie();return p(()=>{s().relayUrls.map(async c=>{try{const i=await r().ensureRelay(c);i.onnotice=u=>{console.error(`NOTICE: ${c}: ${u}`)},i.onclose=()=>{console.warn(`CLOSE: ${c}`)}}catch(i){console.error("ensureRelay failed",i)}})}),p(()=>{const c=o();c!=null&&l({pubkey:c})}),Q(()=>{t().loggedIn||e("/hello")}),Te(c=>{console.error("uncaught error: ",c)}),(()=>{const c=st();return a(c,n(Ge,{}),null),a(c,n(tt,{}),null),a(c,n(Ve,{}),null),c})()};export{yt as default};
//# sourceMappingURL=Home-d7a5a4d8.js.map
