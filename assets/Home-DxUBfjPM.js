const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-DhfJ3csa.js","assets/index-6dVx7tP6.js","assets/index-COSNOKCH.css","assets/EventDisplay-CQFYZFnc.js","assets/SideBar-BY3V6Hln.js","assets/resolveAsset-CXETVI6j.js","assets/SafeLink-DbO_Ee9d.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-CPCncyaY.js","assets/_baseClone-D1Vn0y3W.js","assets/arrow-left-Bxitr1eq.js","assets/useFollowings-_fQwl81w.js","assets/useSubscription-aLJKdyjF.js","assets/NostrSet-0DqsIPPi.js"])))=>i.map(i=>d[i]);
import{s as V,t as h,d as H,c as b,i as d,a as t,h as T,M as p,S as X,j as w,k as J,l as $e,u as I,m as E,n as Q,b as A,p as ke,F as G,f as F,q as oe,r as re,v as xe,w as P,x as be,y as le,z as we,A as Ce,B as z,o as Y,C as ce,D as se,E as _e,G as Te,H as pe,_ as Ie,R as Se,I as Ee,Z as Re,N as ie,J as Le,K as Oe}from"./index-6dVx7tP6.js";import{u as te,a as ue,b as ae,d as Me,p as me,c as Fe,r as Pe,t as He,B as ze,e as De,H as Ne,U as de,f as ge,g as W,h as Ue,i as Ae,j as Be,k as je,l as qe,G as Ke,M as Qe,m as Ve,S as Ge,n as Ze,o as Je}from"./SideBar-BY3V6Hln.js";import{A as We}from"./arrow-left-Bxitr1eq.js";import{T as B,C as K,u as Xe,a as D,L as N}from"./useFollowings-_fQwl81w.js";import{u as R}from"./useSubscription-aLJKdyjF.js";import{u as Ye,T as et,C as tt,E as nt,a as ot,b as rt,c as lt,d as ct,R as st,e as it,r as ut,f as at,g as mt,A as dt,H as gt}from"./EventDisplay-CQFYZFnc.js";import{N as ht,a as ft}from"./NostrSet-0DqsIPPi.js";import{t as vt}from"./url-DPIb-kBm.js";const yt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ee=(e={})=>(()=>{const n=yt();return V(n,e,!0),n})(),ne=h("<span class=truncate>"),$t=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="min-w-0 flex-1"><button type=button class="flex w-full select-text items-center gap-1 ps-2"></button></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),kt=h('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),U=e=>{const[n,o]=b(!1),i=()=>o(r=>!r);return(()=>{const r=$t(),c=r.firstChild,l=c.firstChild,s=l.firstChild,u=l.nextSibling,a=u.firstChild;return s.$$click=()=>e.onClickHeader?.(),d(s,t(T,{get when(){return e.icon},keyed:!0,children:m=>(()=>{const g=kt();return d(g,m),g})()}),null),d(s,t(T,{get when(){return e.onClickHeader},get fallback(){return(()=>{const m=ne();return d(m,()=>e.name),m})()},get children(){const m=ne();return d(m,()=>e.name),m}}),null),u.$$click=()=>i(),d(a,t(ee,{})),d(r,t(T,{get when(){return n()},get children(){return e.settings()}}),null),r})()};H(["click"]);const xt=e=>{const n=[e.id],o=e.rootEvent()?.id;o!=null&&n.push(o);const i=e.replyingToEvent()?.id;return i!=null&&n.push(i),J(n)},bt=e=>{const{config:n}=w(),o=()=>$e(e.event),{events:i}=R(()=>({relayUrls:n().relayUrls,filters:[{kinds:[1],ids:xt(o()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return t(B,{get events(){return[...i()].reverse()}})},wt=e=>t(X,{get children(){return t(p,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:n=>t(bt,{get event(){return n.event}})})}}),Ct=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),_t=h('<div class="shrink-0 border-b border-border">'),Tt=h('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),pt=h('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),It=h('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),L=e=>{let n;const o=Ye(),i=I(),r=()=>e.width??"medium";te(()=>({commandType:"moveToColumn",handler:s=>{s.command==="moveToColumn"&&s.columnIndex===e.columnIndex&&n?.scrollIntoView({behavior:"smooth",inline:"center"})}})),te(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&n?.scrollIntoView({behavior:"smooth"})}}));const[c,l]=b();return E(()=>{const s={scrollToTop:()=>{c()?.scrollTo({top:0,behavior:"smooth"})}};e.columnOperatorRef?.(s)}),t(et.Provider,{value:o,get children(){const s=Ct(),u=n;return typeof u=="function"?Q(u,s):n=s,d(s,t(T,{get when(){return o.timelineState.content},keyed:!0,get fallback(){return[(()=>{const a=_t();return d(a,()=>e.header),a})(),(()=>{const a=Tt();return Q(l,a),d(a,()=>e.children),a})()]},children:a=>[(()=>{const m=pt(),g=m.firstChild,v=g.firstChild,y=v.nextSibling;return g.$$click=()=>o?.clearTimeline(),d(v,t(We,{})),d(y,()=>i.t("column.back")),m})(),(()=>{const m=It();return Q(l,m),d(m,t(wt,{timelineContent:a})),m})()]})),A(a=>ke(s,{"sm:w-[500px]":r()==="widest","sm:w-[360px]":r()==="wide","sm:w-[320px]":r()==="medium","sm:w-[280px]":r()==="narrow"},a)),s}})};H(["click"]);const St=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),Et=(e={})=>(()=>{const n=St();return V(n,e,!0),n})(),Rt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),Lt=(e={})=>(()=>{const n=Rt();return V(n,e,!0),n})(),Ot=h('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),Mt=h('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),Ft=h('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),Pt=h('<button class="rounded-md border px-4 text-fg-secondary">'),he=e=>(()=>{const n=Ot(),o=n.firstChild,i=o.nextSibling;return d(o,()=>e.title),d(i,()=>e.children),n})(),O=e=>{const n=I(),{saveColumn:o,removeColumn:i,moveColumn:r}=w(),c=ue(),l=u=>{o({...e.column,width:u})},s=u=>{r(e.column.id,u),c({command:"moveToColumn",columnIndex:u}).catch(a=>console.error(a))};return(()=>{const u=Ft(),a=u.firstChild,m=a.firstChild,g=m.firstChild,v=m.nextSibling,y=v.firstChild,k=v.nextSibling,f=k.nextSibling,x=f.firstChild;return d(u,t(he,{get title(){return n.t("column.config.columnWidth")},get children(){const $=Mt();return d($,t(G,{each:["widest","wide","medium","narrow"],children:S=>(()=>{const C=Pt();return C.$$click=()=>l(S),d(C,()=>n.t(`column.config.${S}`)),A(_=>{const M=e.column.width===S,j=e.column.width===S,Z=e.column.width!==S,q=e.column.width!==S;return M!==_._v$5&&C.classList.toggle("border-fg-secondary",_._v$5=M),j!==_._v$6&&C.classList.toggle("font-bold",_._v$6=j),Z!==_._v$7&&C.classList.toggle("border-border",_._v$7=Z),q!==_._v$8&&C.classList.toggle("font-normal",_._v$8=q),_},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),C})()})),$}}),a),d(u,t(T,{get when(){return e.renderOtherSettings},keyed:!0,children:$=>$({column:e.column,saveColumn:o})}),a),m.$$click=()=>s(e.columnIndex-1),d(g,t(Et,{})),v.$$click=()=>s(e.columnIndex+1),d(y,t(tt,{})),f.$$click=()=>i(e.column.id),d(x,t(Lt,{})),A($=>{const S=n.t("column.config.moveLeft"),C=n.t("column.config.moveRight"),_=n.t("column.config.removeColumn"),M=n.t("column.config.removeColumn");return S!==$._v$&&F(m,"title",$._v$=S),C!==$._v$2&&F(v,"title",$._v$2=C),_!==$._v$3&&F(f,"title",$._v$3=_),M!==$._v$4&&F(x,"aria-label",$._v$4=M),$},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),u})()};H(["click"]);const[Ht,zt]=oe(()=>b({})),Dt=(e,n)=>zt(o=>({...o,[e]:n})),[Nt,Ut]=oe(()=>b({})),At=e=>re(()=>Nt()[e]??!1),fe=e=>{const n=ae(),[o,i]=b(null);return E(()=>{const r=e();if(r==null||r.encrypted.length===0)return;const{encrypted:c}=r,l=re(()=>Ht()[c]);if(l!=null){i(l);return}if(At(c))return;const s=n();if(s==null)return;const u=a=>Ut(m=>({...m,[c]:a}));u(!0),Me(s,c).then(a=>{xe(()=>{Dt(c,a),i(a)})}).catch(a=>{console.error(`failed to decrypt "${c}"`,a)}).finally(()=>{u(!1)})}),o},Bt=e=>{const n=P(()=>be(e.event)),o=fe(()=>{const{content:c}=n();return c==null||c.length===0?null:{id:n().id,encrypted:c}}),i=()=>{const c=o();if(c==null)return[];console.log(c);try{return me(c).taggedEventIds()}catch(l){return console.warn(l),[]}},r=()=>n().taggedEventIds();return t(G,{get each(){return[...r(),...i()]},children:c=>t(K,{get children(){return t(nt,{eventId:c,get ensureKinds(){return[le]}})}})})},jt=e=>["useParameterizedReplaceableEvent",e],ve=e=>{const n=we(),o=P(e),i=()=>jt(o()),r=Ce(()=>({queryKey:i(),queryFn:({queryKey:l,signal:s})=>{const[,u]=l;if(u==null)return Promise.resolve(null);const{kind:a,author:m,identifier:g}=u,v=new ze({type:"ParameterizedReplaceableEvent",kind:a,author:m,identifier:g}),y=v.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${a}:${m}:${g}`)});return v.onUpdate(k=>{const f=Fe(k);n.setQueryData(l,f)}),Pe({task:v,signal:s}),He(15e3,`useParameterizedReplaceableEvent: ${a}:${m}:${g}`)(y)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>r.data??null,query:r}},qt=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=b(),{event:c}=ve(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.bookmark")},get icon(){return t(De,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(T,{get when(){return c()},keyed:!0,children:l=>t(Bt,{event:l})})}})},Kt=e=>{const n=I(),{config:o,removeColumn:i}=w(),{followingPubkeys:r}=Xe(()=>({pubkey:e.column.pubkey})),[c,l]=b(),s=D(()=>({duration:4*60*60,onLoad:()=>{c()?.scrollToTop()}})),{events:u,eose:a}=R(()=>{const m=J([...r()]);return m.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:m,limit:20,since:s.since(),until:s.until()}],eoseLimit:20,continuous:s.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:g=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(g.content)}});return E(()=>{console.log("home",u()),s.setEvents(u())}),Y(()=>console.log("home timeline mounted")),ce(()=>console.log("home timeline unmounted")),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.home")},get icon(){return t(Ne,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>c()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:l,get children(){return t(N,{loadMore:s,get eose(){return a()},get children(){return t(B,{get events(){return u()}})}})}})},Qt=h('<button type=button class="size-4 shrink-0">'),Vt=h('<div class="flex items-start gap-2 break-all border-t border-border p-1"><div class="mt-1 size-14 shrink-0 overflow-hidden rounded"></div><div class="flex flex-1 flex-col overflow-hidden"><h3 class="truncate text-lg font-bold"></h3><p class="max-h-[3.25rem] overflow-y-auto break-all text-sm">'),Gt=h('<img class="size-full object-cover"alt=icon>'),Zt=h('<div class=text-xs><button class="select-text truncate hover:text-link hover:underline">'),Jt=e=>{const{showProfile:n}=ge(),o=ot(()=>({menu:e.otherActionMenuItems??[]}));return(()=>{const i=Vt(),r=i.firstChild,c=r.nextSibling,l=c.firstChild,s=l.nextSibling;return d(r,t(T,{get when(){return e.image},keyed:!0,children:u=>(()=>{const a=Gt();return F(a,"src",u),a})()})),d(l,()=>e.title),d(s,()=>e.description),d(c,t(T,{get when(){return e.authorPubkey},keyed:!0,children:u=>(()=>{const a=Zt(),m=a.firstChild;return m.$$click=()=>n(u),d(m,t(de,{pubkey:u})),a})()}),null),d(i,t(T,{get when(){return e.otherActionMenuItems},get children(){return[(()=>{const u=Qt();u.$$click=()=>o.open();const a=o.targetRef;return typeof a=="function"?Q(a,u):o.targetRef=u,d(u,t(ee,{})),u})(),P(()=>o.popup())]}}),null),i})()};H(["click"]);const Wt=e=>{const n=P(e),{query:o}=ve(()=>({kind:se,author:n().author,identifier:n().identifier})),i=()=>o.data,r=fe(()=>W([i()?.content])(([g])=>({encrypted:g}))),c=P(()=>{const g=r();if(g==null)return null;const v=me(g);return new ht(v.tags)}),l=P(()=>o.data==null?null:new ft(o.data));return{event:i,followSet:l,pubkeys:()=>[...l()?.taggedPubkeys()??[],...c()?.taggedPubkeys()??[]],title:()=>l()?.title()||c()?.title(),description:()=>l()?.description()||c()?.description(),image:()=>l()?.image()||c()?.image(),query:o}},Xt=e=>{const n=I(),o=()=>_e({pubkey:e.author,identifier:e.identifier,kind:se}),i=[{content:n.t("column.columnInfoCommon.copyId"),onSelect:()=>{navigator.clipboard.writeText(o()).catch(r=>window.alert(r))}}];return t(Jt,{get image(){return e.image},get authorPubkey(){return e.author},get title(){return e.title??e.identifier},get description(){return e.description},otherActionMenuItems:i})},Yt=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),{followSet:l,image:s,title:u,description:a,pubkeys:m}=Wt(()=>({author:e.column.author,identifier:e.column.identifier})),g=()=>e.column.name||u()||l()?.identifier()||n.t("column.followSet"),v=D(()=>({duration:null})),{events:y,eose:k}=R(()=>{const f=J([...m()]);return f.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:f,limit:20,since:v.since(),until:v.until()}],eoseLimit:20,continuous:v.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:x=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(x.content)}});return t(L,{get header(){return t(U,{get name(){return g()},get icon(){return t(Ue,{})},settings:()=>[t(Xt,{get author(){return e.column.author},get identifier(){return e.column.identifier},get image(){return s()},get title(){return u()},get description(){return a()}}),t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}})],onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:v,get eose(){return k()},get children(){return t(B,{get events(){return y()}})}})}})},en=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),tn=(e={})=>(()=>{const n=en();return V(n,e,!0),n})(),nn=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),on=(e={})=>(()=>{const n=nn();return V(n,e,!0),n})(),rn=h('<div class="flex items-center gap-1 pl-[2px] text-sm"><span class="webkit-touch-callout-none notification-icon flex h-4 min-w-4 max-w-[64px] shrink-0 select-none place-items-center overflow-hidden"></span><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),ln=h('<div class="notification-event py-1">'),cn=h('<img alt=icon class="size-full object-cover">'),sn=h("<div class=truncate> "),un=e=>{const n=I(),o=rt(),{shouldMuteEvent:i}=w(),{showProfile:r}=ge(),c=()=>Te(e.event),l=()=>c().lastTaggedEventId(),{profile:s}=Ae(()=>({pubkey:e.event.pubkey})),{event:u,query:a}=lt(()=>W([l()])(([k])=>({eventId:k}))),m=()=>a.isSuccess&&u()==null,g=()=>c().toReactionTypes(),v=()=>ut(g()),y=ct(()=>W([v()])(([k])=>({emoji:k})));return t(T,{get when(){return P(()=>!m())()&&!i(e.event)},get children(){return[(()=>{const k=rn(),f=k.firstChild,x=f.nextSibling,$=x.firstChild,S=$.nextSibling,C=S.firstChild,_=C.nextSibling,M=x.nextSibling,j=y.emojiRef;return typeof j=="function"?Q(j,f):y.emojiRef=f,d(f,t(st,{get reactionTypes(){return g()}})),d(k,()=>y.popup(),x),d($,t(T,{get when(){return s()?.picture},keyed:!0,children:Z=>(()=>{const q=cn();return A(()=>F(q,"src",vt(Z,"icon"))),q})()})),C.$$click=()=>r(e.event.pubkey),d(C,t(de,{get pubkey(){return e.event.pubkey}})),d(_,()=>n.t("notification.reacted")),d(M,()=>o(c().createdAtAsDate())),k})(),(()=>{const k=ln();return d(k,t(T,{get when(){return u()},get fallback(){return(()=>{const f=sn(),x=f.firstChild;return d(f,()=>n.t("general.loading"),x),d(f,l,null),f})()},keyed:!0,children:f=>t(it,{event:f})})),k})()]}})};H(["click"]);const an=h("<div>unknown event"),mn=pe(()=>Ie(()=>import("./ZapReceipt-DhfJ3csa.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ye=e=>{const{shouldMuteEvent:n}=w();return t(G,{get each(){return e.events},children:o=>t(T,{get when(){return!n(o)},get children(){return t(X,{get fallback(){return an()},get children(){return[t(p,{get when(){return o.kind===le},get children(){return t(K,{get children(){return t(at,{event:o})}})}}),t(p,{get when(){return o.kind===Se},get children(){return t(K,{get children(){return t(un,{event:o})}})}}),t(p,{get when(){return o.kind===Ee},get children(){return t(K,{get children(){return t(mt,{event:o})}})}}),t(p,{get when(){return o.kind===Re},get children(){return t(K,{get children(){return t(mn,{event:o})}})}})]}})}})})},dn=h('<div class="flex gap-1">'),gn=h('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),hn={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},fn=e=>{const n=I(),o=[{notificationType:"Replies",title:n.t("column.notificationSettings.types.replies"),icon:t(tn,{})},{notificationType:"Repost",title:n.t("column.notificationSettings.types.reposts"),icon:t(dt,{})},{notificationType:"Reaction",title:n.t("column.notificationSettings.types.reactions"),icon:t(gt,{})},{notificationType:"Zap",title:n.t("column.notificationSettings.types.zap"),icon:t(on,{})}],i=()=>e.column.notificationTypes??[...ie],r=l=>i().includes(l),c=l=>{const s=[...i()];r(l)?s.splice(s.indexOf(l),1):s.push(l),e.saveColumn({...e.column,notificationTypes:s})};return t(he,{get title(){return n.t("column.notificationSettings.notificationTypes")},get children(){const l=dn();return d(l,t(G,{each:o,children:({notificationType:s,title:u,icon:a})=>(()=>{const m=gn(),g=m.firstChild,v=g.nextSibling;return m.$$click=()=>c(s),F(m,"title",u),d(g,a),d(v,u),A(y=>{const k=!!r(s),f=!!r(s),x=!r(s),$=!r(s);return k!==y._v$&&m.classList.toggle("border-fg-secondary",y._v$=k),f!==y._v$2&&m.classList.toggle("font-bold",y._v$2=f),x!==y._v$3&&m.classList.toggle("border-border",y._v$3=x),$!==y._v$4&&m.classList.toggle("font-normal",y._v$4=$),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),m})()})),l}})},vn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),s=()=>e.column.notificationTypes??[...ie],u=()=>J(s().flatMap(g=>hn[g])),{events:a,eose:m}=R(()=>u().length>0?{relayUrls:o().relayUrls,filters:[{kinds:u(),"#p":[e.column.pubkey],limit:20,since:l.since(),until:l.until()}],eoseLimit:20,clientEventFilter:g=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(g.content)}:null);return E(()=>l.setEvents(a())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.notification")},get icon(){return t(Be,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:fn}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return m()},get children(){return t(ye,{get events(){return a()}})}})}})};H(["click"]);const yn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:s,eose:u}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:a=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(a.content)}));return E(()=>l.setEvents(s())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.posts")},get icon(){return t(je,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return u()},get children(){return t(B,{get events(){return s()}})}})}})},$n=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:s,eose:u}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:a=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(a.content)}));return E(()=>l.setEvents(s())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.reactions")},get icon(){return t(qe,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return u()},get children(){return t(ye,{get events(){return s()}})}})}})},kn=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=b(),c=D(()=>({duration:4*60*60,onLoad:()=>{i()?.scrollToTop()}})),{events:l,eose:s}=R(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:c.since(),until:c.until()}],eoseLimit:20,clientEventFilter:u=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(u.content)}));return E(()=>c.setEvents(l())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.relay")},get icon(){return t(Ke,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(N,{loadMore:c,get eose(){return s()},get children(){return t(B,{get events(){return l()}})}})}})},xn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center"><button type=button class="inline-block size-4 text-fg-secondary"></button></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),bn=e=>{const[n,o]=b(!1),[i,r]=b(""),{saveColumn:c}=w(),l=()=>o(g=>!g),s=()=>{i()!==e.column.query&&c({...e.column,query:i()})},u=()=>{s()},a=g=>{r(g.currentTarget.value)},m=g=>{g.preventDefault(),s()};return Y(()=>{r(e.column.query)}),(()=>{const g=xn(),v=g.firstChild,y=v.firstChild,k=y.firstChild,f=y.nextSibling,x=f.firstChild,$=f.nextSibling;return k.$$click=()=>e.onClickHeader?.(),d(k,t(Qe,{})),f.addEventListener("submit",m),x.addEventListener("blur",u),x.addEventListener("change",a),$.$$click=()=>l(),d($,t(ee,{})),d(g,t(T,{get when(){return n()},get children(){return e.settings()}}),null),A(()=>x.value=i()),g})()},wn=e=>{const{removeColumn:n}=w(),[o,i]=b(),r=D(()=>({duration:null,onLoad:()=>{o()?.scrollToTop()}})),{events:c,eose:l}=R(()=>{const{query:s}=e.column;return s.length===0?null:{relayUrls:Le,filters:[{kinds:[1],search:s,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:u=>u.tags.findIndex(([a])=>a==="mostr"||a==="proxy")>=0?!1:e.column.contentFilter==null?!0:z(e.column.contentFilter)(u.content)}});return E(()=>{r.setEvents(c())}),t(L,{get header(){return t(bn,{get column(){return e.column},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>n(e.column.id),onClickHeader:()=>o()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:i,get children(){return t(N,{loadMore:r,get eose(){return l()},get children(){return t(B,{get events(){return c()}})}})}})};H(["click"]);const Cn=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),_n=()=>{const{config:e}=w();return(()=>{const n=Cn();return d(n,t(G,{get each(){return e().columns},children:(o,i)=>{const r=()=>i()+1,c=()=>r()===e().columns.length;return t(X,{get children(){return[t(p,{get when(){return o.columnType==="Following"&&o},keyed:!0,children:l=>t(Kt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Notification"&&o},keyed:!0,children:l=>t(vn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Posts"&&o},keyed:!0,children:l=>t(yn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Reactions"&&o},keyed:!0,children:l=>t($n,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Relays"&&o},keyed:!0,children:l=>t(kn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="FollowSet"&&o},keyed:!0,children:l=>t(Yt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Bookmark"&&o},keyed:!0,children:l=>t(qt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Search"&&o},keyed:!0,children:l=>t(wn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})})]}})}})),n})()},Tn=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],pn=e=>{const n=new Map;return e.forEach(o=>{n.set(o.key,o)}),n},In=({shortcuts:e=Tn,onShortcut:n})=>{const o=pn(e);Y(()=>{const i=Ve(r=>{if(r.type!=="keydown"||r.ctrlKey||r.altKey||r.metaKey||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLInputElement)return;const c=o.get(r.key);c!=null&&n(c)},50);window.addEventListener("keydown",i),ce(()=>{window.removeEventListener("keydown",i)})})},Sn=()=>{const e=ue();In({onShortcut:n=>{e(n.command).then(()=>console.debug(`shortcut key '${n.key}' was processed successfully`),o=>console.error(o))}})},En=h('<div class="absolute inset-0 flex h-dvh w-screen touch-manipulation flex-row overflow-hidden">'),Rn=()=>{Sn();const e=Je(),{config:n,initializeColumns:o}=w(),i=ae();return E(()=>{Promise.allSettled(n().relayUrls.map(async r=>{try{const c=await e().ensureRelay(r);c.onnotice=l=>{console.error(`NOTICE: ${r}: ${l}`)},c.onclose=()=>{console.warn(`CLOSE: ${r}`)}}catch(c){console.error("ensureRelay failed",c)}})).catch(()=>{})}),E(()=>{const r=i();r!=null&&o({pubkey:r})}),Oe(r=>{console.error("uncaught error: ",r)}),(()=>{const r=En();return d(r,t(Ge,{}),null),d(r,t(_n,{}),null),d(r,t(Ze,{}),null),r})()},Nn=Object.freeze(Object.defineProperty({__proto__:null,default:Rn},Symbol.toStringTag,{value:"Module"}));export{on as B,Nn as H};
//# sourceMappingURL=Home-DxUBfjPM.js.map
