import{s as U,t as h,d as j,c as P,i as u,a as t,S as T,M as b,b as G,u as S,e as K,f as de,g as ge,h as O,j as oe,k as z,l as le,F as J,m as he,o as Q,n as ce,p as fe,q as ve}from"./index-c8f3d890.js";import{u as N,T as q,a as ye,b as w,t as xe,c as ke,d as Z,A as we,e as $e,f as ie,z as W,g as be,h as se,i as Ce,C as A,E as _e,K as H,j as Ie,p as Te,r as Ee,k as Se,B as pe,l as Re,H as Fe,m as Ne,n as ue,o as Le,q as Me,s as Pe,U as Be,v as De,w as Oe,x as Ue,y as je,D as qe,R as Ae,F as He,G as ze,I as Ke,J as Qe,M as We,L as Ve,_ as Ge,N as X,O as Je,P as Xe,S as Ye,Q as Ze,V as en}from"./SideBar-c681e957.js";import{u as nn}from"./usePersistStatus-aef7dcaf.js";const tn=h('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0z">'),rn=(e={})=>(()=>{const n=tn();return U(n,e,!0,!0),n})(),on=h('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5zm0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5zm0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5z">'),ae=(e={})=>(()=>{const n=on();return U(n,e,!0,!0),n})(),ln=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex flex-1 items-center gap-1"><span class="column-name"></span></h2><button class="h-4 w-4">'),cn=h('<span class="inline-block h-4 w-4 text-gray-700">'),B=e=>{const[n,r]=P(!1),i=()=>r(o=>!o);return(()=>{const o=ln(),l=o.firstChild,c=l.firstChild,s=c.firstChild,m=c.nextSibling;return u(c,t(T,{get when(){return e.icon},keyed:!0,children:g=>(()=>{const d=cn();return u(d,g),d})()}),s),u(s,()=>e.name),m.$$click=()=>i(),u(m,t(ae,{})),u(o,t(T,{get when(){return n()},get children(){return e.settings()}}),null),o})()};j(["click"]);const sn=e=>{const n=[e.id],r=e.rootEvent()?.id;r!=null&&n.push(r);const i=e.replyingToEvent()?.id;return i!=null&&n.push(i),ye(n)},un=e=>{const{config:n}=w(),r=()=>xe(e.event),{events:i}=N(()=>({relayUrls:n().relayUrls,filters:[{kinds:[1],ids:sn(r()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return t(q,{get events(){return[...i()].reverse()}})},an=e=>t(G,{get children(){return t(b,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:n=>t(un,{get event(){return n.event}})})}}),mn=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r sm:snap-align-none">'),dn=h('<div class="shrink-0 border-b">'),gn=h('<div class="scrollbar flex flex-col overflow-y-scroll scroll-smooth">'),hn=h('<div class="h-full w-full bg-white"><div class="flex shrink-0 items-center border-b bg-white px-2"><button class="flex w-full items-center gap-1"><div class="inline-block h-4 w-4"></div><div></div></button></div><ul class="scrollbar flex h-full flex-col overflow-y-scroll scroll-smooth pb-8">'),L=e=>{let n;const r=ke(),i=S(),o=()=>e.width??"medium";return Z(()=>({commandType:"moveToColumn",handler:l=>{l.command==="moveToColumn"&&l.columnIndex===e.columnIndex&&n?.scrollIntoView({behavior:"smooth",inline:"center"})}})),Z(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&n?.scrollIntoView({behavior:"smooth"})}})),t($e.Provider,{value:r,get children(){const l=mn(),c=n;return typeof c=="function"?ge(c,l):n=l,u(l,t(T,{get when(){return r.timelineState.content},keyed:!0,get fallback(){return[(()=>{const s=dn();return u(s,()=>e.header),s})(),(()=>{const s=gn();return u(s,()=>e.children),s})()]},children:s=>(()=>{const m=hn(),g=m.firstChild,d=g.firstChild,a=d.firstChild,f=a.nextSibling,x=g.nextSibling;return d.$$click=()=>r?.clearTimeline(),u(a,t(we,{})),u(f,()=>i()("column.back")),u(x,t(an,{timelineContent:s})),m})()})),K(s=>de(l,{"sm:w-[500px]":o()==="widest","sm:w-[360px]":o()==="wide","sm:w-[320px]":o()==="medium","sm:w-[280px]":o()==="narrow"},s)),l}})};j(["click"]);const fn=h('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5">'),vn=(e={})=>(()=>{const n=fn();return U(n,e,!0,!0),n})(),yn=h('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5">'),xn=(e={})=>(()=>{const n=yn();return U(n,e,!0,!0),n})(),kn=h('<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),wn=(e={})=>(()=>{const n=kn();return U(n,e,!0,!0),n})(),$n=h('<div class="flex flex-col gap-2 border-b p-2"><div></div><div>'),bn=h('<div class="scrollbar flex h-9 gap-2 overflow-x-scroll"><button class="rounded-md border px-4 hover:bg-stone-100"></button><button class="rounded-md border px-4 hover:bg-stone-100"></button><button class="rounded-md border px-4 hover:bg-stone-100"></button><button class="rounded-md border px-4 hover:bg-stone-100">'),Cn=h('<div class="flex flex-col border-t"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block h-4 w-4"></span></button><button class="py-4 pr-2"><span class="inline-block h-4 w-4"></span></button><div class="flex-1"></div><button class="px-2 py-4 text-rose-500 hover:text-rose-600"><span class="inline-block h-4 w-4">'),_n=e=>(()=>{const n=$n(),r=n.firstChild,i=r.nextSibling;return u(r,()=>e.title),u(i,()=>e.children),n})(),M=e=>{const n=S(),{saveColumn:r,removeColumn:i,moveColumn:o}=w(),l=ie(),c=m=>{r({...e.column,width:m})},s=m=>{o(e.column.id,m),l({command:"moveToColumn",columnIndex:m}).catch(g=>console.error(g))};return(()=>{const m=Cn(),g=m.firstChild,d=g.firstChild,a=d.firstChild,f=d.nextSibling,x=f.firstChild,C=f.nextSibling,k=C.nextSibling,$=k.firstChild;return u(m,t(_n,{get title(){return n()("column.config.columnWidth")},get children(){const v=bn(),_=v.firstChild,p=_.nextSibling,R=p.nextSibling,I=R.nextSibling;return _.$$click=()=>c("widest"),u(_,()=>n()("column.config.widest")),p.$$click=()=>c("wide"),u(p,()=>n()("column.config.wide")),R.$$click=()=>c("medium"),u(R,()=>n()("column.config.medium")),I.$$click=()=>c("narrow"),u(I,()=>n()("column.config.narrow")),v}}),g),d.$$click=()=>s(e.columnIndex-1),u(a,t(vn,{})),f.$$click=()=>s(e.columnIndex+1),u(x,t(xn,{})),k.$$click=()=>i(e.column.id),u($,t(wn,{})),K(v=>{const _=n()("column.config.moveLeft"),p=n()("column.config.moveRight"),R=n()("column.config.removeColumn"),I=n()("column.config.removeColumn");return _!==v._v$&&O(d,"title",v._v$=_),p!==v._v$2&&O(f,"title",v._v$2=p),R!==v._v$3&&O(k,"title",v._v$3=R),I!==v._v$4&&O($,"aria-label",v._v$4=I),v},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),m})()};j(["click"]);const In=W.array(W.array(W.string()));class Tn extends be{constructor(n){super(),this.tags=n}}const En=e=>{try{const n=In.parse(JSON.parse(e));return new Tn(n)}catch(n){throw new TypeError("failed to parse tags schema: ",{cause:n})}},[ee,Sn]=oe(()=>P({})),[pn,Rn]=oe(()=>P({})),Fn=e=>{const n=se(),[r,i]=P(null);return z(()=>{const o=e();if(o==null)return;const{encrypted:l}=o;if(l in ee()){i(ee()[l]);return}const c=n();c!=null&&(pn()[l]||(Rn(s=>({...s,[l]:!0})),window.nostr?.nip04?.decrypt?.(c,l)?.then(s=>{Sn(m=>({...m,[l]:s})),i(s)}).catch(s=>{console.error(`failed to decrypt "${l}"`,s)})))}),r},Nn=e=>{const n=le(()=>Ce(e.event)),r=Fn(()=>{const{content:l}=n();return l==null||l.length===0?null:{id:n().id,encrypted:l}}),i=()=>{const l=r();if(l==null)return[];console.log(l);try{return En(l).taggedEventIds()}catch(c){return console.warn(c),[]}},o=()=>n().taggedEventIds();return t(J,{get each(){return[...o(),...i()]},children:l=>t(A,{get children(){return t(_e,{eventId:l,get ensureKinds(){return[H.Text]}})}})})},Ln=e=>{const n=he(),r=le(e),o=Ie(()=>["useFollowings",r()],({queryKey:c,signal:s})=>{console.debug("useFollowings");const[,m]=c;if(m==null)return Promise.resolve(null);const{kind:g,author:d,identifier:a}=m,f=new pe({type:"ParameterizedReplaceableEvent",kind:g,author:d,identifier:a}),x=f.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${g}:${d}:${a}`)});return f.onUpdate(C=>{const k=Te(C);n.setQueryData(c,k)}),Ee({task:f,signal:s}),Se(15e3,`useParameterizedReplaceableEvent: ${g}:${d}:${a}`)(x)},{staleTime:5*60*1e3,cacheTime:4*60*60*1e3});return{event:()=>o.data??null,query:o}},Mn=e=>{const n=S(),{removeColumn:r}=w(),{event:i}=Ln(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.bookmark")},get icon(){return t(rn,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(T,{get when(){return i()},keyed:!0,children:o=>t(Nn,{event:o})})}})},E=e=>n=>{switch(e.filterType){case"AND":return e.children.every(r=>E(r)(n));case"OR":return e.children.some(r=>E(r)(n));case"NOT":return!E(e.child)(n);case"Text":return n.includes(e.text);case"Regex":return new RegExp(e.regex,e.flag).test(n);default:console.error("unsupported content filter type");break}return!1},Pn=e=>{const n=S(),{config:r,removeColumn:i}=w(),{followingPubkeys:o}=Re(()=>({pubkey:e.column.pubkey})),{events:l}=N(()=>{const c=Ne.uniq([...o()]);return c.length===0?null:{debugId:"following",relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:c,limit:10,since:ue()-4*60*60}],clientEventFilter:s=>e.column.contentFilter==null?!0:E(e.column.contentFilter)(s.content)}});return z(()=>{console.log("home",l())}),Q(()=>console.log("home timeline mounted")),ce(()=>console.log("home timeline unmounted")),t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.home")},get icon(){return t(Fe,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(q,{get events(){return l()}})}})},Bn=h('<img alt="icon" class="rounded">'),Dn=h('<div class="flex gap-1 px-1 text-sm"><div class="notification-icon flex max-w-[64px] place-items-center"></div><div class="notification-user flex gap-1 overflow-hidden"><div class="author-icon h-5 w-5 shrink-0 overflow-hidden object-cover"></div><div class="flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-blue-500 hover:underline">'),On=h('<div class="notification-event py-1">'),Un=h('<div class="truncate"> '),jn=e=>{const n=S(),{shouldMuteEvent:r}=w(),{showProfile:i}=Oe(),o=()=>Ue(e.event),l=()=>o().lastTaggedEventId(),{profile:c}=Le(()=>({pubkey:e.event.pubkey})),{event:s,query:m}=Me(()=>je([l()])(([d])=>({eventId:d}))),g=()=>m.isSuccess&&s()==null;return t(T,{get when(){return!g()||r(e.event)},get children(){return[(()=>{const d=Dn(),a=d.firstChild,f=a.nextSibling,x=f.firstChild,C=x.nextSibling,k=C.firstChild;return u(a,t(Pe,{get reactionTypes(){return o().toReactionTypes()}})),u(x,t(T,{get when(){return c()?.picture!=null},get children(){const $=Bn();return K(()=>O($,"src",c()?.picture)),$}})),k.$$click=()=>i(e.event.pubkey),u(k,t(Be,{get pubkey(){return e.event.pubkey}})),u(C,()=>n()("notification.reacted"),null),d})(),(()=>{const d=On();return u(d,t(T,{get when(){return s()},get fallback(){return(()=>{const a=Un(),f=a.firstChild;return u(a,()=>n()("general.loading"),f),u(a,l,null),a})()},keyed:!0,children:a=>t(De,{event:a})})),d})()]}})};j(["click"]);const qn=h("<div>unknown event"),me=e=>{const{shouldMuteEvent:n}=w();return t(J,{get each(){return e.events},children:r=>t(T,{get when(){return!n(r)},get children(){return t(G,{get fallback(){return qn()},get children(){return[t(b,{get when(){return r.kind===H.Text},get children(){return t(A,{get children(){return t(qe,{event:r})}})}}),t(b,{get when(){return r.kind===H.Reaction},get children(){return t(A,{get children(){return t(jn,{event:r})}})}}),t(b,{get when(){return r.kind===H.Repost},get children(){return t(A,{get children(){return t(Ae,{event:r})}})}})]}})}})})},An=e=>{const n=S(),{config:r,removeColumn:i}=w(),{events:o}=N(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6,7],"#p":[e.column.pubkey],limit:10}],clientEventFilter:l=>e.column.contentFilter==null?!0:E(e.column.contentFilter)(l.content)}));return t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.notification")},get icon(){return t(He,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(me,{get events(){return o()}})}})},Hn=e=>{const n=S(),{config:r,removeColumn:i}=w(),{events:o}=N(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10}],clientEventFilter:l=>e.column.contentFilter==null?!0:E(e.column.contentFilter)(l.content)}));return t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.posts")},get icon(){return t(ze,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(q,{get events(){return o()}})}})},zn=e=>{const n=S(),{config:r,removeColumn:i}=w(),{events:o}=N(()=>({relayUrls:r().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10}],clientEventFilter:l=>e.column.contentFilter==null?!0:E(e.column.contentFilter)(l.content)}));return t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.reactions")},get icon(){return t(Ke,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(me,{get events(){return o()}})}})},Kn=e=>{const n=S(),{removeColumn:r}=w(),{events:i}=N(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:25,since:ue()-4*60*60}],clientEventFilter:o=>e.column.contentFilter==null?!0:E(e.column.contentFilter)(o.content)}));return t(L,{get header(){return t(B,{get name(){return e.column.name??n()("column.relay")},get icon(){return t(Qe,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(q,{get events(){return i()}})}})},Qn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block h-4 w-4 text-gray-700"></span></h2><form class="flex-1"><input class="w-full rounded border border-stone-300 px-1 py-0 focus:border-rose-100 focus:ring-rose-300" type="text" name="query"></form><button class="h-4 w-4">'),Wn=e=>{const[n,r]=P(!1),[i,o]=P(""),{saveColumn:l}=w(),c=()=>r(a=>!a),s=()=>{i()!==e.column.query&&l({...e.column,query:i()})},m=()=>{s()},g=a=>{o(a.currentTarget.value)},d=a=>{a.preventDefault(),s()};return Q(()=>{o(e.column.query)}),(()=>{const a=Qn(),f=a.firstChild,x=f.firstChild,C=x.firstChild,k=x.nextSibling,$=k.firstChild,v=k.nextSibling;return u(C,t(We,{})),k.addEventListener("submit",d),$.addEventListener("blur",m),$.addEventListener("change",g),v.$$click=()=>c(),u(v,t(ae,{})),u(a,t(T,{get when(){return n()},get children(){return e.settings()}}),null),K(()=>$.value=i()),a})()},Vn=e=>{const{removeColumn:n}=w(),{events:r}=N(()=>{const{query:i}=e.column;return i.length===0?null:{relayUrls:Ve,filters:[{kinds:[1,6],search:i,limit:25}],clientEventFilter:o=>o.tags.findIndex(([l])=>l==="mostr"||l==="proxy")>=0?!1:e.column.contentFilter==null?!0:E(e.column.contentFilter)(o.content)}});return t(L,{get header(){return t(Wn,{get column(){return e.column},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>n(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(q,{get events(){return r()}})}})};j(["click"]);const Gn=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),Jn=()=>{const{config:e}=w();return(()=>{const n=Gn();return u(n,t(J,{get each(){return e().columns},children:(r,i)=>{const o=()=>i()+1,l=()=>o()===e().columns.length;return t(G,{get children(){return[t(b,{get when(){return r.columnType==="Following"&&r},keyed:!0,children:c=>t(Pn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Notification"&&r},keyed:!0,children:c=>t(An,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Posts"&&r},keyed:!0,children:c=>t(Hn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Reactions"&&r},keyed:!0,children:c=>t(zn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Relays"&&r},keyed:!0,children:c=>t(Kn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Bookmark"&&r},keyed:!0,children:c=>t(Mn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),t(b,{get when(){return r.columnType==="Search"&&r},keyed:!0,children:c=>t(Vn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})})]}})}})),n})()};var Xn=Ge,Yn=function(){return Xn.Date.now()},Zn=Yn,et=/\s/;function nt(e){for(var n=e.length;n--&&et.test(e.charAt(n)););return n}var tt=nt,rt=tt,ot=/^\s+/;function lt(e){return e&&e.slice(0,rt(e)+1).replace(ot,"")}var ct=lt,it=ct,ne=X,st=Je,te=0/0,ut=/^[-+]0x[0-9a-f]+$/i,at=/^0b[01]+$/i,mt=/^0o[0-7]+$/i,dt=parseInt;function gt(e){if(typeof e=="number")return e;if(st(e))return te;if(ne(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=ne(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=it(e);var r=at.test(e);return r||mt.test(e)?dt(e.slice(2),r?2:8):ut.test(e)?te:+e}var ht=gt,ft=X,V=Zn,re=ht,vt="Expected a function",yt=Math.max,xt=Math.min;function kt(e,n,r){var i,o,l,c,s,m,g=0,d=!1,a=!1,f=!0;if(typeof e!="function")throw new TypeError(vt);n=re(n)||0,ft(r)&&(d=!!r.leading,a="maxWait"in r,l=a?yt(re(r.maxWait)||0,n):l,f="trailing"in r?!!r.trailing:f);function x(y){var F=i,D=o;return i=o=void 0,g=y,c=e.apply(D,F),c}function C(y){return g=y,s=setTimeout(v,n),d?x(y):c}function k(y){var F=y-m,D=y-g,Y=n-F;return a?xt(Y,l-D):Y}function $(y){var F=y-m,D=y-g;return m===void 0||F>=n||F<0||a&&D>=l}function v(){var y=V();if($(y))return _(y);s=setTimeout(v,k(y))}function _(y){return s=void 0,f&&i?x(y):(i=o=void 0,c)}function p(){s!==void 0&&clearTimeout(s),g=0,i=m=o=s=void 0}function R(){return s===void 0?c:_(V())}function I(){var y=V(),F=$(y);if(i=arguments,o=this,m=y,F){if(s===void 0)return C(m);if(a)return clearTimeout(s),s=setTimeout(v,n),x(m)}return s===void 0&&(s=setTimeout(v,n)),c}return I.cancel=p,I.flush=R,I}var wt=kt,$t=wt,bt=X,Ct="Expected a function";function _t(e,n,r){var i=!0,o=!0;if(typeof e!="function")throw new TypeError(Ct);return bt(r)&&(i="leading"in r?!!r.leading:i,o="trailing"in r?!!r.trailing:o),$t(e,n,{leading:i,maxWait:n,trailing:o})}var It=_t;const Tt=Xe(It),Et=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],St=e=>{const n=new Map;return e.forEach(r=>{n.set(r.key,r)}),n},pt=({shortcuts:e=Et,onShortcut:n})=>{const r=St(e);Q(()=>{const i=Tt(o=>{if(o.type!=="keydown"||o.ctrlKey||o.altKey||o.metaKey||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLInputElement)return;const l=r.get(o.key);l!=null&&n(l)},50);window.addEventListener("keydown",i),ce(()=>{window.removeEventListener("keydown",i)})})},Rt=()=>{const e=ie();pt({onShortcut:n=>{e(n.command).then(()=>console.debug(`shortcut key '${n.key}' was processed successfully`),r=>console.error(r))}})},Ft=h('<div class="absolute inset-0 flex w-screen touch-manipulation flex-row overflow-hidden">'),Pt=()=>{Rt();const e=fe(),{persistStatus:n}=nn(),r=en(),{config:i,initializeColumns:o}=w(),l=se();return z(()=>{i().relayUrls.map(async c=>{try{(await r().ensureRelay(c)).on("notice",m=>{console.error(`NOTICE: ${c}: ${m}`)})}catch(s){console.error("ensureRelay failed",s)}})}),z(()=>{const c=l();c!=null&&o({pubkey:c})}),Q(()=>{n().loggedIn||e("/hello")}),ve(c=>{console.error("uncaught error: ",c)}),(()=>{const c=Ft();return u(c,t(Ye,{}),null),u(c,t(Jn,{}),null),u(c,t(Ze,{}),null),c})()};export{Pt as default};
//# sourceMappingURL=Home-db0da215.js.map
