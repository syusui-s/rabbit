const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-CCKVnQmQ.js","assets/index-CbXZld-o.js","assets/index-CyuN3WeO.css","assets/EventDisplay-B_C4ZLJn.js","assets/SideBar-QP03rlVs.js","assets/resolveAsset-0WSS-QY2.js","assets/SafeLink-DlGj2HXs.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-C7aIF09Z.js","assets/_baseClone-qJufYynA.js","assets/arrow-left-PF39QuaU.js","assets/useFollowings-Cn7byUmF.js","assets/useSubscription-CPqs05Fd.js"])))=>i.map(i=>d[i]);
import{s as O,t as h,d as z,c as P,i as u,a as n,h as T,M as _,S as V,j as C,k as Z,l as me,u as p,b as D,m as de,n as ne,F as K,f as F,p as te,q as S,r as W,v as ge,w as oe,x as he,y as ve,z as B,o as J,A as re,B as fe,C as ye,_ as $e,R as xe,D as ke,Z as we,N as le,E as be,G as Ce}from"./index-CbXZld-o.js";import{u as X,a as ce,b as se,p as _e,c as Ie,r as Te,t as pe,B as Se,d as Ee,H as Re,e as Le,f as Y,U as Me,g as Fe,h as Pe,i as De,j as ze,G as Be,M as Ne,k as je,S as Ue,l as qe,m as Ae}from"./SideBar-QP03rlVs.js";import{A as He}from"./arrow-left-PF39QuaU.js";import{T as Q,C as H,u as Oe,a as N,L as j}from"./useFollowings-Cn7byUmF.js";import{u as R}from"./useSubscription-CPqs05Fd.js";import{u as Ke,T as Qe,C as Ge,E as Ve,a as Ze,b as We,c as Je,R as Xe,d as Ye,r as en,e as nn,f as tn,A as on,H as rn}from"./EventDisplay-B_C4ZLJn.js";import{t as ln}from"./url-DPIb-kBm.js";const cn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ie=(e={})=>(()=>{const t=cn();return O(t,e,!0),t})(),sn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"><span class=truncate></span></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),un=h('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),U=e=>{const[t,r]=P(!1),s=()=>r(o=>!o);return(()=>{const o=sn(),l=o.firstChild,c=l.firstChild,i=c.firstChild,a=c.nextSibling,m=a.firstChild;return u(c,n(T,{get when(){return e.icon},keyed:!0,children:d=>(()=>{const g=un();return u(g,d),g})()}),i),u(i,()=>e.name),a.$$click=()=>s(),u(m,n(ie,{})),u(o,n(T,{get when(){return t()},get children(){return e.settings()}}),null),o})()};z(["click"]);const an=e=>{const t=[e.id],r=e.rootEvent()?.id;r!=null&&t.push(r);const s=e.replyingToEvent()?.id;return s!=null&&t.push(s),Z(t)},mn=e=>{const{config:t}=C(),r=()=>me(e.event),{events:s}=R(()=>({relayUrls:t().relayUrls,filters:[{kinds:[1],ids:an(r()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return n(Q,{get events(){return[...s()].reverse()}})},dn=e=>n(V,{get children(){return n(_,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:t=>n(mn,{get event(){return t.event}})})}}),gn=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),hn=h('<div class="shrink-0 border-b border-border">'),vn=h('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),fn=h('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),yn=h('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),L=e=>{let t;const r=Ke(),s=p(),o=()=>e.width??"medium";return X(()=>({commandType:"moveToColumn",handler:l=>{l.command==="moveToColumn"&&l.columnIndex===e.columnIndex&&t?.scrollIntoView({behavior:"smooth",inline:"center"})}})),X(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&t?.scrollIntoView({behavior:"smooth"})}})),n(Qe.Provider,{value:r,get children(){const l=gn(),c=t;return typeof c=="function"?ne(c,l):t=l,u(l,n(T,{get when(){return r.timelineState.content},keyed:!0,get fallback(){return[(()=>{const i=hn();return u(i,()=>e.header),i})(),(()=>{const i=vn();return u(i,()=>e.children),i})()]},children:i=>[(()=>{const a=fn(),m=a.firstChild,d=m.firstChild,g=d.nextSibling;return m.$$click=()=>r?.clearTimeline(),u(d,n(He,{})),u(g,()=>s.t("column.back")),a})(),(()=>{const a=yn();return u(a,n(dn,{timelineContent:i})),a})()]})),D(i=>de(l,{"sm:w-[500px]":o()==="widest","sm:w-[360px]":o()==="wide","sm:w-[320px]":o()==="medium","sm:w-[280px]":o()==="narrow"},i)),l}})};z(["click"]);const $n=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),xn=(e={})=>(()=>{const t=$n();return O(t,e,!0),t})(),kn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),wn=(e={})=>(()=>{const t=kn();return O(t,e,!0),t})(),bn=h('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),Cn=h('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),_n=h('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),In=h('<button class="rounded-md border px-4 text-fg-secondary">'),ue=e=>(()=>{const t=bn(),r=t.firstChild,s=r.nextSibling;return u(r,()=>e.title),u(s,()=>e.children),t})(),M=e=>{const t=p(),{saveColumn:r,removeColumn:s,moveColumn:o}=C(),l=ce(),c=a=>{r({...e.column,width:a})},i=a=>{o(e.column.id,a),l({command:"moveToColumn",columnIndex:a}).catch(m=>console.error(m))};return(()=>{const a=_n(),m=a.firstChild,d=m.firstChild,g=d.firstChild,k=d.nextSibling,y=k.firstChild,$=k.nextSibling,v=$.nextSibling,x=v.firstChild;return u(a,n(ue,{get title(){return t.t("column.config.columnWidth")},get children(){const f=Cn();return u(f,n(K,{each:["widest","wide","medium","narrow"],children:I=>(()=>{const w=In();return w.$$click=()=>c(I),u(w,()=>t.t(`column.config.${I}`)),D(b=>{const E=e.column.width===I,q=e.column.width===I,G=e.column.width!==I,A=e.column.width!==I;return E!==b._v$5&&w.classList.toggle("border-fg-secondary",b._v$5=E),q!==b._v$6&&w.classList.toggle("font-bold",b._v$6=q),G!==b._v$7&&w.classList.toggle("border-border",b._v$7=G),A!==b._v$8&&w.classList.toggle("font-normal",b._v$8=A),b},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),w})()})),f}}),m),u(a,n(T,{get when(){return e.renderOtherSettings},keyed:!0,children:f=>f({column:e.column,saveColumn:r})}),m),d.$$click=()=>i(e.columnIndex-1),u(g,n(xn,{})),k.$$click=()=>i(e.columnIndex+1),u(y,n(Ge,{})),v.$$click=()=>s(e.column.id),u(x,n(wn,{})),D(f=>{const I=t.t("column.config.moveLeft"),w=t.t("column.config.moveRight"),b=t.t("column.config.removeColumn"),E=t.t("column.config.removeColumn");return I!==f._v$&&F(d,"title",f._v$=I),w!==f._v$2&&F(k,"title",f._v$2=w),b!==f._v$3&&F(v,"title",f._v$3=b),E!==f._v$4&&F(x,"aria-label",f._v$4=E),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()};z(["click"]);const[ee,Tn]=te(()=>P({})),[pn,Sn]=te(()=>P({})),En=e=>{const t=se(),[r,s]=P(null);return S(()=>{const o=e();if(o==null)return;const{encrypted:l}=o;if(l in ee()){s(ee()[l]);return}const c=t();c!=null&&(pn()[l]||(Sn(i=>({...i,[l]:!0})),window.nostr?.nip04?.decrypt?.(c,l)?.then(i=>{Tn(a=>({...a,[l]:i})),s(i)}).catch(i=>{console.error(`failed to decrypt "${l}"`,i)})))}),r},Rn=e=>{const t=W(()=>ge(e.event)),r=En(()=>{const{content:l}=t();return l==null||l.length===0?null:{id:t().id,encrypted:l}}),s=()=>{const l=r();if(l==null)return[];console.log(l);try{return _e(l).taggedEventIds()}catch(c){return console.warn(c),[]}},o=()=>t().taggedEventIds();return n(K,{get each(){return[...o(),...s()]},children:l=>n(H,{get children(){return n(Ve,{eventId:l,get ensureKinds(){return[oe]}})}})})},Ln=e=>{const t=he(),r=W(e),s=()=>["useFollowings",r()],o=ve(()=>({queryKey:s(),queryFn:({queryKey:c,signal:i})=>{console.debug("useFollowings");const[,a]=c;if(a==null)return Promise.resolve(null);const{kind:m,author:d,identifier:g}=a,k=new Se({type:"ParameterizedReplaceableEvent",kind:m,author:d,identifier:g}),y=k.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${m}:${d}:${g}`)});return k.onUpdate($=>{const v=Ie($);t.setQueryData(c,v)}),Te({task:k,signal:i}),pe(15e3,`useParameterizedReplaceableEvent: ${m}:${d}:${g}`)(y)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>o.data??null,query:o}},Mn=e=>{const t=p(),{removeColumn:r}=C(),{event:s}=Ln(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.bookmark")},get icon(){return n(Ee,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(T,{get when(){return s()},keyed:!0,children:o=>n(Rn,{event:o})})}})},Fn=e=>{const t=p(),{config:r,removeColumn:s}=C(),{followingPubkeys:o}=Oe(()=>({pubkey:e.column.pubkey})),l=N(()=>({duration:4*60*60})),{events:c,eose:i}=R(()=>{const a=Z([...o()]);return a.length===0?null:{debugId:"following",relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:a,limit:20,since:l.since(),until:l.until()}],eoseLimit:20,continuous:l.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:m=>e.column.contentFilter==null?!0:B(e.column.contentFilter)(m.content)}});return S(()=>{console.log("home",c()),l.setEvents(c())}),J(()=>console.log("home timeline mounted")),re(()=>console.log("home timeline unmounted")),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.home")},get icon(){return n(Re,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:l,get eose(){return i()},get children(){return n(Q,{get events(){return c()}})}})}})},Pn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),Dn=(e={})=>(()=>{const t=Pn();return O(t,e,!0),t})(),zn=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),Bn=(e={})=>(()=>{const t=zn();return O(t,e,!0),t})(),Nn=h('<div class="flex items-center gap-1 pl-[2px] text-sm"><span class="webkit-touch-callout-none notification-icon flex h-4 min-w-4 max-w-[64px] shrink-0 select-none place-items-center overflow-hidden"></span><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),jn=h('<div class="notification-event py-1">'),Un=h('<img alt=icon class="size-full object-cover">'),qn=h("<div class=truncate> "),An=e=>{const t=p(),r=Ze(),{shouldMuteEvent:s}=C(),{showProfile:o}=Fe(),l=()=>fe(e.event),c=()=>l().lastTaggedEventId(),{profile:i}=Le(()=>({pubkey:e.event.pubkey})),{event:a,query:m}=We(()=>Y([c()])(([$])=>({eventId:$}))),d=()=>m.isSuccess&&a()==null,g=()=>l().toReactionTypes(),k=()=>en(g()),y=Je(()=>Y([k()])(([$])=>({emoji:$})));return n(T,{get when(){return W(()=>!d())()&&!s(e.event)},get children(){return[(()=>{const $=Nn(),v=$.firstChild,x=v.nextSibling,f=x.firstChild,I=f.nextSibling,w=I.firstChild,b=w.nextSibling,E=x.nextSibling,q=y.emojiRef;return typeof q=="function"?ne(q,v):y.emojiRef=v,u(v,n(Xe,{get reactionTypes(){return g()}})),u($,()=>y.popup(),x),u(f,n(T,{get when(){return i()?.picture},keyed:!0,children:G=>(()=>{const A=Un();return D(()=>F(A,"src",ln(G,"icon"))),A})()})),w.$$click=()=>o(e.event.pubkey),u(w,n(Me,{get pubkey(){return e.event.pubkey}})),u(b,()=>t.t("notification.reacted")),u(E,()=>r(l().createdAtAsDate())),$})(),(()=>{const $=jn();return u($,n(T,{get when(){return a()},get fallback(){return(()=>{const v=qn(),x=v.firstChild;return u(v,()=>t.t("general.loading"),x),u(v,c,null),v})()},keyed:!0,children:v=>n(Ye,{event:v})})),$})()]}})};z(["click"]);const Hn=h("<div>unknown event"),On=ye(()=>$e(()=>import("./ZapReceipt-CCKVnQmQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),ae=e=>{const{shouldMuteEvent:t}=C();return n(K,{get each(){return e.events},children:r=>n(T,{get when(){return!t(r)},get children(){return n(V,{get fallback(){return Hn()},get children(){return[n(_,{get when(){return r.kind===oe},get children(){return n(H,{get children(){return n(nn,{event:r})}})}}),n(_,{get when(){return r.kind===xe},get children(){return n(H,{get children(){return n(An,{event:r})}})}}),n(_,{get when(){return r.kind===ke},get children(){return n(H,{get children(){return n(tn,{event:r})}})}}),n(_,{get when(){return r.kind===we},get children(){return n(H,{get children(){return n(On,{event:r})}})}})]}})}})})},Kn=h('<div class="flex gap-1">'),Qn=h('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),Gn={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},Vn=e=>{const t=p(),r=[{notificationType:"Replies",title:t.t("column.notificationSettings.types.replies"),icon:n(Dn,{})},{notificationType:"Repost",title:t.t("column.notificationSettings.types.reposts"),icon:n(on,{})},{notificationType:"Reaction",title:t.t("column.notificationSettings.types.reactions"),icon:n(rn,{})},{notificationType:"Zap",title:t.t("column.notificationSettings.types.zap"),icon:n(Bn,{})}],s=()=>e.column.notificationTypes??[...le],o=c=>s().includes(c),l=c=>{const i=[...s()];o(c)?i.splice(i.indexOf(c),1):i.push(c),e.saveColumn({...e.column,notificationTypes:i})};return n(ue,{get title(){return t.t("column.notificationSettings.notificationTypes")},get children(){const c=Kn();return u(c,n(K,{each:r,children:({notificationType:i,title:a,icon:m})=>(()=>{const d=Qn(),g=d.firstChild,k=g.nextSibling;return d.$$click=()=>l(i),F(d,"title",a),u(g,m),u(k,a),D(y=>{const $=!!o(i),v=!!o(i),x=!o(i),f=!o(i);return $!==y._v$&&d.classList.toggle("border-fg-secondary",y._v$=$),v!==y._v$2&&d.classList.toggle("font-bold",y._v$2=v),x!==y._v$3&&d.classList.toggle("border-border",y._v$3=x),f!==y._v$4&&d.classList.toggle("font-normal",y._v$4=f),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()})),c}})},Zn=e=>{const t=p(),{config:r,removeColumn:s}=C(),o=N(()=>({duration:null})),l=()=>e.column.notificationTypes??[...le],c=()=>Z(l().flatMap(m=>Gn[m])),{events:i,eose:a}=R(()=>c().length>0?{relayUrls:r().relayUrls,filters:[{kinds:c(),"#p":[e.column.pubkey],limit:20,since:o.since(),until:o.until()}],eoseLimit:20,clientEventFilter:m=>e.column.contentFilter==null?!0:B(e.column.contentFilter)(m.content)}:null);return S(()=>o.setEvents(i())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.notification")},get icon(){return n(Pe,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:Vn}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:o,get eose(){return a()},get children(){return n(ae,{get events(){return i()}})}})}})};z(["click"]);const Wn=e=>{const t=p(),{config:r,removeColumn:s}=C(),o=N(()=>({duration:null})),{events:l,eose:c}=R(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:B(e.column.contentFilter)(i.content)}));return S(()=>o.setEvents(l())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.posts")},get icon(){return n(De,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:o,get eose(){return c()},get children(){return n(Q,{get events(){return l()}})}})}})},Jn=e=>{const t=p(),{config:r,removeColumn:s}=C(),o=N(()=>({duration:null})),{events:l,eose:c}=R(()=>({relayUrls:r().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:B(e.column.contentFilter)(i.content)}));return S(()=>o.setEvents(l())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.reactions")},get icon(){return n(ze,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:o,get eose(){return c()},get children(){return n(ae,{get events(){return l()}})}})}})},Xn=e=>{const t=p(),{removeColumn:r}=C(),s=N(()=>({duration:4*60*60})),{events:o,eose:l}=R(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:s.since(),until:s.until()}],eoseLimit:20,clientEventFilter:c=>e.column.contentFilter==null?!0:B(e.column.contentFilter)(c.content)}));return S(()=>s.setEvents(o())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.relay")},get icon(){return n(Be,{})},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:s,get eose(){return l()},get children(){return n(Q,{get events(){return o()}})}})}})},Yn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block size-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),et=e=>{const[t,r]=P(!1),[s,o]=P(""),{saveColumn:l}=C(),c=()=>r(g=>!g),i=()=>{s()!==e.column.query&&l({...e.column,query:s()})},a=()=>{i()},m=g=>{o(g.currentTarget.value)},d=g=>{g.preventDefault(),i()};return J(()=>{o(e.column.query)}),(()=>{const g=Yn(),k=g.firstChild,y=k.firstChild,$=y.firstChild,v=y.nextSibling,x=v.firstChild,f=v.nextSibling;return u($,n(Ne,{})),v.addEventListener("submit",d),x.addEventListener("blur",a),x.addEventListener("change",m),f.$$click=()=>c(),u(f,n(ie,{})),u(g,n(T,{get when(){return t()},get children(){return e.settings()}}),null),D(()=>x.value=s()),g})()},nt=e=>{const{removeColumn:t}=C(),r=N(()=>({duration:null})),{events:s,eose:o}=R(()=>{const{query:l}=e.column;return l.length===0?null:{relayUrls:be,filters:[{kinds:[1],search:l,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:c=>c.tags.findIndex(([i])=>i==="mostr"||i==="proxy")>=0?!1:e.column.contentFilter==null?!0:B(e.column.contentFilter)(c.content)}});return S(()=>{r.setEvents(s())}),n(L,{get header(){return n(et,{get column(){return e.column},settings:()=>n(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>t(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(j,{loadMore:r,get eose(){return o()},get children(){return n(Q,{get events(){return s()}})}})}})};z(["click"]);const tt=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),ot=()=>{const{config:e}=C();return(()=>{const t=tt();return u(t,n(K,{get each(){return e().columns},children:(r,s)=>{const o=()=>s()+1,l=()=>o()===e().columns.length;return n(V,{get children(){return[n(_,{get when(){return r.columnType==="Following"&&r},keyed:!0,children:c=>n(Fn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Notification"&&r},keyed:!0,children:c=>n(Zn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Posts"&&r},keyed:!0,children:c=>n(Wn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Reactions"&&r},keyed:!0,children:c=>n(Jn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Relays"&&r},keyed:!0,children:c=>n(Xn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Bookmark"&&r},keyed:!0,children:c=>n(Mn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Search"&&r},keyed:!0,children:c=>n(nt,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})})]}})}})),t})()},rt=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],lt=e=>{const t=new Map;return e.forEach(r=>{t.set(r.key,r)}),t},ct=({shortcuts:e=rt,onShortcut:t})=>{const r=lt(e);J(()=>{const s=je(o=>{if(o.type!=="keydown"||o.ctrlKey||o.altKey||o.metaKey||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLInputElement)return;const l=r.get(o.key);l!=null&&t(l)},50);window.addEventListener("keydown",s),re(()=>{window.removeEventListener("keydown",s)})})},st=()=>{const e=ce();ct({onShortcut:t=>{e(t.command).then(()=>console.debug(`shortcut key '${t.key}' was processed successfully`),r=>console.error(r))}})},it=h('<div class="absolute inset-0 flex h-dvh w-screen touch-manipulation flex-row overflow-hidden">'),ut=()=>{st();const e=Ae(),{config:t,initializeColumns:r}=C(),s=se();return S(()=>{Promise.allSettled(t().relayUrls.map(async o=>{try{const l=await e().ensureRelay(o);l.onnotice=c=>{console.error(`NOTICE: ${o}: ${c}`)},l.onclose=()=>{console.warn(`CLOSE: ${o}`)}}catch(l){console.error("ensureRelay failed",l)}})).catch(()=>{})}),S(()=>{const o=s();o!=null&&r({pubkey:o})}),Ce(o=>{console.error("uncaught error: ",o)}),(()=>{const o=it();return u(o,n(Ue,{}),null),u(o,n(ot,{}),null),u(o,n(qe,{}),null),o})()},yt=Object.freeze(Object.defineProperty({__proto__:null,default:ut},Symbol.toStringTag,{value:"Module"}));export{Bn as B,yt as H};
//# sourceMappingURL=Home-BImcmmnx.js.map
