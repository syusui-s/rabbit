const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EventDebugModal-C8kfjc08.js","assets/index-B7R5E62q.js","assets/index-C_OvIQlF.css","assets/BasicModal-Cy5SEX8a.js","assets/SideBar-DtCkeG-j.js","assets/resolveAsset-C5PFNW9K.js","assets/Copy-CRSepnQq.js","assets/UserList-lyKZQw34.js","assets/url-CEJjbZ3u.js","assets/SafeLink-CL6n3To8.js","assets/ZapRequestModal-bvy-c3T9.js","assets/lud16ToLnurlPayUrl-CoJ8TyLv.js","assets/_baseClone-un0qFo_z.js","assets/useSubscription-C0Vv6F87.js"])))=>i.map(i=>d[i]);
import{t as h,s as q,w as M,aW as Ee,a as r,g as E,i as a,h as y,A as V,u as I,aX as nt,j as D,M as x,ah as rt,S as U,c as C,m as Re,B as Q,r as Ce,x as ot,d as j,o as Z,F as G,n as H,aY as st,R as lt,z as Y,H as W,I as Te,aZ as it,J as oe,v as ct,y as J,a_ as at,b as P,p as K,D as L,_ as se,a$ as ut,al as Me,am as dt,aj as ht,ag as gt,T as ft,ai as vt,k as mt}from"./index-B7R5E62q.js";import{B as le,r as $t,t as yt,g as N,f as ie,U as wt,C as Pe,q as ce,s as ae,D as Se,b as X,z as ee,E as bt,l as kt,I as pt,J as _t,i as Ie,v as De,a as xt,m as Et,N as Rt}from"./SideBar-DtCkeG-j.js";import{S as R}from"./SafeLink-CL6n3To8.js";import{t as je,a as ge,b as Le,p as Ct,c as Tt,d as Mt,e as Pt,i as St}from"./url-CEJjbZ3u.js";const It=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3">'),Ae=((e={})=>(()=>{const t=It();return q(t,e,!0,!0),t})()),Dt=h("<span>"),jt=h('<a class="text-link underline">'),O=e=>{const t=M(()=>{try{return`nostr:${Ee({id:e.eventId})}`}catch(n){return console.error("failed to encode event id into Bech32 entity (NIP-19) but ignore",e.eventId,n),null}});return r(y,{get when(){return t()},get fallback(){return(()=>{const n=Dt();return a(n,()=>e.eventId),n})()},keyed:!0,children:n=>(()=>{const o=jt();return E(o,"href",n),a(o,n),o})()})},Lt=e=>{const t=M(e),n=V(()=>({queryKey:["useEvent",t()],queryFn:({queryKey:s,signal:c})=>{const[,l]=s;if(l==null)return null;const{eventId:i}=l,u=new le({type:"Event",eventId:i}),d=u.firstEventPromise().catch(()=>{throw new Error(`event not found: ${i}`)});return console.log("useEvent",t()),$t({task:u,signal:c}),yt(15e3,`useEvent: ${i}`)(d)},staleTime:14400*1e3,gcTime:14400*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{event:()=>n.data??null,query:n}},At=h("<span>"),Ht=h("<div class=truncate> "),z=e=>{const t=I(),[n,o]=nt(e,["eventId"]),{shouldMuteEvent:s}=D(),{event:c,query:l}=Lt(()=>N([n.eventId])(([u])=>({eventId:u}))),i=()=>{const u=c();return e.displayForcibly?!1:u!=null&&s(u)};return r(U,{get fallback(){return(()=>{const u=At();return a(u,()=>t.t("post.failedToFetchEvent"),null),a(u,()=>e.eventId,null),u})()},get children(){return[r(x,{get when(){return i()},children:null}),r(x,{get when(){return c()},keyed:!0,children:u=>r(Gr,rt({event:u},o))}),r(x,{get when(){return l.isLoading&&n.eventId},keyed:!0,children:u=>(()=>{const d=Ht(),g=d.firstChild;return a(d,()=>t.t("general.loading"),g),a(d,r(O,{eventId:u}),null),d})()})]}})},He=e=>{const[t,n]=C(new Date);return Re(()=>{const o=setInterval(()=>{n(new Date)},e().interval);Q(()=>clearInterval(o))}),t},Bt=e=>{switch(e.kind){case"now":return"now";case"seconds":return`${e.value}s`;case"minutes":return`${e.value}m`;case"hours":return`${e.value}h`;case"days":return`${e.value}d`;default:return e.value.toLocaleDateString()}},fe=e=>`${e.getHours()}:${e.getMinutes().toString().padStart(2,"0")}`,Ut=e=>e.kind==="today"?e.value.toLocaleTimeString():e.value.toLocaleString(),qt=e=>{switch(e.kind){case"today":return fe(e.value);case"yesterday":return`昨日 ${fe(e.value)}`;default:return e.value.toLocaleString()}},Ot=(e,t)=>Math.round(Number(t)-Number(e))/1e3,zt=(e,t)=>{const n=Ot(e,t);return n<10?{kind:"now"}:n<60?{kind:"seconds",value:Math.round(n)}:n<3600?{kind:"minutes",value:Math.round(n/60)}:n<86400?{kind:"hours",value:Math.round(n/3600)}:n<604800?{kind:"days",value:Math.round(n/86400)}:{kind:"abs",value:e}},ve=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),Ft=e=>new Date(+e-1440*60*1e3),Be=(e,t,n)=>ve(e,t)?n({kind:"today",value:e}):ve(e,Ft(t))?n({kind:"yesterday",value:e}):n({kind:"abs",value:e}),Wt=(e,t=new Date)=>Be(e,t,Ut),Kt=(e,t=new Date)=>Be(e,t,qt),me=(e,t=new Date,n=Bt)=>n(zt(e,t)),$e=Ce(()=>He(()=>({interval:7e3}))),ye=Ce(()=>He(()=>({interval:60*1e3}))),Ue=()=>{const{config:e}=D();return t=>{switch(e().dateFormat){case"absolute-long":return Wt(t,ye());case"absolute-short":return Kt(t,ye());case"relative":return me(t,$e());default:return me(t,$e())}}},Nt=h('<div><div class="flex items-center gap-1"><div class="flex shrink-0 place-items-center pl-[2px]"aria-hidden=true><span class="size-4 text-r-repost"></span></div><div class="notification-user flex min-w-0 flex-1 overflow-hidden text-xs"><button class="truncate select-text hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div><div class=text-xs></div></div><div class=pt-1>'),Vt=e=>{const t=I(),{showProfile:n}=ie(),o=Ue(),s=M(()=>ot(e.event)),c=()=>s().lastTaggedEventId();return(()=>{const l=Nt(),i=l.firstChild,u=i.firstChild,d=u.firstChild,g=u.nextSibling,f=g.firstChild,v=f.nextSibling,b=g.nextSibling,m=i.nextSibling;return a(d,r(Ae,{})),f.$$click=()=>n(e.event.pubkey),a(f,r(wt,{get pubkey(){return e.event.pubkey}})),a(v,()=>t.t("notification.reposted")),a(b,()=>o(s().createdAtAsDate())),a(m,r(z,{get eventId(){return c()}})),l})()};j(["click"]);const Qt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5z">'),Zt=((e={})=>(()=>{const t=Qt();return q(t,e,!0,!0),t})()),Gt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741z">'),Yt=((e={})=>(()=>{const t=Gt();return q(t,e,!0,!0),t})()),Jt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0">'),Xt=((e={})=>(()=>{const t=Jt();return q(t,e,!0,!0),t})()),en=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path d="m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z">'),qe=((e={})=>(()=>{const t=en();return q(t,e,!0,!0),t})()),tn=h("<span class=truncate>"),nn=h('<img class="pointer-events-none h-full w-auto object-contain">'),Oe=e=>r(U,{get children(){return[r(x,{get when(){return e.emoji.type==="Emoji"&&e.emoji.content},keyed:!0,children:t=>(()=>{const n=tn();return a(n,t),n})()}),r(x,{get when(){return e.emoji.type==="CustomEmoji"&&e.emoji},keyed:!0,children:({shortcode:t,url:n})=>(()=>{const o=nn();return E(o,"src",n),E(o,"alt",`:${t}:`),o})()})]}}),rn=h('<span class="inline-block size-full pt-px text-r-reaction">'),on=h("<span class=truncate>"),sn=e=>e.type==="LikeDislike"&&(e.content==="+"||e.content.length===0),ze=e=>{if(e.type==="Emoji"||e.type==="CustomEmoji")return e},Fe=e=>r(U,{get fallback(){return(()=>{const t=on();return a(t,()=>e.reactionTypes.content),t})()},get children(){return[r(x,{get when(){return sn(e.reactionTypes)},get children(){const t=rn();return a(t,r(qe,{})),t}}),r(x,{get when(){return ze(e.reactionTypes)},keyed:!0,children:t=>r(Oe,{emoji:t})})]}}),ln=300,cn=e=>{let t,n=!1;return Z(()=>{if(t==null)return;const{onLongPress:o,onClick:s,delay:c=ln}=e();let l;const i=()=>{n=!1,l=setTimeout(()=>{n=!0,o()},c)},u=()=>{l!=null&&clearTimeout(l)},d=()=>{i()},g=()=>{u()},f=()=>{n||(u(),s())};t.addEventListener("mousedown",d),t.addEventListener("mouseup",g),t.addEventListener("touchstart",d),t.addEventListener("touchend",g),t.addEventListener("click",f),Q(()=>{u(),t?.removeEventListener("mouseddown",d),t?.removeEventListener("mouseup",g),t?.removeEventListener("touchstart",d),t?.removeEventListener("touchend",g),t?.removeEventListener("click",f)})}),{ref:o=>{t=o}}},an=h('<div><div class="flex h-24 max-w-5xl min-w-24 items-center justify-center rounded-sm border border-border bg-bg text-5xl shadow-sm">'),We=e=>{let t;const n=M(e),[o,s]=C(!1),c=()=>{setTimeout(()=>{o()||i.close()},100)},l=()=>{i.open()},i=Pe(()=>({popup:()=>r(y,{get when(){return n()?.emoji},keyed:!0,children:d=>(()=>{const g=an(),f=g.firstChild;return g.addEventListener("mouseleave",()=>{s(!1),c()}),g.addEventListener("mouseenter",()=>{s(!0)}),a(f,r(Oe,{emoji:d})),g})()}),position:{x:"center",y:"top"}})),u=cn(()=>({onLongPress:()=>l(),onClick:()=>n()?.onClick?.()}));return Z(()=>{t?.addEventListener("mouseenter",l),t?.addEventListener("mouseleave",c)}),{emojiRef:d=>{t=d,i.targetRef(d),u.ref(d)},popup:i.popup}},un=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m8.25 4.5 7.5 7.5-7.5 7.5">'),dn=((e={})=>(()=>{const t=un();return q(t,e,!0,!0),t})()),hn=h('<li class="border-b border-border hover:bg-bg-tertiary"><button class="w-full px-4 py-1 text-start">'),gn=h('<li class="border-b border-border hover:bg-bg-tertiary"><button class="flex w-full items-center py-1 ps-4 pe-2 text-start"><span class=flex-1></span><span class="inline-block size-4 shrink-0">'),fn=h('<ul class="min-w-[96px] rounded-sm border border-border bg-bg shadow-md">'),vn=e=>{const t=()=>{e.item?.onSelect?.(),e.onClose()};return(()=>{const n=hn(),o=n.firstChild;return o.$$click=t,a(o,()=>e.item.content),n})()},mn=e=>{const t=Ke(()=>({menu:e.submenu.items,position:{x:"right",y:"bottom"}})),n=()=>{t.open()};return(()=>{const o=gn(),s=o.firstChild,c=s.firstChild,l=c.nextSibling,i=t.targetRef;return typeof i=="function"?H(i,o):t.targetRef=o,s.$$click=n,a(c,()=>e.submenu.content),a(l,r(dn,{})),a(o,()=>t.popup(),null),o})()},$n=e=>"onSelect"in e?e:null,yn=e=>"items"in e?e:null,Ke=e=>{const t=M(e),n=Pe(()=>({ensureWidth:300,position:{x:"right",y:"bottom"},...t(),popup:(()=>{const o=fn();return a(o,r(G,{get each(){return t().menu.filter(s=>s.when==null||s.when())},children:s=>r(U,{get children(){return[r(x,{get when(){return $n(s)},keyed:!0,children:c=>r(vn,{item:c,onClose:()=>n.close()})}),r(x,{get when(){return yn(s)},keyed:!0,children:c=>r(mn,{submenu:c,onClose:()=>n.close()})})]}})})),o})()}));return n};j(["click"]);const wn=e=>e.identifier!=null?`${e.kind}:${e.pubkey}:${e.identifier}`:`${e.kind}:${e.pubkey}`,bn=({pubkey:e,identifier:t,reason:n,kind:o})=>{const s=[];return typeof t=="string"?s.push(["e",t]):s.push(["a",wn(t)]),s.push(["k",o.toString()]),{kind:st,pubkey:e,created_at:ce(),tags:s,content:n??""}},kn=e=>{const t=M(e),{mutation:n,wrapMutate:o}=ae(()=>({mutationKey:["useDeleteMutation",t().id]})),s=o(bn);return{mutation:n,deleteEvent:s}},pn=({pubkey:e,eventId:t,kind:n,reactionTypes:o,notifyPubkey:s})=>{const c=[["e",t,""],["p",s],["k",n.toString()]];return o.type==="CustomEmoji"&&c.push(["emoji",o.shortcode,o.url]),{kind:lt,pubkey:e,created_at:ce(),tags:c,content:o.content}},_n=/\p{Emoji_Presentation}/u,Ne=e=>["useReactions",e],ue=e=>{const{shouldMuteEvent:t}=D(),n=Y(),o=M(()=>Ne(e())),s=V(()=>({queryKey:o(),queryFn:Se({taskProvider:([,d])=>{if(d==null)return null;const{eventId:g}=d;return new le({type:"Reactions",mentionedEventId:g})},queryClient:n}),staleTime:60*1e3,gcTime:14400*1e3,refetchInterval:60*1e3})),c=()=>(s.data??[]).filter(g=>!t(g));return{reactions:c,reactionsGrouped:()=>{const d=new Map;return c().forEach(g=>{const f=W(g).isCustomEmoji()?`${g.content}${W(g).getUrl()??""}`:g.content,v=d.get(f)??[];v.push(g),d.set(f,v)}),d},isReactedBy:d=>c().findIndex(g=>g.pubkey===d)!==-1,isReactedByWithEmoji:d=>c().findIndex(g=>g.pubkey===d&&_n.test(g.content))!==-1,query:s}},Ve=e=>{const t=Y(),n=M(e),{mutation:o,wrapMutate:s}=ae(()=>({mutationKey:["useReactionMutation",n().eventId],onSuccess:()=>{const l=Ne({eventId:n().eventId});t.invalidateQueries({queryKey:l}).catch(i=>console.error("failed to invalidate reactions",i))}})),c=s(pn);return{mutation:o,publishReaction:c}},xn=({pubkey:e,eventId:t,kind:n,notifyPubkey:o})=>{const s=[["e",t,""],["p",o]];return n!==1&&s.push(["k",n.toString()]),{kind:n===1?Te:it,pubkey:e,created_at:ce(),tags:s,content:""}},Qe=e=>["useReposts",e],Ze=e=>{const{shouldMuteEvent:t}=D(),n=Y(),o=M(e),s=M(()=>Qe(o())),c=V(()=>({queryKey:s(),queryFn:Se({taskProvider:([,u])=>{if(u==null)return null;const{eventId:d}=u;return new le({type:"Reposts",mentionedEventId:d})},queryClient:n}),staleTime:60*1e3,gcTime:14400*1e3,refetchInterval:60*1e3})),l=()=>(c.data??[]).filter(d=>!t(d));return{reposts:l,isRepostedBy:u=>l().findIndex(d=>d.pubkey===u)!==-1,query:c}},En=e=>{const t=Y(),n=M(e),{mutation:o,wrapMutate:s}=ae(()=>({mutationKey:["useRepostMutation",n().eventId],onSuccess:()=>{const l=Qe({eventId:n().eventId});t.invalidateQueries({queryKey:l}).catch(i=>console.error("failed to invalidate repost",i))}})),c=s(xn);return{mutation:o,publishRepost:c}},we=["k","M","G","T","P"],Rn=(e,t)=>{const n=t?.precision,s=10**((t?.minDigits??4)-1);if(e<s)return{value:e,prefix:null};const c=10**(Math.floor(Math.log10(e)/3)*3),l=e/c;let i=Math.round(l*10**n)/10**n,u=Math.max(Math.floor(Math.log10(e)/3)-1,0);return i>=1e3&&(i/=1e3,u+=1),u>=we.length?{value:e,prefix:null}:{value:i,prefix:we[u]}},Ge=(e,t)=>{const{value:n,prefix:o}=Rn(e,{precision:2,minDigits:t?.minDigits??5});if(o==null)return`${e}`;const s=t?.digits??3,c=Math.floor(Math.log10(n))+1,l=Math.max(s-c,0);return`${Math.round(n*10**l)/10**l}${o}`},Ye=h('<div class="text-sm text-fg-tertiary">'),be=h('<div class="flex shrink-0 items-center gap-1"><button class=size-4>'),Cn=h('<div class="flex shrink-0 items-center gap-1"><button><span class="flex size-4">'),Tn=h('<div class="h-4 max-w-8 min-w-4">'),Mn=h('<div class="scrollbar flex gap-2 overflow-x-auto py-1">'),Pn=h('<span class="ml-1 text-sm">'),Sn=h('<button class="webkit-touch-callout-none flex h-6 touch-pan-x items-center rounded-sm border border-border px-1 select-none"type=button><span class="flex h-5 max-w-[128px] min-w-5 items-center justify-center">'),In=h("<span class=text-red-500>"),Dn=h('<div class="actions flex w-64 max-w-full items-center justify-between pt-1"><button class="shrink-0 text-fg-tertiary hover:text-fg-tertiary/70"><span class="flex size-4"></span></button><button type=button><span class="flex size-4 text-fg-tertiary hover:text-r-zap"></span></button><button type=button class="size-4 shrink-0 text-fg-tertiary hover:text-fg-tertiary/70">'),jn=oe(()=>se(()=>import("./EventDebugModal-C8kfjc08.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Je=oe(()=>se(()=>import("./UserList-lyKZQw34.js"),__vite__mapDeps([7,1,2,4,5,8,3,9]))),Ln=oe(()=>se(()=>import("./ZapRequestModal-bvy-c3T9.js"),__vite__mapDeps([10,1,2,3,4,5,6,11,12,13,9,8]))),An=e=>{if(e.native!=null)return{type:"Emoji",content:e.native};if(e.src!=null)return{type:"CustomEmoji",content:`:${e.id}:`,shortcode:e.id,url:e.src};throw new Error("unknown emoji")},Hn=e=>{const{config:t}=D(),n=X(),[o,s]=C(!1),{reactions:c,isReactedByWithEmoji:l,isReactedBy:i}=ue(()=>({eventId:e.event.id})),u=M(()=>{const $=n();return $!=null&&i($)||o()}),d=M(()=>{const $=n();return $!=null&&l($)}),{mutation:g,publishReaction:f}=Ve(()=>({eventId:e.event.id})),v=$=>{u()||g.isPending||N([n(),e.event.id])(([p,w])=>{f({pubkey:p,reactionTypes:$??{type:"LikeDislike",content:"+"},eventId:w,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{s(!0)}).catch(S=>{window.alert(ee(S))})})},b=$=>{$.stopPropagation(),v()},m=$=>{v(An($))},k=bt(()=>({onEmojiSelect:m}));return[(()=>{const $=be(),p=$.firstChild;return p.$$click=b,a(p,r(y,{get when(){return L(()=>!!u())()&&!d()},get fallback(){return r(kt,{})},get children(){return r(qe,{})}})),a($,r(y,{get when(){return L(()=>!t().hideCount&&!t().showEmojiReaction)()&&c().length>0},get children(){const w=Ye();return a(w,()=>Ge(c().length,{minDigits:4})),w}}),null),P(w=>{const S={"text-fg-tertiary":!u()||d(),"hover:text-r-reaction":!u()||d(),"text-r-reaction":u()&&!d()||g.isPending},T=g.isPending;return w._v$=K($,S,w._v$),T!==w._v$2&&(p.disabled=w._v$2=T),w},{_v$:void 0,_v$2:void 0}),$})(),r(y,{get when(){return t().useEmojiReaction},get children(){const $=be(),p=$.firstChild;p.$$click=()=>k.open();const w=k.targetRef;return typeof w=="function"?H(w,p):k.targetRef=p,a(p,r(pt,{})),a($,()=>k.popup(),null),P(S=>K($,{"text-fg-tertiary":!u()||!d(),"hover:text-r-reaction":!u()||!d(),"text-r-reaction":u()&&d()||g.isPending},S)),$}})]},Bn=e=>{const{config:t}=D(),n=X(),[o,s]=C(!1),{reposts:c,isRepostedBy:l}=Ze(()=>({eventId:e.event.id})),i=M(()=>{const f=n();return f!=null&&l(f)||o()}),{mutation:u,publishRepost:d}=En(()=>({eventId:e.event.id})),g=f=>{if(f.stopPropagation(),i()||u.isPending)return;const v=n(),{id:b}=e.event;v!=null&&b!=null&&d({pubkey:v,eventId:b,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{s(!0)}).catch(m=>{window.alert(ee(m))})};return(()=>{const f=Cn(),v=f.firstChild,b=v.firstChild;return v.$$click=g,a(b,r(Ae,{})),a(f,r(y,{get when(){return L(()=>!t().hideCount)()&&c().length>0},get children(){const m=Ye();return a(m,()=>Ge(c().length,{minDigits:4})),m}}),null),P(m=>{const k={"text-fg-tertiary":!i(),"hover:text-r-repost":!i(),"text-r-repost":i()||u.isPending},$=u.isPending;return m._v$3=K(f,k,m._v$3),$!==m._v$4&&(v.disabled=m._v$4=$),m},{_v$3:void 0,_v$4:void 0}),f})()},Un=e=>{const{reactions:t}=ue(()=>({eventId:e.event.id}));return r(Je,{get data(){return t()},pubkeyExtractor:n=>n.pubkey,renderInfo:n=>(()=>{const o=Tn();return a(o,r(Fe,{get reactionTypes(){return W(n).toReactionTypes()}})),o})(),get onClose(){return e.onClose}})},qn=e=>{const{reposts:t}=Ze(()=>({eventId:e.event.id}));return r(Je,{get data(){return t()},pubkeyExtractor:n=>n.pubkey,get onClose(){return e.onClose}})},On=e=>{const{config:t}=D(),n=X(),[o,s]=C(!1),{reactions:c,reactionsGrouped:l,isReactedBy:i}=ue(()=>({eventId:e.event.id})),{mutation:u,publishReaction:d}=Ve(()=>({eventId:e.event.id})),g=()=>{const v=n();return v==null?o():o()||i(v)},f=v=>{g()||u.isPending||N([n(),e.event.id])(([b,m])=>{d({pubkey:b,reactionTypes:v??{type:"LikeDislike",content:"+"},eventId:m,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{s(!0)}).catch(k=>{window.alert(ee(k))})})};return r(y,{get when(){return L(()=>!!t().showEmojiReaction)()&&c().length>0},get children(){const v=Mn();return a(v,r(G,{get each(){return[...l().entries()]},children:([,b])=>{const m=b.findIndex(w=>w.pubkey===n())>=0,k=W(b[0]).toReactionTypes(),$=ze(k),p=We(()=>N([$])(([w])=>({emoji:w,onClick:()=>{g()||u.isPending||f(k)}})));return(()=>{const w=Sn(),S=w.firstChild;return H(T=>p.emojiRef(T),w),a(S,r(Fe,{reactionTypes:k})),a(w,r(y,{get when(){return!t().hideCount},get children(){const T=Pn();return a(T,()=>b.length),T}}),null),a(w,()=>p.popup(),null),P(T=>K(w,{"text-fg-tertiary":!m,"hover:bg-r-reaction/10":!m,"hover:border-r-reaction/40":!m,"bg-r-reaction/10":m,"border-r-reaction/40":m,"text-r-reaction":m},T)),w})()}})),v}})},zn=e=>{const t=I(),{addMutedThread:n}=D(),o=X(),[s,c]=C(null),l=()=>c(null),{mutation:i,deleteEvent:u}=kn(()=>({id:e.event.id})),d=()=>{ct(()=>{if(n(e.event.id),e.event.kind===J){const f=new at(e.event).rootEvent()?.id;f!=null&&n(f)}})},g=Ke(()=>({menu:[{content:t.t("post.copyEventId"),onSelect:()=>{navigator.clipboard.writeText(Ee({id:e.event.id})).catch(f=>window.alert(f))}},{content:t.t("post.showJSON"),onSelect:()=>{c("EventDebugModal")}},{content:t.t("post.muteThread"),onSelect:()=>d()},{content:t.t("post.showReposts"),onSelect:()=>{c("Reposts")}},{content:t.t("post.showReactions"),onSelect:()=>{c("Reactions")}},{when:()=>e.event.pubkey===o(),content:(()=>{const f=In();return a(f,()=>t.t("post.deletePost")),f})(),onSelect:()=>{const f=o();f!=null&&(i.isPending||window.confirm(t.t("post.confirmDelete"))&&u({pubkey:f,identifier:e.event.id,kind:e.event.kind}).then(v=>{v.failed.length===0?window.alert(t.t("post.deletedSuccessfully")):v.succeeded.length>0?window.alert(t.t("post.failedToDeletePartially",{count:v.failed.length})):window.alert(t.t("post.failedToDelete"))}).catch(v=>{window.alert(ee(v))}))}}]}));return[r(On,{get event(){return e.event}}),(()=>{const f=Dn(),v=f.firstChild,b=v.firstChild,m=v.nextSibling,k=m.firstChild,$=m.nextSibling;v.$$click=w=>{w.stopPropagation(),e.onClickReply()},a(b,r(Yt,{})),a(f,r(Bn,{get event(){return e.event}}),m),a(f,r(Hn,{get event(){return e.event}}),m),m.$$click=()=>c("ZapRequest"),a(k,r(Zt,{})),$.$$click=()=>g.open();const p=g.targetRef;return typeof p=="function"?H(p,$):g.targetRef=$,a($,r(Xt,{})),a(f,()=>g.popup(),null),f})(),r(U,{get children(){return[r(x,{get when(){return s()==="EventDebugModal"},get children(){return r(jn,{get event(){return e.event},onClose:l})}}),r(x,{get when(){return s()==="Reactions"},get children(){return r(Un,{get event(){return e.event},onClose:l})}}),r(x,{get when(){return s()==="Reposts"},get children(){return r(qn,{get event(){return e.event},onClose:l})}}),r(x,{get when(){return s()==="ZapRequest"},get children(){return r(Ln,{get zapTo(){return{event:e.event}},onClose:l})}})]}})]};j(["click"]);const Fn=h("<div>"),Wn=h('<button class="text-xs text-fg-secondary hover:text-fg-secondary/70">'),Kn=h("<span>: "),Nn=h('<button class="mt-2 flex w-full flex-col items-center rounded-sm border border-border p-2 text-center text-xs text-fg-secondary"><span class="inline-block size-4"></span><span>'),Vn=e=>{const t=I(),[n,o]=C(!1);return r(y,{get when(){return!e.contentWarning.contentWarning||n()},get fallback(){return(()=>{const s=Nn(),c=s.firstChild,l=c.nextSibling;return s.$$click=()=>o(!0),a(c,r(_t,{})),a(l,()=>t.t("post.contentWarning.show")),a(s,r(y,{get when(){return e.contentWarning.reason!=null},get children(){const i=Kn(),u=i.firstChild;return a(i,()=>t.t("post.contentWarning.reason"),u),a(i,()=>e.contentWarning.reason,null),i}}),null),s})()},get children(){return[(()=>{const s=Fn();return a(s,()=>e.children),s})(),r(y,{get when(){return e.contentWarning.contentWarning},get children(){const s=Wn();return s.$$click=()=>o(!1),a(s,()=>t.t("post.contentWarning.hide")),s}})]}})};j(["click"]);const Xe=e=>{const{profile:t}=Ie(()=>({pubkey:e.pubkey}));return r(y,{get when(){return(t()?.name?.length??0)>0},get fallback(){return`@${De(e.pubkey)}`},get children(){return["@",L(()=>t()?.name??e.pubkey)]}})},Qn=h("<div>"),A=e=>{let t;const[n,o]=C(!1);return Z(()=>{const s=new IntersectionObserver(c=>{c.forEach(l=>{l.isIntersecting&&(o(!0),s.disconnect())})},{threshold:e.threshold??0});t!=null&&s.observe(t),Q(()=>{s.disconnect()})}),r(y,{get when(){return n()},get fallback(){return(()=>{const s=Qn(),c=t;return typeof c=="function"?H(c,s):t=s,a(s,()=>e.fallback),s})()},keyed:!0,children:s=>e.children()})},Zn=h('<button class="rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm">'),et=e=>{const[t,n]=C(e.initialHidden),[o,s]=C(!1);return r(y,{get when(){return!t()},get fallback(){return(()=>{const c=Zn();return c.$$click=()=>n(!1),a(c,()=>e.showButtonText),c})()},get children(){return r(A,{get fallback(){return e.placeholder},children:()=>r(y,{get when(){return!o()},get fallback(){return e.fallback},get children(){return r(ut,{get component(){return e.children},error:()=>s(!0)})}})})}})};j(["click"]);const Gn=h("<div class=max-w-full>"),Yn=h("<audio controls><a>"),Jn=e=>{const t=I();return r(et,{get initialHidden(){return e.initialHidden},get placeholder(){return(()=>{const n=Gn();return a(n,r(R,{class:"text-link underline",get href(){return e.url}})),n})()},get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},get showButtonText(){return t.t("post.showAudio")},children:n=>(()=>{const o=Yn(),s=o.firstChild;return Me(o,"error",n.error),a(s,()=>t.t("post.download")),P(c=>{const l=e.url,i=e.url;return l!==c._v$&&E(o,"src",c._v$=l),i!==c._v$2&&E(s,"href",c._v$2=i),c},{_v$:void 0,_v$2:void 0}),o})()})},Xn=h('<div class="aspect-video max-w-full">'),er=h('<img class="max-h-64 max-w-full rounded-sm object-contain shadow-sm hover:shadow-md">'),tr=e=>{const t=I();return r(et,{get initialHidden(){return e.initialHidden},get placeholder(){return(()=>{const n=Xn();return a(n,r(R,{class:"text-link underline",get href(){return e.url}})),n})()},get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},get showButtonText(){return t.t("post.showImage")},children:n=>r(R,{class:"my-2 block",get href(){return e.url},get children(){const o=er();return Me(o,"error",n.error),P(s=>{const c=je(e.url),l=e.url;return c!==s._v$&&E(o,"src",s._v$=c),l!==s._v$2&&E(o,"alt",s._v$2=l),s},{_v$:void 0,_v$2:void 0}),o}})})},nr=h('<div class="my-1 rounded-sm border p-1">'),rr=e=>r(y,{get when(){return e.mentionedEvent.marker!=null&&e.mentionedEvent.marker.length>0},get fallback(){return r(O,{get eventId(){return e.mentionedEvent.eventId}})},get children(){const t=nr();return a(t,r(A,{children:()=>r(z,{get eventId(){return e.mentionedEvent.eventId},embedding:!1,actions:!1,get ensureKinds(){return[J]}})})),t}}),or=h('<button class="inline text-link underline select-text">'),te=e=>{const{showProfile:t}=ie(),n=()=>{t(e.pubkey)};return(()=>{const o=or();return o.$$click=n,a(o,r(Xe,{get pubkey(){return e.pubkey}})),o})()};j(["click"]);const sr=["www3.nhk.or.jp"],lr=e=>{const t=new TextDecoder("US-ASCII").decode(e.slice(0,1024)),n=t.match(/<meta\s+charset="([-A-Za-z0-9_]+)"/i);if(n!=null)return n[1].toLowerCase();const o=t.match(/<meta\s+http-equiv="Content-Type"\s*content="text\/html;\s*charset=([-A-Za-z0-9_]+)"/i);return o!=null?o[1].toLowerCase():null},ir=new Set(["utf-8","shift_jis","shift-jis","euc-jp","iso-2022-jp"]),cr=e=>{try{const t=lr(e)??"utf-8";if(!ir.has(t))throw new Error(`Unsupported encodings: ${t}`);return new TextDecoder(t).decode(e)}catch(t){throw new Error("Failed to convert charset",{cause:t})}},ar=(e,t)=>{const n={};Array.from(e.head.querySelectorAll("meta")).forEach(i=>{const u=i.getAttribute("property")||i.getAttribute("name"),d=i.getAttribute("content");u!=null&&d!=null&&(n[u]=d)});const o=n["og:image"]||n["twitter:image"],s=n["og:title"]||n["twitter:title"],c=n["og:url"]||t,l=n["og:description"]||n["twitter:description"]||"";return!(o&&s&&c)||!(ge(o)&&ge(c))?null:{title:s,description:l,image:o,url:c}},ur=(e,t)=>{const n=new DOMParser().parseFromString(e,"text/html");return ar(n,t)},tt=e=>new URL(e).protocol==="https:",dr=e=>{const t=new URL(e);return sr.includes(t.hostname)},hr=e=>{if(dr(e))return e;const t=new URL("https://corsproxy.io/");return t.search=new URLSearchParams({url:e}).toString(),t.toString()},gr=async e=>{try{if(!tt(e))return null;const t=hr(e),o=await(await fetch(t,{mode:"cors",headers:{Accept:"text/html"},credentials:"omit"})).arrayBuffer(),s=cr(new Uint8Array(o));return ur(s,e)}catch(t){return console.error(`failed to fetch ogp for ${e}`,t),null}},fr=e=>{const t=()=>["useOgp",e().url],n=V(()=>({queryKey:t(),queryFn:({queryKey:[,s]})=>gr(s),staleTime:144e5,gcTime:144e5,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{query:n,ogp:()=>n.data}},vr=h('<blockquote class=twitter-tweet><a class="text-link underline"target=_blank rel="noreferrer noopener">'),mr=h('<div class="my-2 rounded-lg border border-border transition-colors hover:bg-bg-tertiary"><div class="overflow-hidden rounded-t-lg"><img class="max-h-64 w-full object-cover shadow-sm"></div><div class="mb-1 overflow-hidden p-1"><div class="text-xs text-fg-secondary"></div><div class=text-sm></div><div class="max-h-16 truncate text-xs break-all whitespace-normal text-fg-secondary">'),$r=h('<div><button class="flex flex-col items-center rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm">'),yr=h('<div class="my-2 aspect-video w-full"><iframe loading=lazy title=YouTube class="my-2 size-full"allowfullscreen>'),wr=e=>{try{const t=new URL(e);return t.host="twitter.com",t.href}catch{return e}},br=e=>{const t=new URL("https://www.youtube-nocookie.com/embed/");return t.pathname+=e,t.searchParams.set("origin",window.location.origin),t.href},kr=()=>window.twttr!=null,pr=e=>{let t;const{getColorTheme:n}=D();Re(()=>{Le(e.url)&&window.twttr?.widgets?.load(t)});const o=()=>n().brightness==="dark"?"dark":"light";return[r(R,{class:"text-link underline",get href(){return e.url}}),(()=>{const s=vr(),c=s.firstChild,l=t;return typeof l=="function"?H(l,s):t=s,P(i=>{const u=o(),d=wr(e.url);return u!==i._v$&&E(s,"data-theme",i._v$=u),d!==i._v$2&&E(c,"href",i._v$2=d),i},{_v$:void 0,_v$2:void 0}),s})()]},_r=e=>{const{ogp:t}=fr(()=>({url:e.url}));return r(y,{get when(){return t()},get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},keyed:!0,children:n=>[r(R,{class:"text-link underline",get href(){return e.url}}),r(R,{get href(){return e.url},get children(){const o=mr(),s=o.firstChild,c=s.firstChild,l=s.nextSibling,i=l.firstChild,u=i.nextSibling,d=u.nextSibling;return a(i,()=>new URL(n.url).host),a(u,()=>n.title),a(d,()=>n.description),P(g=>{const f=n.title,v=n.image;return f!==g._v$3&&E(c,"alt",g._v$3=f),v!==g._v$4&&E(c,"src",g._v$4=v),g},{_v$3:void 0,_v$4:void 0}),o}})]})},ne=e=>{const t=I(),[n,o]=C(e.initialHidden);return r(y,{get when(){return!n()},get fallback(){return[r(R,{class:"text-link underline",get href(){return e.url}}),(()=>{const s=$r(),c=s.firstChild;return c.$$click=()=>o(!1),a(c,()=>t.t("post.showPreview")),s})()]},get children(){return e.children}})},xr=e=>{const{config:t}=D();return r(U,{get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},get children(){return[r(x,{get when(){return L(()=>!!t().embedding.twitter)()&&Le(e.url)},get children(){return r(y,{get when(){return kr()},get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},get children(){return r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{children:()=>r(pr,{get url(){return e.url}})})}})}})}}),r(x,{get when(){return L(()=>!!t().embedding.youtube)()&&Ct(e.url)},keyed:!0,children:({videoId:n})=>r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{get fallback(){return r(R,{class:"text-link underline",get href(){return e.url}})},children:()=>[r(R,{class:"text-link underline",get href(){return e.url}}),(()=>{const o=yr(),s=o.firstChild;return P(()=>E(s,"src",br(n))),o})()]})}})}),r(x,{get when(){return L(()=>!!t().embedding.ogp)()&&tt(e.url)},get children(){return r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{children:()=>r(_r,{get url(){return e.url}})})}})}})]}})};j(["click"]);const Er=h('<button class="rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm">'),Rr=h('<div class="aspect-video max-w-full">'),Cr=h('<video class="max-h-64 max-w-full rounded-sm object-contain shadow-sm"controls>'),Tr=e=>{let t;const n=I(),[o,s]=C(e.initialHidden),[c,l]=C(!1);return r(y,{get when(){return!o()},get fallback(){return(()=>{const i=Er();return i.$$click=()=>s(!1),a(i,()=>n.t("post.showVideo")),i})()},get children(){return r(A,{get fallback(){return Rr()},children:()=>r(y,{get when(){return!c()},get fallback(){return r(R,{class:"text-link underline",get href(){return e.url},get children(){return e.url}})},get children(){const i=Cr();i.addEventListener("error",()=>l(!0));const u=t;return typeof u=="function"?H(u,i):t=i,a(i,r(R,{class:"text-link underline",get href(){return e.url},get children(){return n.t("post.download")}})),P(()=>E(i,"src",e.url)),i}})})}})};j(["click"]);const re=h("<span>"),ke=h('<button class="text-link underline select-text">'),pe=h('<div class="my-1 rounded-sm border border-border p-1">'),Mr=h('<span class="text-link underline">'),Pr=h('<img class="inline-block h-8 max-w-32">'),Sr=e=>{const{config:t,saveColumn:n}=D(),o=xt(),s=l=>{n(ht({query:l})),o({command:"moveToLastColumn"}).catch(i=>console.error(i))},c=l=>{n(dt({name:l,relayUrls:[l]})),o({command:"moveToLastColumn"}).catch(i=>console.error(i))};return r(G,{get each(){return e.parsed},children:l=>{if(l.type==="PlainText")return(()=>{const i=re();return a(i,()=>l.content),i})();if(l.type==="URL"){const i=()=>!t().showMedia||!e.embedding||(e.initialHidden??!1);return Tt(l.content)?r(tr,{get url(){return l.content},get initialHidden(){return i()}}):Mt(l.content)?r(Tr,{get url(){return l.content},get initialHidden(){return i()}}):Pt(l.content)?r(Jn,{get url(){return l.content},get initialHidden(){return i()}}):St(l.content)?(()=>{const u=ke();return u.$$click=()=>c(l.content),a(u,()=>l.content),u})():r(xr,{get url(){return l.content},get initialHidden(){return i()}})}if(l.type==="TagReferenceResolved"){if(l.reference==null)return(()=>{const i=re();return a(i,()=>l.content),i})();if(l.reference.type==="MentionedUser")return r(te,{get pubkey(){return l.reference.pubkey}});if(l.reference.type==="MentionedEvent")return e.embedding?r(rr,{get mentionedEvent(){return l.reference}}):r(O,{get eventId(){return l.reference.eventId}})}if(l.type==="Bech32Entity")return l.data.type==="note"&&e.embedding?(()=>{const i=pe();return a(i,r(z,{get eventId(){return l.data.data},actions:!1,embedding:!1,get ensureKinds(){return[J]}})),i})():l.data.type==="nevent"&&e.embedding?(()=>{const i=pe();return a(i,r(z,{get eventId(){return l.data.data.id},actions:!1,embedding:!1})),i})():l.data.type==="npub"?r(te,{get pubkey(){return l.data.data}}):l.data.type==="nprofile"?r(te,{get pubkey(){return l.data.data.pubkey}}):(()=>{const i=Mr();return a(i,()=>l.content),i})();if(l.type==="HashTag")return(()=>{const i=ke();return i.$$click=()=>s(l.content),a(i,()=>l.content),i})();if(l.type==="CustomEmojiResolved"){const{url:i,shortcode:u,content:d}=l;if(i==null)return(()=>{const v=re();return a(v,()=>l.content),v})();const{emojiRef:g,popup:f}=We(()=>({emoji:{type:"CustomEmoji",url:i,shortcode:u}}));return[L(f),(()=>{const v=Pr();return H(g,v),E(v,"src",i),E(v,"alt",d),E(v,"title",u),v})()]}return console.error("Not all ParsedTextNoteNodes are covered",l),null}})};j(["click"]);const _e=2,Ir=200,Dr=()=>{let e;const[t,n]=C(!1),o=c=>{e=c},s=Et(()=>{e!=null&&n(e.scrollHeight>e.clientHeight+_e||e.scrollHeight>document.documentElement.clientHeight+_e)},Ir);return Z(()=>{if(e!=null){s();const c=new IntersectionObserver(i=>{i.forEach(u=>{u.isIntersecting&&s()})},{threshold:[0,.25,.5,.75,1]});c.observe(e);const l=()=>s();window.addEventListener("resize",l),Q(()=>{c.disconnect(),window.removeEventListener("resize",l)})}}),{overflow:t,elementRef:o}},jr=h('<div class="author-name truncate pr-1 font-bold hover:underline">'),Lr=h('<button class="mt-2 w-full rounded-sm border border-border p-2 text-center text-xs text-fg-secondary shadow-sm hover:bg-bg-tertiary hover:shadow-sm">'),Ar=h('<div class="post flex flex-col"><div class="flex w-full gap-1"><button type=button class="author-icon size-10 shrink-0 overflow-hidden rounded-sm"></button><div class="min-w-0 flex-auto"><div class="flex justify-between gap-1 text-xs"><button type=button class="author flex min-w-0 truncate select-text hover:text-link"><span class="author flex min-w-0 truncate hover:text-link"><div class="author-username truncate text-fg-secondary"></div></span></button><div class="created-at shrink-0"><button type=button class="select-text hover:underline"></button></div></div><div class=overflow-hidden></div><div class=actions>'),Hr=h('<img alt=icon referrerpolicy=no-referrer class="size-full object-cover">'),Br=e=>{const t=I(),{overflow:n,elementRef:o}=Dr(),s=Ue(),[c,l]=C(!1),i=()=>s(e.createdAt),u=()=>e.createdAt.toLocaleString(),{profile:d}=Ie(()=>({pubkey:e.authorPubkey}));return(()=>{const g=Ar(),f=g.firstChild,v=f.firstChild,b=v.nextSibling,m=b.firstChild,k=m.firstChild,$=k.firstChild,p=$.firstChild,w=k.nextSibling,S=w.firstChild,T=m.nextSibling,de=T.nextSibling;return v.$$click=_=>{_.preventDefault(),e.onShowProfile?.()},a(v,r(y,{get when(){return d()?.picture},keyed:!0,children:_=>r(A,{children:()=>(()=>{const B=Hr();return P(()=>E(B,"src",je(_,"icon"))),B})()})})),k.$$click=_=>{_.preventDefault(),e?.onShowProfile?.()},a($,r(y,{get when(){return(d()?.display_name?.length??0)>0},get children(){const _=jr();return a(_,()=>d()?.display_name),_}}),p),a(p,r(y,{get when(){return d()?.name!=null},get fallback(){return`@${De(e.authorPubkey)}`},get children(){return["@",L(()=>d()?.name)]}})),S.$$click=_=>{_.preventDefault(),e.onShowEvent?.()},a(S,i),H(o,T),a(T,()=>e.content),a(b,r(y,{get when(){return n()},get children(){const _=Lr();return _.$$click=B=>{B.stopPropagation(),l(F=>!F)},a(_,r(y,{get when(){return!c()},get fallback(){return t.t("post.hideOverflow")},get children(){return t.t("post.showOverflow")}})),_}}),de),a(de,()=>e.actions),a(g,r(y,{get when(){return e.footer},get children(){return e.footer}}),null),P(_=>{const B=u(),F=!c(),he=!!c();return B!==_._v$&&E(S,"title",_._v$=B),F!==_._v$2&&T.classList.toggle("max-h-screen",_._v$2=F),he!==_._v$3&&T.classList.toggle("max-h-none",_._v$3=he),_},{_v$:void 0,_v$2:void 0,_v$3:void 0}),g})()};j(["click"]);const Ur=gt(),qr=()=>vt(Ur),to=()=>{const[e,t]=ft({});return{timelineState:e,setTimeline:n=>t("content",n),clearTimeline:()=>t("content",void 0)}},Or=h("<div class=nostr-textnote>"),zr=h("<div class=text-xs>"),Fr=h('<div class="content wrap-break-word whitespace-pre-wrap">'),Wr=h("<div class=textnote-content>"),Kr=h('<div class="mt-1 rounded-sm border border-border p-1">'),Nr=h("<div class=h-12>"),Vr=h('<button class="pr-1 text-link select-text hover:underline">'),Qr=h("<div class=h-5>"),Zr=e=>{let t;const n=I(),{showProfile:o}=ie(),s=qr(),[c,l]=C(!1),i=()=>l(!1),u=()=>{l(b=>!b),c()&&t!=null&&t.focus()},d=M(()=>mt(e.event)),g=()=>e.embedding??!0,f=()=>e.actions??!0,v=()=>{if(g()){const b=d().replyingToEvent();if(b!=null&&!d().containsEventMention(b.id))return b.id;const m=d().rootEvent();if(b==null&&m!=null&&!d().containsEventMention(m.id))return m.id}};return(()=>{const b=Or();return a(b,r(Br,{get authorPubkey(){return d().pubkey},get createdAt(){return d().createdAtAsDate()},get content(){return(()=>{const m=Wr();return a(m,r(y,{get when(){return v()},keyed:!0,children:k=>(()=>{const $=Kr();return a($,r(A,{get fallback(){return Nr()},children:()=>r(z,{eventId:k,actions:!1,embedding:!1})})),$})()}),null),a(m,r(y,{get when(){return d().taggedPubkeys().length>0},get children(){const k=zr();return a(k,()=>n.t("post.replyToPre"),null),a(k,r(G,{get each(){return d().taggedPubkeys()},children:$=>(()=>{const p=Vr();return p.$$click=w=>{w.stopPropagation(),o($)},a(p,r(Xe,{pubkey:$})),p})()}),null),a(k,()=>n.t("post.replyToPost"),null),k}}),null),a(m,r(Vn,{get contentWarning(){return d().contentWarning()},get children(){const k=Fr();return a(k,r(Sr,{get parsed(){return d().parsed()},get embedding(){return g()},get initialHidden(){return d().contentWarning().contentWarning}})),k}}),null),m})()},get actions(){return r(y,{get when(){return f()},get children(){return r(A,{get fallback(){return Qr()},children:()=>r(zn,{get event(){return e.event},onClickReply:u})})}})},get footer(){return r(y,{get when(){return c()},get children(){return r(Rt,{textAreaRef:m=>{t=m},mode:"reply",get replyTo(){return e.event},onClose:i,onPost:i})}})},onShowProfile:()=>{o(d().pubkey)},onShowEvent:()=>{s?.setTimeline({type:"Replies",event:e.event})}})),b})()};j(["click"]);const xe=h("<div><span>"),Gr=e=>{const t=I(),n=()=>e.ensureKinds==null||e.ensureKinds.length===0||e.ensureKinds.includes(e.event.kind);return r(U,{get fallback(){return(()=>{const o=xe(),s=o.firstChild;return a(s,()=>t.t("post.unsupportedKind",{kind:e.event.kind})),a(o,r(O,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),o})()},get children(){return[r(x,{get when(){return!n()},keyed:!0,get children(){const o=xe(),s=o.firstChild;return a(s,()=>t.t("post.unexpectedKind",{kind:e.event.kind})),a(o,r(O,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),o}}),r(x,{get when(){return e.event.kind===J},get children(){return r(Zr,{get event(){return e.event},get embedding(){return e.actions},get actions(){return e.actions}})}}),r(x,{get when(){return e.event.kind===Te},get children(){return r(Vt,{get event(){return e.event}})}})]}})};export{Ae as A,Zt as B,dn as C,z as E,qe as H,A as L,Fe as R,Ur as T,Ke as a,Ue as b,Lt as c,We as d,Gr as e,Zr as f,Vt as g,Xt as h,Sr as i,Ge as j,ze as r,to as u};
//# sourceMappingURL=EventDisplay-CICIyOWE.js.map
