const __vite__fileDeps=["assets/ZapReceipt-JCZxTFvK.js","assets/index-C2MVzeUK.js","assets/index-2iajXTZs.css","assets/useFollowings-B8fMAblv.js","assets/SideBar-CGVEOLid.js","assets/resolveAsset-C1Gpud8G.js","assets/LazyLoad-DHTx37Q9.js","assets/SafeLink-BQyLCjm4.js","assets/url-BOMIwtgZ.js","assets/lud16ToLnurlPayUrl-Dc5mmDNJ.js","assets/_baseClone-dHxKbu_a.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{s as j,t as d,d as A,c as R,i as u,a as n,h as I,M as $,S as K,j as x,k as Y,l as se,u as E,b as N,m as ie,n as ue,F as O,f as B,T as ae,p as me,q as ee,r as T,v as Q,w as de,x as ne,y as ge,z as he,A as M,o as G,B as te,C as ve,D as fe,_ as ye,R as xe,E as ke,Z as $e,G as we,H as Ce}from"./index-C2MVzeUK.js";import{u as J,a as re,b as oe,p as be,r as _e,t as Ie,B as Te,c as Ee,H as Se,d as Le,e as Fe,U as pe,f as Re,g as Me,h as Pe,i as De,G as Ue,M as ze,j as Be,S as qe,k as Ne,l as Ae}from"./SideBar-CGVEOLid.js";import{A as He}from"./arrow-left-C7D2yJX-.js";import{u as L,T as H,a as Oe,b as je,C as Ke,c as q,E as Qe,d as Ge,e as P,L as D,f as Ve,g as Ze,h as We,i as Je,j as Xe,R as Ye}from"./useFollowings-B8fMAblv.js";import{t as en}from"./url-BOMIwtgZ.js";import"./resolveAsset-C1Gpud8G.js";import"./LazyLoad-DHTx37Q9.js";import"./SafeLink-BQyLCjm4.js";const nn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),le=(e={})=>(()=>{const t=nn();return j(t,e,!0),t})(),tn=d('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"><span class=truncate></span></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),rn=d('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),U=e=>{const[t,o]=R(!1),s=()=>o(r=>!r);return(()=>{const r=tn(),l=r.firstChild,c=l.firstChild,i=c.firstChild,a=c.nextSibling,h=a.firstChild;return u(c,n(I,{get when(){return e.icon},keyed:!0,children:v=>(()=>{const m=rn();return u(m,v),m})()}),i),u(i,()=>e.name),a.$$click=()=>s(),u(h,n(le,{})),u(r,n(I,{get when(){return t()},get children(){return e.settings()}}),null),r})()};A(["click"]);const on=e=>{const t=[e.id],o=e.rootEvent()?.id;o!=null&&t.push(o);const s=e.replyingToEvent()?.id;return s!=null&&t.push(s),Y(t)},ln=e=>{const{config:t}=x(),o=()=>se(e.event),{events:s}=L(()=>({relayUrls:t().relayUrls,filters:[{kinds:[1],ids:on(o()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return n(H,{get events(){return[...s()].reverse()}})},cn=e=>n(K,{get children(){return n($,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:t=>n(ln,{get event(){return t.event}})})}}),sn=d('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),un=d('<div class="shrink-0 border-b border-border">'),an=d('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),mn=d('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),dn=d('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),F=e=>{let t;const o=Oe(),s=E(),r=()=>e.width??"medium";return J(()=>({commandType:"moveToColumn",handler:l=>{l.command==="moveToColumn"&&l.columnIndex===e.columnIndex&&t?.scrollIntoView({behavior:"smooth",inline:"center"})}})),J(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&t?.scrollIntoView({behavior:"smooth"})}})),n(je.Provider,{value:o,get children(){const l=sn(),c=t;return typeof c=="function"?ue(c,l):t=l,u(l,n(I,{get when(){return o.timelineState.content},keyed:!0,get fallback(){return[(()=>{const i=un();return u(i,()=>e.header),i})(),(()=>{const i=an();return u(i,()=>e.children),i})()]},children:i=>[(()=>{const a=mn(),h=a.firstChild,v=h.firstChild,m=v.nextSibling;return h.$$click=()=>o?.clearTimeline(),u(v,n(He,{})),u(m,()=>s.t("column.back")),a})(),(()=>{const a=dn();return u(a,n(cn,{timelineContent:i})),a})()]})),N(i=>ie(l,{"sm:w-[500px]":r()==="widest","sm:w-[360px]":r()==="wide","sm:w-[320px]":r()==="medium","sm:w-[280px]":r()==="narrow"},i)),l}})};A(["click"]);const gn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),hn=(e={})=>(()=>{const t=gn();return j(t,e,!0),t})(),vn=d('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),fn=(e={})=>(()=>{const t=vn();return j(t,e,!0),t})(),yn=d('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),xn=d('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),kn=d('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),$n=d('<button class="rounded-md border px-4 text-fg-secondary">'),wn=e=>(()=>{const t=yn(),o=t.firstChild,s=o.nextSibling;return u(o,()=>e.title),u(s,()=>e.children),t})(),p=e=>{const t=E(),{saveColumn:o,removeColumn:s,moveColumn:r}=x(),l=re(),c=a=>{o({...e.column,width:a})},i=a=>{r(e.column.id,a),l({command:"moveToColumn",columnIndex:a}).catch(h=>console.error(h))};return(()=>{const a=kn(),h=a.firstChild,v=h.firstChild,m=v.firstChild,g=v.nextSibling,w=g.firstChild,S=g.nextSibling,C=S.nextSibling,_=C.firstChild;return u(a,n(wn,{get title(){return t.t("column.config.columnWidth")},get children(){const f=xn();return u(f,n(O,{each:["widest","wide","medium","narrow"],children:b=>(()=>{const k=$n();return k.$$click=()=>c(b),u(k,()=>t.t(`column.config.${b}`)),N(y=>{const z=e.column.width===b,V=e.column.width===b,Z=e.column.width!==b,W=e.column.width!==b;return z!==y._v$5&&k.classList.toggle("border-fg-secondary",y._v$5=z),V!==y._v$6&&k.classList.toggle("font-bold",y._v$6=V),Z!==y._v$7&&k.classList.toggle("border-border",y._v$7=Z),W!==y._v$8&&k.classList.toggle("font-normal",y._v$8=W),y},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),k})()})),f}}),h),v.$$click=()=>i(e.columnIndex-1),u(m,n(hn,{})),g.$$click=()=>i(e.columnIndex+1),u(w,n(Ke,{})),C.$$click=()=>s(e.column.id),u(_,n(fn,{})),N(f=>{const b=t.t("column.config.moveLeft"),k=t.t("column.config.moveRight"),y=t.t("column.config.removeColumn"),z=t.t("column.config.removeColumn");return b!==f._v$&&B(v,"title",f._v$=b),k!==f._v$2&&B(g,"title",f._v$2=k),y!==f._v$3&&B(C,"title",f._v$3=y),z!==f._v$4&&B(_,"aria-label",f._v$4=z),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()};A(["click"]);class Cn extends me{constructor(t){super(),this.tags=t}}const bn=e=>{try{const t=ae.parse(JSON.parse(e));return new Cn(t)}catch(t){throw new TypeError("failed to parse tags schema: ",{cause:t})}},[X,_n]=ee(()=>R({})),[In,Tn]=ee(()=>R({})),En=e=>{const t=oe(),[o,s]=R(null);return T(()=>{const r=e();if(r==null)return;const{encrypted:l}=r;if(l in X()){s(X()[l]);return}const c=t();c!=null&&(In()[l]||(Tn(i=>({...i,[l]:!0})),window.nostr?.nip04?.decrypt?.(c,l)?.then(i=>{_n(a=>({...a,[l]:i})),s(i)}).catch(i=>{console.error(`failed to decrypt "${l}"`,i)})))}),o},Sn=e=>{const t=Q(()=>de(e.event)),o=En(()=>{const{content:l}=t();return l==null||l.length===0?null:{id:t().id,encrypted:l}}),s=()=>{const l=o();if(l==null)return[];console.log(l);try{return bn(l).taggedEventIds()}catch(c){return console.warn(c),[]}},r=()=>t().taggedEventIds();return n(O,{get each(){return[...r(),...s()]},children:l=>n(q,{get children(){return n(Qe,{eventId:l,get ensureKinds(){return[ne]}})}})})},Ln=e=>{const t=ge(),o=Q(e),s=()=>["useFollowings",o()],r=he(()=>({queryKey:s(),queryFn:({queryKey:c,signal:i})=>{console.debug("useFollowings");const[,a]=c;if(a==null)return Promise.resolve(null);const{kind:h,author:v,identifier:m}=a,g=new Te({type:"ParameterizedReplaceableEvent",kind:h,author:v,identifier:m}),w=g.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${h}:${v}:${m}`)});return g.onUpdate(S=>{const C=be(S);t.setQueryData(c,C)}),_e({task:g,signal:i}),Ie(15e3,`useParameterizedReplaceableEvent: ${h}:${v}:${m}`)(w)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>r.data??null,query:r}},Fn=e=>{const t=E(),{removeColumn:o}=x(),{event:s}=Ln(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.bookmark")},get icon(){return n(Ee,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(I,{get when(){return s()},keyed:!0,children:r=>n(Sn,{event:r})})}})},pn=e=>{const t=E(),{config:o,removeColumn:s}=x(),{followingPubkeys:r}=Ge(()=>({pubkey:e.column.pubkey})),l=P(()=>({duration:4*60*60})),{events:c,eose:i}=L(()=>{const a=Y([...r()]);return a.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:a,limit:20,since:l.since(),until:l.until()}],eoseLimit:20,continuous:l.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:h=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(h.content)}});return T(()=>{console.log("home",c()),l.setEvents(c())}),G(()=>console.log("home timeline mounted")),te(()=>console.log("home timeline unmounted")),n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.home")},get icon(){return n(Se,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:l,get eose(){return i()},get children(){return n(H,{get events(){return c()}})}})}})},Rn=d('<div class="flex items-center gap-1 pl-[2px] text-sm"><div class="notification-icon flex max-w-[64px] place-items-center overflow-hidden"></div><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class=shrink-0></span></div></div><div class=text-xs>'),Mn=d('<div class="notification-event py-1">'),Pn=d('<img alt=icon class="size-full object-cover">'),Dn=d("<div class=truncate> "),Un=e=>{const t=E(),o=Ve(),{shouldMuteEvent:s}=x(),{showProfile:r}=Re(),l=()=>ve(e.event),c=()=>l().lastTaggedEventId(),{profile:i}=Le(()=>({pubkey:e.event.pubkey})),{event:a,query:h}=Ze(()=>Fe([c()])(([m])=>({eventId:m}))),v=()=>h.isSuccess&&a()==null;return n(I,{get when(){return Q(()=>!v())()&&!s(e.event)},get children(){return[(()=>{const m=Rn(),g=m.firstChild,w=g.nextSibling,S=w.firstChild,C=S.nextSibling,_=C.firstChild,f=_.nextSibling,b=w.nextSibling;return u(g,n(We,{get reactionTypes(){return l().toReactionTypes()}})),u(S,n(I,{get when(){return i()?.picture},keyed:!0,children:k=>(()=>{const y=Pn();return N(()=>B(y,"src",en(k,"icon"))),y})()})),_.$$click=()=>r(e.event.pubkey),u(_,n(pe,{get pubkey(){return e.event.pubkey}})),u(f,()=>t.t("notification.reacted")),u(b,()=>o(l().createdAtAsDate())),m})(),(()=>{const m=Mn();return u(m,n(I,{get when(){return a()},get fallback(){return(()=>{const g=Dn(),w=g.firstChild;return u(g,()=>t.t("general.loading"),w),u(g,c,null),g})()},keyed:!0,children:g=>n(Je,{event:g})})),m})()]}})};A(["click"]);const zn=d("<div>unknown event"),Bn=fe(()=>ye(()=>import("./ZapReceipt-JCZxTFvK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),ce=e=>{const{shouldMuteEvent:t}=x();return n(O,{get each(){return e.events},children:o=>n(I,{get when(){return!t(o)},get children(){return n(K,{get fallback(){return zn()},get children(){return[n($,{get when(){return o.kind===ne},get children(){return n(q,{get children(){return n(Xe,{event:o})}})}}),n($,{get when(){return o.kind===xe},get children(){return n(q,{get children(){return n(Un,{event:o})}})}}),n($,{get when(){return o.kind===ke},get children(){return n(q,{get children(){return n(Ye,{event:o})}})}}),n($,{get when(){return o.kind===$e},get children(){return n(q,{get children(){return n(Bn,{event:o})}})}})]}})}})})},qn=e=>{const t=E(),{config:o,removeColumn:s}=x(),r=P(()=>({duration:null})),{events:l,eose:c}=L(()=>({relayUrls:o().relayUrls,filters:[{kinds:[1,6,7,9735],"#p":[e.column.pubkey],limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:i=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(i.content)}));return T(()=>r.setEvents(l())),n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.notification")},get icon(){return n(Me,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:r,get eose(){return c()},get children(){return n(ce,{get events(){return l()}})}})}})},Nn=e=>{const t=E(),{config:o,removeColumn:s}=x(),r=P(()=>({duration:null})),{events:l,eose:c}=L(()=>({relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:r.since(),until:r.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(i.content)}));return T(()=>r.setEvents(l())),n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.posts")},get icon(){return n(Pe,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:r,get eose(){return c()},get children(){return n(H,{get events(){return l()}})}})}})},An=e=>{const t=E(),{config:o,removeColumn:s}=x(),r=P(()=>({duration:null})),{events:l,eose:c}=L(()=>({relayUrls:o().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:r.since(),until:r.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(i.content)}));return T(()=>r.setEvents(l())),n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.reactions")},get icon(){return n(De,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:r,get eose(){return c()},get children(){return n(ce,{get events(){return l()}})}})}})},Hn=e=>{const t=E(),{removeColumn:o}=x(),s=P(()=>({duration:4*60*60})),{events:r,eose:l}=L(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:s.since(),until:s.until()}],eoseLimit:20,clientEventFilter:c=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(c.content)}));return T(()=>s.setEvents(r())),n(F,{get header(){return n(U,{get name(){return e.column.name??t.t("column.relay")},get icon(){return n(Ue,{})},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:s,get eose(){return l()},get children(){return n(H,{get events(){return r()}})}})}})},On=d('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block size-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),jn=e=>{const[t,o]=R(!1),[s,r]=R(""),{saveColumn:l}=x(),c=()=>o(m=>!m),i=()=>{s()!==e.column.query&&l({...e.column,query:s()})},a=()=>{i()},h=m=>{r(m.currentTarget.value)},v=m=>{m.preventDefault(),i()};return G(()=>{r(e.column.query)}),(()=>{const m=On(),g=m.firstChild,w=g.firstChild,S=w.firstChild,C=w.nextSibling,_=C.firstChild,f=C.nextSibling;return u(S,n(ze,{})),C.addEventListener("submit",v),_.addEventListener("blur",a),_.addEventListener("change",h),f.$$click=()=>c(),u(f,n(le,{})),u(m,n(I,{get when(){return t()},get children(){return e.settings()}}),null),N(()=>_.value=s()),m})()},Kn=e=>{const{removeColumn:t}=x(),o=P(()=>({duration:null})),{events:s,eose:r}=L(()=>{const{query:l}=e.column;return l.length===0?null:{relayUrls:we,filters:[{kinds:[1],search:l,limit:20,since:o.since(),until:o.until()}],eoseLimit:20,clientEventFilter:c=>c.tags.findIndex(([i])=>i==="mostr"||i==="proxy")>=0?!1:e.column.contentFilter==null?!0:M(e.column.contentFilter)(c.content)}});return T(()=>{o.setEvents(s())}),n(F,{get header(){return n(jn,{get column(){return e.column},settings:()=>n(p,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>t(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(D,{loadMore:o,get eose(){return r()},get children(){return n(H,{get events(){return s()}})}})}})};A(["click"]);const Qn=d('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),Gn=()=>{const{config:e}=x();return(()=>{const t=Qn();return u(t,n(O,{get each(){return e().columns},children:(o,s)=>{const r=()=>s()+1,l=()=>r()===e().columns.length;return n(K,{get children(){return[n($,{get when(){return o.columnType==="Following"&&o},keyed:!0,children:c=>n(pn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Notification"&&o},keyed:!0,children:c=>n(qn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Posts"&&o},keyed:!0,children:c=>n(Nn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Reactions"&&o},keyed:!0,children:c=>n(An,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Relays"&&o},keyed:!0,children:c=>n(Hn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Bookmark"&&o},keyed:!0,children:c=>n(Fn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})}),n($,{get when(){return o.columnType==="Search"&&o},keyed:!0,children:c=>n(Kn,{column:c,get columnIndex(){return r()},get lastColumn(){return l()}})})]}})}})),t})()},Vn=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],Zn=e=>{const t=new Map;return e.forEach(o=>{t.set(o.key,o)}),t},Wn=({shortcuts:e=Vn,onShortcut:t})=>{const o=Zn(e);G(()=>{const s=Be(r=>{if(r.type!=="keydown"||r.ctrlKey||r.altKey||r.metaKey||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLInputElement)return;const l=o.get(r.key);l!=null&&t(l)},50);window.addEventListener("keydown",s),te(()=>{window.removeEventListener("keydown",s)})})},Jn=()=>{const e=re();Wn({onShortcut:t=>{e(t.command).then(()=>console.debug(`shortcut key '${t.key}' was processed successfully`),o=>console.error(o))}})},Xn=d('<div class="absolute inset-0 flex h-svh w-screen touch-manipulation flex-row overflow-hidden">'),st=()=>{Jn();const e=Ae(),{config:t,initializeColumns:o}=x(),s=oe();return T(()=>{Promise.allSettled(t().relayUrls.map(async r=>{try{const l=await e().ensureRelay(r);l.onnotice=c=>{console.error(`NOTICE: ${r}: ${c}`)},l.onclose=()=>{console.warn(`CLOSE: ${r}`)}}catch(l){console.error("ensureRelay failed",l)}})).catch(()=>{})}),T(()=>{const r=s();r!=null&&o({pubkey:r})}),Ce(r=>{console.error("uncaught error: ",r)}),(()=>{const r=Xn();return u(r,n(qe,{}),null),u(r,n(Gn,{}),null),u(r,n(Ne,{}),null),r})()};export{st as default};
//# sourceMappingURL=Home-BPPxxiOg.js.map
