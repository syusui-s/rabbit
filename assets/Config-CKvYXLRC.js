import{s as P,t as u,d as I,c as U,i as r,a as l,h as k,u as S,j as R,F as L,aF as se,b as T,f as O,aG as e,aH as ae,n as te,aI as ce,aJ as de,r as ue,y as fe,aK as ge,aL as me,ak as pe}from"./index-PW0A2w9t.js";import{A as be}from"./arrow-left-ByDZ2iv3.js";import{w as he,x as $e,U as ne,X as A,b as ve,f as ye,g as re,m as xe,i as _e,F as we}from"./SideBar-CefENO7y.js";import{B as le}from"./BasicModal-CBPQt9mn.js";import{L as X,E as ke}from"./EventDisplay-INYiv8FE.js";import{S as J}from"./SafeLink-D8ciVPrD.js";import{s as Ce}from"./url-DPIb-kBm.js";import"./resolveAsset-DZ4x7lHy.js";const Se=u('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12c1.292 4.338 5.31 7.5 10.066 7.5.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88">'),je=(n={})=>(()=>{const t=Se();return P(t,n,!0),t})(),Ee=u('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128m0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42">'),Ie=(n={})=>(()=>{const t=Ee();return P(t,n,!0),t})(),Re=u('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M5.25 14.25h13.5m-13.5 0a3 3 0 0 1-3-3m3 3a3 3 0 1 0 0 6h13.5a3 3 0 1 0 0-6m-16.5-3a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3m-19.5 0a4.5 4.5 0 0 1 .9-2.7L5.737 5.1a3.375 3.375 0 0 1 2.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 0 1 .9 2.7m0 0a3 3 0 0 1-3 3m0 3h.008v.008h-.008zm0-6h.008v.008h-.008zm-3 6h.008v.008h-.008zm0-6h.008v.008h-.008z">'),Le=(n={})=>(()=>{const t=Re();return P(t,n,!0),t})(),Ue=u('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m19.5 8.25-7.5 7.5-7.5-7.5">'),Te=(n={})=>(()=>{const t=Ue();return P(t,n,!0),t})(),Oe=u('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m4.5 15.75 7.5-7.5 7.5 7.5">'),Fe=(n={})=>(()=>{const t=Oe();return P(t,n,!0),t})(),Me=u('<div class="border-t border-border p-2">'),Ne=u('<div class="mb-2 rounded border border-border shadow hover:shadow-md"><h3 class="text-lg font-bold"><button type=button class="flex w-full items-center p-2 text-start"><span class="flex-1 hover:text-fg-secondary"></span><span class="inline-block size-4 shrink-0 text-fg">'),C=n=>{const[t,s]=U(n.initialOpened??!0),b=()=>s(m=>!m);return(()=>{const m=Ne(),a=m.firstChild,o=a.firstChild,i=o.firstChild,f=i.nextSibling;return o.$$click=()=>b(),r(i,()=>n.title),r(f,l(k,{get when(){return t()},get fallback(){return l(Te,{})},get children(){return l(Fe,{})}})),r(m,l(k,{get when(){return t()},get children(){const d=Me();return r(d,()=>n.children),d}}),null),m})()};I(["click"]);const Pe=u('<div class="scrollbar flex flex-col overflow-y-auto rounded-md border border-border">'),ze=u('<button type=button class="border-t border-border px-2 py-1 text-left first:border-none">'),qe=()=>{const n=S(),{config:t,setConfig:s}=R(),b=a=>{const o=t().colorTheme;return o.type==="specific"?o.id===a:!1},m=a=>{s(o=>({...o,colorTheme:{type:"specific",id:a}}))};return l(C,{get title(){return n.t("config.display.colorTheme")},get children(){const a=Pe();return r(a,l(L,{get each(){return Object.values(se)},children:o=>(()=>{const i=ze();return i.$$click=()=>m(o.id),r(i,()=>o.name),T(f=>{const d=!!b(o.id),g=!!b(o.id),h=!b(o.id);return d!==f._v$&&i.classList.toggle("bg-primary",f._v$=d),g!==f._v$2&&i.classList.toggle("text-primary-fg",f._v$2=g),h!==f._v$3&&i.classList.toggle("text-fg",f._v$3=h),f},{_v$:void 0,_v$2:void 0,_v$3:void 0}),i})()})),a}})};I(["click"]);const Be=u('<div class="flex flex-col justify-evenly gap-2 sm:flex-row">'),De=u('<div class="flex flex-1 flex-row items-center gap-1 sm:flex-col"><button type=button class="w-48 rounded border border-primary p-2 font-bold sm:w-full"></button><div class=text-xs>'),Ke=()=>{const n=S(),{config:t,setConfig:s}=R(),b=[{id:"relative",name:n.t("config.display.relativeTimeNotation"),example:n.t("config.display.relativeTimeNotationExample")},{id:"absolute-short",name:n.t("config.display.absoluteTimeNotationShort"),example:n.t("config.display.absoluteTimeNotationShortExample")},{id:"absolute-long",name:n.t("config.display.absoluteTimeNotationLong"),example:n.t("config.display.absoluteTimeNotationLongExample")}],m=a=>{s(o=>({...o,dateFormat:a}))};return l(C,{get title(){return n.t("config.display.timeNotation")},get children(){const a=Be();return r(a,l(L,{each:b,children:({id:o,name:i,example:f})=>(()=>{const d=De(),g=d.firstChild,h=g.nextSibling;return g.$$click=()=>m(o),r(g,i),r(h,f),T(c=>{const p=t().dateFormat===o,y=t().dateFormat===o,x=t().dateFormat!==o,w=t().dateFormat!==o;return p!==c._v$&&g.classList.toggle("bg-primary",c._v$=p),y!==c._v$2&&g.classList.toggle("text-primary-fg",c._v$2=y),x!==c._v$3&&g.classList.toggle("bg-bg",c._v$3=x),w!==c._v$4&&g.classList.toggle("text-primary",c._v$4=w),c},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()})),a}})};I(["click"]);const Ae=u('<button class="flex h-[24px] w-[48px] items-center rounded-full border border-primary/80 px-1"><span class="m-[-3px] inline-block size-5 rounded-full border bg-primary-fg shadow">'),F=n=>(()=>{const t=Ae();return t.$$click=s=>n.onClick(s),T(s=>{const b=!n.value,m=!n.value,a=!!n.value,o=!!n.value,i=n.value;return b!==s._v$&&t.classList.toggle("bg-bg-tertiary",s._v$=b),m!==s._v$2&&t.classList.toggle("justify-start",s._v$2=m),a!==s._v$3&&t.classList.toggle("bg-primary",s._v$3=a),o!==s._v$4&&t.classList.toggle("justify-end",s._v$4=o),i!==s._v$5&&O(t,"area-label",s._v$5=i),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})();I(["click"]);const Je=u("<p>"),He=u('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1>YouTube</div></div><div class="flex w-full"><div class=flex-1>X (Twitter)</div></div><div class="flex w-full"><div class=flex-1>OGP'),Ge=()=>{const n=S(),{config:t,setConfig:s}=R(),b=m=>{s(a=>({...a,embedding:{...a.embedding,[m]:!a.embedding[m]}}))};return l(C,{get title(){return n.t("config.display.embedding")},get children(){return[(()=>{const m=Je();return r(m,()=>n.t("config.display.embeddingDescription")),m})(),(()=>{const m=He(),a=m.firstChild;a.firstChild;const o=a.nextSibling;o.firstChild;const i=o.nextSibling;return i.firstChild,r(a,l(F,{get value(){return t().embedding.youtube},onClick:()=>b("youtube")}),null),r(o,l(F,{get value(){return t().embedding.twitter},onClick:()=>b("twitter")}),null),r(i,l(F,{get value(){return t().embedding.ogp},onClick:()=>b("ogp")}),null),m})()]}})},Xe=u('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),Ve=()=>{const n=S(),{config:t,setConfig:s}=R(),b=()=>{s(o=>({...o,keepOpenPostForm:!(o.keepOpenPostForm??!1)}))},m=()=>{s(o=>({...o,showMedia:!(o.showMedia??!0)}))},a=()=>{s(o=>({...o,hideCount:!(o.hideCount??!1)}))};return l(C,{get title(){return n.t("config.display.others")},get children(){const o=Xe(),i=o.firstChild,f=i.firstChild,d=i.nextSibling,g=d.firstChild,h=d.nextSibling,c=h.firstChild;return r(f,()=>n.t("config.display.keepOpenPostForm")),r(i,l(F,{get value(){return t().keepOpenPostForm},onClick:()=>b()}),null),r(g,()=>n.t("config.display.showMediaByDefault")),r(d,l(F,{get value(){return t().showMedia},onClick:()=>m()}),null),r(c,()=>n.t("config.display.hideNumbers")),r(h,l(F,{get value(){return t().hideCount},onClick:()=>a()}),null),o}})},Qe=u('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),Ye=()=>{const n=S(),{config:t,setConfig:s}=R(),b=()=>{s(a=>({...a,useEmojiReaction:!(a.useEmojiReaction??!1)}))},m=()=>{s(a=>({...a,showEmojiReaction:!(a.showEmojiReaction??!1)}))};return l(C,{get title(){return n.t("config.display.reaction")},get children(){const a=Qe(),o=a.firstChild,i=o.firstChild,f=o.nextSibling,d=f.firstChild;return r(i,()=>n.t("config.display.enableEmojiReaction")),r(o,l(F,{get value(){return t().useEmojiReaction},onClick:()=>b()}),null),r(d,()=>n.t("config.display.showEmojiReaction")),r(f,l(F,{get value(){return t().showEmojiReaction},onClick:()=>m()}),null),a}})},W=e.string().length(64).regex(/^[0-9a-f]{64}$/),V=e.string().regex(/^\w+$/),We=e.object({shortcode:V,url:e.string().url(),keywords:e.optional(e.array(V))}),Ze=e.object({manifest:e.literal("emojipack_v1"),name:e.string(),emojis:e.array(We),description:e.optional(e.string()),author:e.optional(W),publisher:e.optional(W)}).refine(n=>he(n.emojis,s=>s.shortcode).length===n.emojis.length,{message:"shortcodes should be unique"}),oe=e.record(V,e.string().url());Ze.or(oe);const et=n=>Object.entries(n).map(([t,s])=>({shortcode:t,url:s})),tt=u("<p>"),nt=u('<form class="flex flex-col gap-2"><textarea class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"name=json placeholder="{ &quot;smiley&quot;: &quot;https://example.com/smiley.png&quot; }"></textarea><button type=submit class="w-24 self-end rounded bg-primary p-2 font-bold text-primary-fg">'),rt=()=>{const n=S(),{saveEmojis:t}=R(),[s,b]=U(""),m=a=>{if(a.preventDefault(),s().length!==0)try{const o=oe.parse(JSON.parse(s())),i=et(o);t(i),b("")}catch(o){const i=o instanceof Error?`:${o.message}`:"";window.alert(`JSONの読み込みに失敗しました${i}`)}};return l(C,{get title(){return n.t("config.customEmoji.emojiImport")},get children(){return[(()=>{const a=tt();return r(a,()=>n.t("config.customEmoji.emojiImportDescription")),a})(),(()=>{const a=nt(),o=a.firstChild,i=o.nextSibling;return a.addEventListener("submit",m),o.addEventListener("change",f=>b(f.currentTarget.value)),r(i,()=>n.t("config.customEmoji.importEmoji")),T(()=>o.value=s()),a})()]}})},lt=u('<form class="flex flex-col gap-2"><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=shortcode placeholder=smiley pattern=^\\w+$ required></label><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=url placeholder=https://example.com/smiley.png required></label><button type=submit class="w-24 self-end rounded bg-primary p-2 font-bold text-primary-fg">'),ot=u('<ul class="mt-4 flex max-h-[40vh] min-h-64 flex-wrap overflow-y-auto border-t border-border">'),it=u('<div class="flex min-w-24 flex-col items-center rounded border border-border bg-bg shadow"><div class="flex items-center p-1"><img class="h-20 max-w-20 object-contain"></div><div class="p-1 text-center text-sm"></div><div class="w-full border-t border-border"><button type=button class="w-full px-2 py-1 text-danger">'),st=u('<li class="min-w-0 basis-1/2 sm:basis-1/4"><button type=button class="flex w-full flex-col items-center gap-1 rounded p-2 hover:bg-bg-tertiary/20 hover:shadow"><div class="w-full truncate text-xs text-fg-secondary">'),at=u("<div class=size-8>"),ct=u('<div class="flex h-8 max-w-8 items-center"><img class=object-contain>'),dt=()=>{const n=S(),{config:t,saveEmoji:s,removeEmoji:b}=R(),[m,a]=U(""),[o,i]=U(""),f=d=>{d.preventDefault(),!(m().length===0||o().length===0)&&(s({shortcode:m(),url:o()}),a(""),i(""))};return l(C,{get title(){return n.t("config.customEmoji.customEmoji")},get children(){return[(()=>{const d=lt(),g=d.firstChild,h=g.firstChild,c=h.nextSibling,p=g.nextSibling,y=p.firstChild,x=y.nextSibling,w=p.nextSibling;return d.addEventListener("submit",f),r(h,()=>n.t("config.customEmoji.shortcode")),c.addEventListener("change",_=>a(_.currentTarget.value)),r(y,()=>n.t("config.customEmoji.url")),x.addEventListener("change",_=>i(_.currentTarget.value)),O(x,"pattern",ae),r(w,()=>n.t("config.customEmoji.addEmoji")),T(()=>c.value=m()),T(()=>x.value=o()),d})(),(()=>{const d=ot();return r(d,l(L,{get each(){return Object.values(t().customEmojis)},children:({shortcode:g,url:h})=>{const c=$e(()=>({popup:(()=>{const p=it(),y=p.firstChild,x=y.firstChild,w=y.nextSibling,_=w.nextSibling,j=_.firstChild;return O(x,"src",h),O(x,"alt",g),r(w,g),j.$$click=()=>b(g),r(j,()=>n.t("config.customEmoji.removeEmoji")),p})()}));return(()=>{const p=st(),y=p.firstChild,x=y.firstChild,w=c.targetRef;return typeof w=="function"?te(w,p):c.targetRef=p,y.$$click=()=>c.open(),r(y,l(X,{get fallback(){return at()},children:()=>(()=>{const _=ct(),j=_.firstChild;return O(j,"src",h),O(j,"alt",g),_})()}),x),r(x,g),r(p,()=>c.popup(),null),p})()}})),d})()]}})};I(["click"]);const ut=u('<ul class="flex max-h-[50vh] min-h-64 flex-col overflow-y-auto">'),ft=u('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border focus:border-border focus:ring-primary"type=text name=keyword><button type=submit class="rounded bg-primary p-2 font-bold text-primary-fg">'),gt=u('<ul class="mt-2 flex max-h-[50vh] min-h-64 flex-col overflow-y-auto border-t border-border">'),mt=u('<ul class="flex max-h-[50vh] min-h-64 flex-col gap-1 overflow-y-auto">'),Z=u('<li class="flex items-center border-b border-border pr-4"><div class="flex-1 truncate"></div><button class="size-3 shrink-0">'),ee=u("<div class=h-4>"),pt=u('<li class="flex items-center"><div class="flex-1 truncate rounded border border-border p-2"></div><button class=p-4><span class="inline-block size-4">'),bt=()=>{const n=S(),{config:t,removeMutedPubkey:s,removeMutedThread:b,addMutedKeyword:m,removeMutedKeyword:a}=R(),[o,i]=U(""),f=d=>{d.preventDefault(),o().length!==0&&(m(o()),i(""))};return[l(C,{get title(){return n.t("config.mute.mutedUsers")},initialOpened:!1,get children(){const d=ut();return r(d,l(L,{get each(){return t().mutedPubkeys},children:g=>(()=>{const h=Z(),c=h.firstChild,p=c.nextSibling;return r(c,l(X,{get fallback(){return ee()},children:()=>l(ne,{pubkey:g})})),p.$$click=()=>s(g),r(p,l(A,{})),h})()})),d}}),l(C,{get title(){return n.t("config.mute.mutedKeywords")},initialOpened:!1,get children(){return[(()=>{const d=ft(),g=d.firstChild,h=g.nextSibling;return d.addEventListener("submit",f),g.addEventListener("change",c=>i(c.currentTarget.value)),r(h,()=>n.t("config.mute.add")),T(()=>g.value=o()),d})(),(()=>{const d=gt();return r(d,l(L,{get each(){return t().mutedKeywords},children:g=>(()=>{const h=Z(),c=h.firstChild,p=c.nextSibling;return r(c,g),p.$$click=()=>a(g),r(p,l(A,{})),h})()})),d})()]}}),l(C,{get title(){return n.t("config.mute.mutedThreads")},initialOpened:!1,get children(){const d=mt();return r(d,l(L,{get each(){return t().mutedThreads},children:g=>(()=>{const h=pt(),c=h.firstChild,p=c.nextSibling,y=p.firstChild;return r(c,l(X,{get fallback(){return ee()},children:()=>l(ke,{eventId:g,actions:!1,displayForcibly:!0})})),p.$$click=()=>b(g),r(y,l(A,{})),h})()})),d}})]};I(["click"]);const ht=u('<div class="flex gap-2 py-1"><button class="rounded border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded border border-primary px-4 py-1 font-bold text-primary">'),$t=u("<input type=file hidden name=config accept=application/json>"),vt=()=>{let n;const t=S(),s=R(),b=()=>{const i=JSON.stringify(s.config(),null,2),f=new Blob([i],{type:"application/json"}),d=URL.createObjectURL(f),g=new Date().toISOString(),h=document.createElement("a");h.href=d,h.download=`rabbit-${g}.json`,h.click()},m=()=>{n?.click()},a=async i=>{try{const f=await i.text(),d=ce.parse(JSON.parse(f));s.setConfig(d),window.alert(t.t("config.account.restored")),window.location.reload()}catch(f){f instanceof Error?window.alert(`${t.t("config.account.failedToRestore")}: ${f.message}`):window.alert(t.t("config.account.failedToRestore"))}},o=i=>{i.preventDefault();const f=[...i.currentTarget.files??[]];if(f.length!==1)return;const d=f[0];a(d).catch(g=>console.log(g))};return l(C,{get title(){return t.t("config.account.backupConfig")},get children(){return[(()=>{const i=ht(),f=i.firstChild,d=f.nextSibling;return f.$$click=b,r(f,()=>t.t("config.account.save")),d.$$click=m,r(d,()=>t.t("config.account.restore")),i})(),(()=>{const i=$t();i.addEventListener("change",o);const f=n;return typeof f=="function"?te(f,i):n=i,i.multiple=!1,i})()]}})};I(["click"]);const yt=u('<div class="flex gap-2 py-1"><button class="rounded border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded border border-primary px-4 py-1 font-bold text-primary">'),xt=()=>{const n=S(),t=ve(),{showProfile:s,showProfileEdit:b}=re();return l(C,{get title(){return n.t("config.account.profile")},get children(){const m=yt(),a=m.firstChild,o=a.nextSibling;return a.$$click=()=>ye([t()])(([i])=>{s(i)}),r(a,()=>n.t("config.account.openProfile")),o.$$click=()=>b(),r(o,()=>n.t("config.account.editProfile")),m}})};I(["click"]);const _t=e.object({max_message_length:e.optional(e.number()),max_subscriptions:e.optional(e.number()),max_filters:e.optional(e.number()),max_limit:e.optional(e.number()),max_subid_length:e.optional(e.number()),max_event_tags:e.optional(e.number()),max_content_length:e.optional(e.number()),min_pow_difficulty:e.optional(e.number()),auth_required:e.optional(e.boolean()),payment_required:e.optional(e.boolean()),restricted_writes:e.optional(e.boolean()),created_at_lower_limit:e.optional(e.number()),created_at_upper_limit:e.optional(e.number())}),wt=e.array(e.object({kinds:e.array(e.union([e.number(),e.array(e.number())])),time:e.nullable(e.number())})),H=e.object({amount:e.number(),unit:e.string(),period:e.optional(e.number()),kinds:e.optional(e.array(e.number()))}),kt=e.object({admission:e.optional(e.array(H)),subscription:e.optional(e.array(H)),publication:e.optional(e.array(H))}),Ct=e.object({name:e.optional(e.string()),description:e.optional(e.string()),pubkey:e.optional(e.string().refine(de)),contact:e.optional(e.string()),supported_nips:e.optional(e.array(e.number())),software:e.optional(e.string()),version:e.optional(e.string()),icon:e.optional(e.string().url()),limitation:e.optional(_t),retention:e.optional(wt),relay_countries:e.optional(e.array(e.string())),language_tags:e.optional(e.array(e.string())),tags:e.optional(e.array(e.string())),posting_policy:e.optional(e.string().url()),payments_url:e.optional(e.string().url()),fees:e.optional(kt)}),St=n=>{const t=new URL(n);if(t.protocol==="wss:")t.protocol="https";else if(t.protocol==="ws:")t.protocol="http";else throw new Error("unexpected protocol");return t},jt=async n=>{const t=St(n),s=await fetch(t,{headers:{Accept:"application/nostr+json"},mode:"cors"});if(s.status!==200)throw new Error("failed to fetch relay info: status was not 200");const b=await s.json();if(!ge(Ct)(b))throw new Error("failed to fetch relay info: unexpected form of data");return b},ie=n=>{const t=ue(n),s=fe(()=>({queryKey:["useRelayInfo",t()],queryFn:({queryKey:b})=>{const[,m]=b;if(m!=null)return jt(m.relayUrl)},enabled:t()!=null,staleTime:5*60*1e3,gcTime:3*24*60*60*1e3}));return{relayInfo:()=>s.data,query:s}},Et=u('<div class="scrollbar max-h-24 overflow-scroll whitespace-pre-wrap break-words px-4 py-2">'),It=u('<pre class="w-full overflow-scroll rounded-lg border border-border p-4">'),Rt=u('<div class="divide-y divide-border"><div class="flex max-w-full items-center gap-4 p-4"><div class="min-w-0 flex-1"><h3 class="truncate text-2xl font-bold"></h3><div class="truncate text-sm"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex flex-col gap-2 p-4"><button class="select-text rounded-lg border border-border bg-bg-tertiary/20 p-2 text-fg-secondary hover:bg-bg-tertiary">'),Lt=u('<div class="size-16 overflow-hidden rounded-lg shadow-md"><img alt="icon of relay"class="size-full object-cover">'),K=u("<div>"),Ut=u('<div class="whitespace-normal break-words"><button class="inline select-text underline">'),G=u('<div class="whitespace-pre-wrap break-all">'),Tt=u('<div class="flex-1 shrink-0 border-t border-border px-4 py-2"><div class="text-sm text-fg-secondary"></div><div class="scrollbar flex w-full gap-1 overflow-x-scroll pt-1">'),Ot=u('<span class="inline-block w-12 rounded-xl border border-border py-2 text-center hover:border-fg-tertiary hover:text-fg-secondary">'),Ft=n=>`https://github.com/nostr-protocol/nips/blob/master/${n.toString(10).padStart(2,"0")}.md`,Mt=n=>{const t=S(),{relayInfo:s}=ie(()=>({relayUrl:n.relayUrl})),[b,m]=U(!1),a=()=>m(i=>!i),{showProfile:o}=re();return l(le,{get onClose(){return n.onClose},get children(){const i=Rt(),f=i.firstChild,d=f.firstChild,g=d.firstChild,h=g.nextSibling,c=f.nextSibling,p=c.firstChild,y=p.firstChild,x=p.nextSibling,w=x.firstChild,_=c.nextSibling,j=_.firstChild,z=j.firstChild,q=j.nextSibling,B=q.firstChild,M=_.nextSibling,N=M.firstChild;return r(f,l(k,{get when(){return s()?.icon},keyed:!0,children:$=>(()=>{const v=Lt(),E=v.firstChild;return O(E,"src",$),v})()}),d),r(g,()=>s()?.name??n.relayUrl),r(h,()=>n.relayUrl),r(i,l(k,{get when(){return s()?.description},keyed:!0,get children(){const $=Et();return r($,()=>s()?.description),$}}),c),r(y,()=>t.t("relayInfo.administrator")),r(p,l(k,{get when(){return s()?.pubkey},get fallback(){return(()=>{const $=K();return r($,()=>t.t("relayInfo.unknown")),$})()},keyed:!0,children:$=>(()=>{const v=Ut(),E=v.firstChild;return E.$$click=()=>o($),r(E,l(ne,{pubkey:$})),v})()}),null),r(w,()=>t.t("relayInfo.contact")),r(x,l(k,{get when(){return s()?.contact},get fallback(){return(()=>{const $=K();return r($,()=>t.t("relayInfo.unknown")),$})()},keyed:!0,children:$=>(()=>{const v=G();return r(v,l(J,{class:"underline",href:$,children:$})),v})()}),null),r(z,()=>t.t("relayInfo.software")),r(j,l(k,{get when(){return s()?.software},get fallback(){return(()=>{const $=K();return r($,()=>t.t("relayInfo.unknown")),$})()},keyed:!0,children:$=>(()=>{const v=G();return r(v,l(k,{get when(){return Ce($)},fallback:$,keyed:!0,children:E=>l(J,{class:"underline",href:E})})),v})()}),null),r(B,()=>t.t("relayInfo.version")),r(q,l(k,{get when(){return s()?.version},get fallback(){return(()=>{const $=K();return r($,()=>t.t("relayInfo.unknown")),$})()},keyed:!0,children:$=>(()=>{const v=G();return r(v,$),v})()}),null),r(i,l(k,{get when(){return s()?.supported_nips},keyed:!0,children:$=>(()=>{const v=Tt(),E=v.firstChild,D=E.nextSibling;return r(E,()=>t.t("relayInfo.supportedNips")),r(D,l(L,{each:$,children:Q=>l(J,{get href(){return Ft(Q)},get children(){const Y=Ot();return r(Y,Q),Y}})})),v})()}),M),N.$$click=a,r(N,()=>t.t("relayInfo.showJSON")),r(M,l(k,{get when(){return b()},get children(){const $=It();return r($,()=>JSON.stringify(s(),null,2)),$}}),null),i}})};I(["click"]);const Nt=u("<p class=py-1>"),Pt=u('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=relayUrl placeholder=wss://...><button type=submit class="rounded bg-primary p-2 font-bold text-primary-fg">'),zt=u('<ul class="mt-2 divide-y divide-border rounded border border-border">'),qt=u('<button type=button class="rounded bg-primary p-2 font-bold text-primary-fg">'),Bt=u('<li class=flex><button class="flex flex-1 items-center truncate rounded py-1 text-start hover:bg-bg-tertiary"><div class="shrink-0 px-2"><span class="inline-block size-2 rounded-full"aria-label=""></span></div><div class="min-w-0 flex-1"><div class=truncate></div><div class="truncate text-xs text-fg-secondary"></div></div></button><button class="flex shrink-0 items-center justify-center pe-6 ps-4"><span class=size-3>'),Dt=()=>{const n=S(),{config:t,addRelay:s,removeRelay:b}=R(),m=xe(),[a,o]=U(""),[i,f]=U(null),d=()=>f(null),g=c=>{c.preventDefault(),a().length!==0&&(s(a()),o(""))},h=async()=>{if(window.nostr==null)return;const c=Object.entries(await window.nostr?.getRelays?.()??[]),p=c.map(([_])=>_).join(`
`);if(c.length===0){window.alert(n.t("config.relays.notConfigured"));return}if(!window.confirm(`${n.t("config.relays.askImport")}

${p}`))return;const y=t().relayUrls.length;pe(()=>{c.forEach(([_])=>{s(_)})});const w=t().relayUrls.length-y;window.alert(n.t("config.relays.imported",{count:w}))};return[l(C,{get title(){return n.t("config.relays.relays")},get children(){return[(()=>{const c=Nt();return r(c,()=>n.t("config.relays.numOfRelays",{count:t().relayUrls.length})),c})(),(()=>{const c=Pt(),p=c.firstChild,y=p.nextSibling;return c.addEventListener("submit",g),p.addEventListener("change",x=>o(x.currentTarget.value)),O(p,"pattern",me),r(y,()=>n.t("config.relays.addRelay")),T(()=>p.value=a()),c})(),(()=>{const c=zt();return r(c,l(L,{get each(){return t().relayUrls},children:p=>{const{relayInfo:y}=ie(()=>({relayUrl:p})),x=()=>m().getRelay(p)?.connected??!1;return(()=>{const w=Bt(),_=w.firstChild,j=_.firstChild,z=j.firstChild,q=j.nextSibling,B=q.firstChild,M=B.nextSibling,N=_.nextSibling,$=N.firstChild;return _.$$click=()=>f({type:"RelayInfo",relayUrl:p}),r(B,()=>y()?.name??p),r(M,p),N.$$click=()=>b(p),r($,l(A,{})),T(v=>{const E=!x(),D=!!x();return E!==v._v$&&z.classList.toggle("bg-rose-500",v._v$=E),D!==v._v$2&&z.classList.toggle("bg-green-500",v._v$2=D),v},{_v$:void 0,_v$2:void 0}),w})()}})),c})()]}}),l(C,{get title(){return n.t("config.relays.importRelays")},get children(){const c=qt();return c.$$click=()=>{h().catch(p=>{console.error("failed to import relays",p),window.alert(n.t("config.relays.failedToImport"))})},r(c,()=>n.t("config.relays.importFromExtension")),c}}),l(k,{get when(){return i()},keyed:!0,children:c=>l(k,{get when(){return c.type==="RelayInfo"},get children(){return l(Mt,{get relayUrl(){return c.relayUrl},onClose:()=>d()})}})})]};I(["click"]);const Kt=u("<div class=p-4>"),At=u('<h2 class="flex-1 text-center text-lg font-bold">'),Jt=u('<ul class="flex flex-col">'),Ht=u('<li class=w-full><button class="flex w-full gap-2 py-3 hover:text-primary"><span class="inline-block size-6">'),Gt=u('<div class="flex flex-col"><div><button class="pr-4 text-fg hover:text-fg-secondary"><span class="inline-block size-6"></span></button></div><div class="w-full flex-1 pt-4">'),nn=n=>{const t=S(),[s,b]=U(null),m=[{name:()=>t.t("config.account.profile"),icon:()=>l(_e,{}),render:()=>[l(xt,{}),l(vt,{})]},{name:()=>t.t("config.relays.relays"),icon:()=>l(Le,{}),render:()=>l(Dt,{})},{name:()=>t.t("config.display.display"),icon:()=>l(Ie,{}),render:()=>[l(qe,{}),l(Ke,{}),l(Ye,{}),l(Ge,{}),l(Ve,{})]},{name:()=>t.t("config.customEmoji.customEmoji"),icon:()=>l(we,{}),render:()=>[l(dt,{}),l(rt,{})]},{name:()=>t.t("config.mute.mute"),icon:()=>l(je,{}),render:()=>l(bt,{})}],a=()=>{const o=s();return o==null?null:m[o]};return l(le,{get onClose(){return n.onClose},get children(){const o=Kt();return r(o,l(k,{get when(){return a()},get fallback(){return[(()=>{const i=At();return r(i,()=>t.t("config.config")),i})(),(()=>{const i=Jt();return r(i,l(L,{each:m,children:(f,d)=>(()=>{const g=Ht(),h=g.firstChild,c=h.firstChild;return h.$$click=()=>b(d),r(c,()=>f.icon()),r(h,()=>f.name(),null),g})()})),i})()]},keyed:!0,children:i=>(()=>{const f=Gt(),d=f.firstChild,g=d.firstChild,h=g.firstChild,c=d.nextSibling;return g.$$click=()=>b(null),r(h,l(be,{})),r(c,()=>i.render()),f})()})),o}})};I(["click"]);export{nn as default};
//# sourceMappingURL=Config-CKvYXLRC.js.map
