import{i as g,t as m,j as E,a as r,h as k,F as x,d as L,w as d,c as h,u as _,b as M,v as p,z as q,A as C,x as O}from"./index-CvufKy-1.js";import{e as T}from"./EventDisplay-o840Rscw.js";import{q as b,w as Q,x as K,r as R,B as $}from"./SideBar-BD5ARE8G.js";const S=m('<div class="block shrink-0 overflow-hidden border-b border-border p-1">'),y=t=>(()=>{const n=S();return g(n,()=>t.children),n})(),D=t=>{const{shouldMuteEvent:n}=E();return r(x,{get each(){return t.events},children:e=>r(k,{get when(){return!n(e)},get children(){return r(y,{get children(){return r(T,{event:e})}})}})})},U=m('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary"><span>'),j=m('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary disabled:text-fg-secondary/30"><span>'),W=t=>{const n=d(t),e=i=>{const{duration:v}=n();if(v!=null)return i-v},[s,o]=h([]),[u,l]=h(e(b())),[a,c]=h();return{setEvents:o,since:u,until:a,continuous:()=>a()==null,loadLatest:()=>{p(()=>{c(void 0),l(e(b()))}),n().onLoad?.()},loadOld:()=>{const i=Q(s());i!=null&&(p(()=>{c(i.created_at),l(e(i.created_at))}),n().onLoad?.())}}},G=t=>{const n=_();return[r(k,{get when(){return!t.loadMore.continuous()},get children(){return r(y,{get children(){const e=U(),s=e.firstChild;return e.$$click=()=>t.loadMore.loadLatest(),g(s,()=>n.t("column.loadLatest")),e}})}}),d(()=>t.children),r(y,{get children(){const e=j(),s=e.firstChild;return e.$$click=()=>t.loadMore.loadOld(),g(s,()=>n.t("column.loadOld")),M(()=>e.disabled=!t.eose),e}})]};L(["click"]);const P=t=>["useFollowings",t],F=t=>{const n=()=>{const s=t();if(s==null)return[];const o=[];return O(s).pTags().forEach(l=>{const[,a,c,w]=l,f={pubkey:a,petname:w};c!=null&&c.length>0&&(f.mainRelayUrl=c),o.push(f)}),o};return{followings:n,followingPubkeys:()=>n().map(s=>s.pubkey),data:t}},H=async({pubkey:t},n)=>{const e=new $({type:"Followings",pubkey:t});R({task:e,signal:n});const s=await e.latestEventPromise();return F(()=>s)},J=t=>{const n=q(),e=d(t),s=d(()=>P(e())),o=C(()=>({queryKey:s(),queryFn:K({taskProvider:([,l])=>{if(l==null)return null;const{pubkey:a}=l;return new $({type:"Followings",pubkey:a})},queryClient:n}),staleTime:5*60*1e3,gcTime:3*24*60*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchInterval:0})),u=()=>n.invalidateQueries({queryKey:s()});return{...F(()=>o.data),invalidateFollowings:u,query:o}};export{y as C,G as L,D as T,W as a,H as f,P as q,J as u};
//# sourceMappingURL=useFollowings-C6qvwves.js.map
