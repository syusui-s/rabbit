{"version":3,"mappings":"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","names":["ArrowPathRoundedSquare","props","_el$","_tmpl$","_$spread","EventLink","url","createMemo","neventEncode","id","eventId","err","console","error","_$createComponent","Show","when","fallback","_$insert","keyed","children","_el$2","_tmpl$2","_$setAttribute","href","useEvent","propsProvider","query","createQuery","queryKey","signal","currentProps","task","BatchedEventsTask","promise","registerTask","timeout","EventDisplayById","i18n","useTranslation","localProps","restProps","splitProps","shouldMuteEvent","useConfig","event","fetchedEvent","eventQuery","ensureNonNull","eventIdNonNull","hidden","ev","displayForcibly","Switch","t","Match","EventDisplay","_$mergeProps","isLoading","_el$3","firstChild","useDatePulser","currentDate","setCurrentDate","createSignal","createEffect","onCleanup","defaultRelativeDateFormatter","parsedDate","formatTime","date","defaultAbsoluteDateLongFormatter","defaultAbsoluteDateShortFormatter","calcDiffSec","parseDateDiff","diffSec","isSameDate","lhs","rhs","yesterdayOf","formatAbsolute","formatter","formatAbsoluteLong","formatAbsoluteShort","formatRelative","currentDateHigh","createRoot","currentDateLow","useFormatDate","config","Repost","showProfile","useModalState","formatDate","genericEvent","lastTaggedEventId","_el$4","_el$5","nextSibling","_el$6","_el$7","_el$8","_el$9","$$click","pubkey","UserDisplayName","createdAtAsDate","_$delegateEvents","Bolt","ChatBubbleLeft","EllipsisHorizontal","HeartSolid","EmojiDisplay","emoji","type","content","shortcode","isPlus","r","length","reactionTypesToEmojiTypes","ReactionEmojiDisplay","reactionTypes","DefaultDelay","useLongPress","ref","longPressed","onMount","onLongPress","onClick","delay","timer","startTimer","clearTimer","handlePressStart","handlePressEnd","handleClick","el","useEmojiPopup","emojiRef","popupHover","setPopupHover","close","setTimeout","popup","open","usePopup","addEventListener","position","x","y","longPress","targetRef","ChevronRight","SelectableItemDisplay","item","onSelect","onClose","SubMenuDisplay","contextMenuPopup","useContextMenu","menu","submenu","items","_ref$","_$use","ensureSelectableItem","ensureSubMenu","ensureWidth","_tmpl$3","For","each","filter","e","v","replaceableEventIdentifier","identifier","createDeletion","reason","kind","tags","Kind.EventDeletion","epoch","useDeleteMutation","mutation","wrapMutate","usePublishEventMutation","deleteEvent","createReaction","notifyPubkey","Kind.Reaction","EmojiRegex","queryKeyUseReactions","useReactions","queryClient","useQueryClient","genQueryKey","eventsQuery","mentionedEventId","reactions","result","key","reaction","events","useReactionMutation","publishReaction","createRepost","Kind.Repost","Kind.GenericRepost","queryKeyUseReposts","useReposts","reposts","useRepostMutation","publishRepost","Prefixes","siPrefix","value","options","precision","minValue","divider","divided","rounded","index","formatSiPrefix","inputValue","prefix","digits","wholeNumberDigits","EventDebugModal","lazy","UserList","ZapRequestModal","emojiDataToReactionTypes","native","src","Error","ReactionAction","usePubkey","reacted","setReacted","isReactedByWithEmoji","isReactedBy","isReactedByMe","p","isReactedByMeWithEmoji","reactionMutation","doReaction","isPending","pubkeyNonNull","then","catch","window","alert","getErrorMessage","handleReaction","stopPropagation","handleEmojiSelect","emojiPickerPopup","useEmojiPicker","onEmojiSelect","_$memo","HeartOutlined","hideCount","showEmojiReaction","minDigits","_$effect","_p$","_v$","_v$2","_$classList","disabled","undefined","useEmojiReaction","Plus","_$p","RepostAction","reposted","setReposted","isRepostedBy","isRepostedByMe","repostMutation","handleRepost","_v$3","_v$4","ReactionsModal","data","pubkeyExtractor","renderInfo","_el$10","_tmpl$4","toReactionTypes","RepostsModal","EmojiReactions","reactionsGrouped","_el$11","_tmpl$5","entries","isReactedByMeWithThisContent","findIndex","emojiTypes","emojiPopup","_el$12","_tmpl$7","_el$13","_el$14","_tmpl$6","Actions","addMutedThread","modal","setModal","closeModal","deleteMutation","muteThread","batch","Kind","rootEventId","TextNote","rootEvent","otherActionsPopup","navigator","clipboard","writeText","_el$15","_tmpl$8","confirm","results","failed","succeeded","count","_el$16","_tmpl$9","_el$17","_el$18","_el$19","_el$20","_el$21","onClickReply","_ref$2","zapTo","ContentWarningDisplay","showContentWarning","setShowContentWarning","contentWarning","ExclamationTriangle","GeneralUserMentionDisplay","profile","useProfile","name","npubEncodeFallback","LazyLoad","containerRef","visible","setVisible","observer","IntersectionObserver","forEach","entry","isIntersecting","disconnect","threshold","observe","_","MediaDisplay","setHidden","initialHidden","isError","setIsError","showButtonText","placeholder","Dynamic","component","AudioDisplay","SafeLink","mediaProps","_$addEventListener","ImageDisplay","thumbnailUrl","MentionedEventDisplay","mentionedEvent","marker","embedding","actions","ensureKinds","MentionedUserDisplay","directAccessHosts","getCharset","source","metaCharsetMatch","metaContentTypeMatch","supportedEncodings","fixEncoding","charset","parseOgpFromDOM","doc","urlString","m","property","image","title","description","isAbsoluteUrl","parseOgp","text","isOgpUrl","shouldAccessDirectly","buildUrl","fetchOgpContent","arrayBuffer","encodedContent","useOgp","twitterUrl","URL","host","youtubeUrl","videoId","iframeUrl","pathname","searchParams","set","location","origin","hasTwttr","twttr","TwitterEmbed","twitterRef","getColorTheme","isTwitterUrl","widgets","load","dataTheme","brightness","OgpEmbed","ogp","ogpProps","ClickToShow","PreviewedLink","twitter","youtube","parseYouTubeVideoUrl","VideoDisplay","videoRef","setError","TextNoteContentDisplay","saveColumn","request","useRequestCommand","addHashTagColumn","createSearchColumn","command","addRelayColumn","createRelaysColumn","relayUrls","parsed","showMedia","isImageUrl","isVideoUrl","isAudioUrl","isWebSocketUrl","reference","Offset","ThrottleWaitMs","useDetectOverflow","elementRef","overflow","setOverflow","setElementRef","detectOverflow","throttle","handleResize","Post","showOverflow","setShowOverflow","createdAt","createdAtFull","toLocaleString","author","authorPubkey","preventDefault","onShowProfile","picture","display_name","onShowEvent","current","footer","classList","toggle","TimelineContext","createContext","useTimelineContext","useContext","useTimelineState","timelineState","setTimelineState","createStore","setTimeline","clearTimeline","textAreaRef","timelineContext","showReplyForm","setShowReplyForm","closeReplyForm","toggleReplyForm","focus","textNote","showReplyEvent","replyingToEvent","containsEventMention","taggedPubkeys","replyToPubkey","NotePostForm","mode","replyTo","onPost","isAllowedKind","includes"],"ignoreList":[0,8,9,10,11,16],"sources":["../../node_modules/heroicons/24/outline/arrow-path-rounded-square.svg","../../src/components/EventLink.tsx","../../src/nostr/useEvent.ts","../../src/components/event/EventDisplayById.tsx","../../src/hooks/useDatePulser.ts","../../src/utils/formatDate.ts","../../src/hooks/useFormatDate.ts","../../src/components/event/Repost.tsx","../../node_modules/heroicons/24/outline/bolt.svg","../../node_modules/heroicons/24/outline/chat-bubble-left.svg","../../node_modules/heroicons/24/outline/ellipsis-horizontal.svg","../../node_modules/heroicons/24/solid/heart.svg","../../src/components/EmojiDisplay.tsx","../../src/components/ReactionEmojiDisplay.tsx","../../src/hooks/useLongPress.ts","../../src/components/useEmojiPopup.tsx","../../node_modules/heroicons/24/outline/chevron-right.svg","../../src/components/utils/useContextMenu.tsx","../../src/nostr/identifier.ts","../../src/nostr/builder/createDeletion.ts","../../src/nostr/mutation/useDeleteMutation.ts","../../src/nostr/builder/createReaction.ts","../../src/nostr/useReactions.ts","../../src/nostr/mutation/useReactionMutation.ts","../../src/nostr/builder/createRepost.ts","../../src/nostr/useReposts.ts","../../src/nostr/mutation/useRepostMutation.ts","../../src/utils/siPrefix.ts","../../src/components/Actions.tsx","../../src/components/event/textNote/ContentWarningDisplay.tsx","../../src/components/event/textNote/GeneralUserMentionDisplay.tsx","../../src/components/utils/LazyLoad.tsx","../../src/components/event/textNote/MediaDisplay.tsx","../../src/components/event/textNote/AudioDisplay.tsx","../../src/components/event/textNote/ImageDisplay.tsx","../../src/components/event/textNote/MentionedEventDisplay.tsx","../../src/components/event/textNote/MentionedUserDisplay.tsx","../../src/utils/ogp.ts","../../src/components/event/textNote/PreviewedLink.tsx","../../src/components/event/textNote/VideoDisplay.tsx","../../src/components/event/textNote/TextNoteContentDisplay.tsx","../../src/hooks/useDetectOverflow.ts","../../src/components/Post.tsx","../../src/components/timeline/TimelineContext.tsx","../../src/components/event/TextNote.tsx","../../src/components/event/EventDisplay.tsx"],"sourcesContent":["export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3\"/></svg>","import { createMemo, Show, type Component } from 'solid-js';\n\nimport { neventEncode } from 'nostr-tools/nip19';\n\ntype EventLinkProps = {\n  eventId: string;\n  kind?: number;\n};\n\nconst EventLink: Component<EventLinkProps> = (props) => {\n  const url = createMemo(() => {\n    try {\n      const nip19 = neventEncode({ id: props.eventId });\n      return `nostr:${nip19}`;\n    } catch (err) {\n      console.error(\n        'failed to encode event id into Bech32 entity (NIP-19) but ignore',\n        props.eventId,\n        err,\n      );\n      return null;\n    }\n  });\n\n  return (\n    <Show when={url()} fallback={<span>{props.eventId}</span>} keyed>\n      {(href) => (\n        <a class=\"text-link underline\" href={href}>\n          {href}\n        </a>\n      )}\n    </Show>\n  );\n};\n\nexport default EventLink;\n","import { createMemo } from 'solid-js';\n\nimport { createQuery, type UseQueryResult } from '@tanstack/solid-query';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport { registerTask, BatchedEventsTask, type EventTask } from '@/nostr/useBatchedEvents';\nimport timeout from '@/utils/timeout';\n\nexport type UseEventProps = {\n  eventId: string;\n};\n\nexport type UseEvent = {\n  event: () => NostrEvent | null;\n  query: UseQueryResult<NostrEvent | null>;\n};\n\nconst useEvent = (propsProvider: () => UseEventProps | null): UseEvent => {\n  const props = createMemo(propsProvider);\n\n  const query = createQuery(() => ({\n    queryKey: ['useEvent', props()] as const,\n    queryFn: ({ queryKey, signal }) => {\n      const [, currentProps] = queryKey;\n      if (currentProps == null) return null;\n      const { eventId } = currentProps;\n      const task = new BatchedEventsTask<EventTask>({ type: 'Event', eventId });\n      const promise = task.firstEventPromise().catch(() => {\n        throw new Error(`event not found: ${eventId}`);\n      });\n      console.log('useEvent', props());\n      registerTask({ task, signal });\n      return timeout(15000, `useEvent: ${eventId}`)(promise);\n    },\n    // Text notes never change, so they can be stored for a long time.\n    // However, events tend to be unreferenced as time passes.\n    staleTime: 4 * 60 * 60 * 1000, // 4 hour\n    gcTime: 4 * 60 * 60 * 1000, // 4 hour\n    refetchOnWindowFocus: false,\n    refetchOnMount: false,\n  }));\n\n  const event = () => query.data ?? null;\n\n  return { event, query };\n};\n\nexport default useEvent;\n","import { Switch, Match, type Component, splitProps } from 'solid-js';\n\nimport EventDisplay from '@/components/event/EventDisplay';\nimport { type EventDisplayProps } from '@/components/event/EventDisplay';\nimport EventLink from '@/components/EventLink';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useEvent from '@/nostr/useEvent';\nimport ensureNonNull from '@/utils/ensureNonNull';\n\ntype EventDisplayByIdProps = Omit<EventDisplayProps, 'event'> & {\n  eventId: string | undefined;\n  displayForcibly?: boolean;\n};\n\nconst EventDisplayById: Component<EventDisplayByIdProps> = (props) => {\n  const i18n = useTranslation();\n  const [localProps, restProps] = splitProps(props, ['eventId']);\n  const { shouldMuteEvent } = useConfig();\n\n  const { event: fetchedEvent, query: eventQuery } = useEvent(() =>\n    ensureNonNull([localProps.eventId] as const)(([eventIdNonNull]) => ({\n      eventId: eventIdNonNull,\n    })),\n  );\n\n  const hidden = (): boolean => {\n    const ev = fetchedEvent();\n    if (props.displayForcibly) return false;\n    return ev != null && shouldMuteEvent(ev);\n  };\n\n  return (\n    <Switch\n      fallback={\n        <span>\n          {i18n.t('post.failedToFetchEvent')}\n          {props.eventId}\n        </span>\n      }\n    >\n      <Match when={hidden()}>{null}</Match>\n      <Match when={fetchedEvent()} keyed>\n        {(event) => <EventDisplay event={event} {...restProps} />}\n      </Match>\n      <Match when={eventQuery.isLoading && localProps.eventId} keyed>\n        {(id) => (\n          <div class=\"truncate\">\n            {i18n.t('general.loading')} <EventLink eventId={id} />\n          </div>\n        )}\n      </Match>\n    </Switch>\n  );\n};\n\nexport default EventDisplayById;\n","import { createSignal, createEffect, onCleanup, type Accessor } from 'solid-js';\n\ntype DatePulserProps = {\n  interval: number;\n};\n\nconst useDatePulser = (propsProvider: () => DatePulserProps): Accessor<Date> => {\n  const [currentDate, setCurrentDate] = createSignal(new Date());\n\n  createEffect(() => {\n    const id = setInterval(() => {\n      setCurrentDate(new Date());\n    }, propsProvider().interval);\n\n    onCleanup(() => clearInterval(id));\n  });\n\n  return currentDate;\n};\n\nexport default useDatePulser;\n","export type RelativeDate =\n  | { kind: 'now' }\n  | { kind: 'seconds'; value: number }\n  | { kind: 'minutes'; value: number }\n  | { kind: 'hours'; value: number }\n  | { kind: 'days'; value: number }\n  | { kind: 'abs'; value: Date };\n\nexport type AbsoluteDate =\n  | { kind: 'today'; value: Date }\n  | { kind: 'yesterday'; value: Date }\n  | { kind: 'abs'; value: Date };\n\nexport type RelativeDateFormatter = (parsedDate: RelativeDate) => string;\nexport type AbsoluteDateFormatter = (parsedDate: AbsoluteDate) => string;\n\nconst defaultRelativeDateFormatter = (parsedDate: RelativeDate): string => {\n  switch (parsedDate.kind) {\n    case 'now':\n      return 'now';\n    case 'seconds':\n      return `${parsedDate.value}s`;\n    case 'minutes':\n      return `${parsedDate.value}m`;\n    case 'hours':\n      return `${parsedDate.value}h`;\n    case 'days':\n      return `${parsedDate.value}d`;\n    case 'abs':\n    default:\n      return parsedDate.value.toLocaleDateString();\n  }\n};\n\nconst formatTime = (date: Date): string =>\n  `${date.getHours()}:${date.getMinutes().toString().padStart(2, '0')}`;\n\nconst defaultAbsoluteDateLongFormatter = (parsedDate: AbsoluteDate): string => {\n  switch (parsedDate.kind) {\n    case 'today':\n      return parsedDate.value.toLocaleTimeString();\n    case 'yesterday':\n    case 'abs':\n    default:\n      return parsedDate.value.toLocaleString();\n  }\n};\n\nconst defaultAbsoluteDateShortFormatter = (parsedDate: AbsoluteDate): string => {\n  switch (parsedDate.kind) {\n    case 'today':\n      return formatTime(parsedDate.value);\n    case 'yesterday':\n      return ` ${formatTime(parsedDate.value)}`;\n    case 'abs':\n    default:\n      return parsedDate.value.toLocaleString();\n  }\n};\n\nconst calcDiffSec = (date: Date, currentDate: Date): number =>\n  Math.round(Number(currentDate) - Number(date)) / 1000;\n\nconst parseDateDiff = (date: Date, currentDate: Date): RelativeDate => {\n  const diffSec = calcDiffSec(date, currentDate);\n\n  if (diffSec < 10) {\n    return { kind: 'now' };\n  }\n  if (diffSec < 60) {\n    return { kind: 'seconds', value: Math.round(diffSec) };\n  }\n  if (diffSec < 3600) {\n    return { kind: 'minutes', value: Math.round(diffSec / 60) };\n  }\n  if (diffSec < 86400) {\n    // 1 days\n    return { kind: 'hours', value: Math.round(diffSec / 3600) };\n  }\n  if (diffSec < 604800) {\n    // 1 week\n    return { kind: 'days', value: Math.round(diffSec / 86400) };\n  }\n  return { kind: 'abs', value: date };\n};\n\nconst isSameDate = (lhs: Date, rhs: Date): boolean =>\n  lhs.getFullYear() === rhs.getFullYear() &&\n  lhs.getMonth() === rhs.getMonth() &&\n  lhs.getDate() === rhs.getDate();\n\nconst yesterdayOf = (date: Date): Date => new Date(+date - 24 * 60 * 60 * 1000);\n\nconst formatAbsolute = (\n  date: Date,\n  currentDate: Date,\n  formatter: AbsoluteDateFormatter,\n): string => {\n  if (isSameDate(date, currentDate)) {\n    return formatter({ kind: 'today', value: date });\n  }\n  if (isSameDate(date, yesterdayOf(currentDate))) {\n    return formatter({ kind: 'yesterday', value: date });\n  }\n  return formatter({ kind: 'abs', value: date });\n};\n\nexport const formatAbsoluteLong = (date: Date, currentDate: Date = new Date()) =>\n  formatAbsolute(date, currentDate, defaultAbsoluteDateLongFormatter);\n\nexport const formatAbsoluteShort = (date: Date, currentDate: Date = new Date()) =>\n  formatAbsolute(date, currentDate, defaultAbsoluteDateShortFormatter);\n\nexport const formatRelative = (\n  date: Date,\n  currentDate: Date = new Date(),\n  formatter: RelativeDateFormatter = defaultRelativeDateFormatter,\n): string => formatter(parseDateDiff(date, currentDate));\n","import { createRoot } from 'solid-js';\n\nimport useConfig from '@/core/useConfig';\nimport useDatePulser from '@/hooks/useDatePulser';\nimport { formatRelative, formatAbsoluteLong, formatAbsoluteShort } from '@/utils/formatDate';\n\n// 7 seconds is used here so that the last digit of relative time is changed.\nconst currentDateHigh = createRoot(() => useDatePulser(() => ({ interval: 7000 })));\nconst currentDateLow = createRoot(() => useDatePulser(() => ({ interval: 60 * 1000 })));\n\nconst useFormatDate = () => {\n  const { config } = useConfig();\n\n  return (date: Date) => {\n    switch (config().dateFormat) {\n      case 'absolute-long':\n        return formatAbsoluteLong(date, currentDateLow());\n      case 'absolute-short':\n        return formatAbsoluteShort(date, currentDateLow());\n      case 'relative':\n        return formatRelative(date, currentDateHigh());\n      default:\n        return formatRelative(date, currentDateHigh());\n    }\n  };\n};\n\nexport default useFormatDate;\n","// NIP-18\nimport { type Component, createMemo } from 'solid-js';\n\nimport ArrowPathRoundedSquare from 'heroicons/24/outline/arrow-path-rounded-square.svg';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport EventDisplayById from '@/components/event/EventDisplayById';\nimport UserDisplayName from '@/components/UserDisplayName';\nimport useFormatDate from '@/hooks/useFormatDate';\nimport useModalState from '@/hooks/useModalState';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { genericEvent } from '@/nostr/event';\n\nexport type RepostProps = {\n  event: NostrEvent;\n};\n\nconst Repost: Component<RepostProps> = (props) => {\n  const i18n = useTranslation();\n  const { showProfile } = useModalState();\n  const formatDate = useFormatDate();\n  const event = createMemo(() => genericEvent(props.event));\n  const eventId = () => event().lastTaggedEventId();\n\n  return (\n    <div>\n      <div class=\"flex items-center gap-1\">\n        <div class=\"flex shrink-0 place-items-center pl-[2px]\" aria-hidden=\"true\">\n          <span class=\"size-4 text-r-repost\">\n            <ArrowPathRoundedSquare />\n          </span>\n        </div>\n        <div class=\"notification-user flex min-w-0 flex-1 overflow-hidden text-xs\">\n          <button\n            class=\"truncate select-text hover:text-link hover:underline\"\n            onClick={() => showProfile(props.event.pubkey)}\n          >\n            <UserDisplayName pubkey={props.event.pubkey} />\n          </button>\n          <span class=\"shrink-0 whitespace-pre\">{i18n.t('notification.reposted')}</span>\n        </div>\n        <div class=\"text-xs\">{formatDate(event().createdAtAsDate())}</div>\n      </div>\n      <div class=\"pt-1\">\n        <EventDisplayById eventId={eventId()} />\n      </div>\n    </div>\n  );\n};\n\nexport default Repost;\n","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5z\"/></svg>","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741z\"/></svg>","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0\"/></svg>","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path d=\"m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z\"/></svg>","import { type Component, Match, Switch } from 'solid-js';\n\nexport type EmojiTypes =\n  | { type: 'Emoji'; content: string }\n  | { type: 'CustomEmoji'; shortcode: string; url: string };\n\nexport type EmojiDisplayProps = {\n  emoji: EmojiTypes;\n};\n\nconst EmojiDisplay: Component<EmojiDisplayProps> = (props) => (\n  <Switch>\n    <Match when={props.emoji.type === 'Emoji' && props.emoji.content} keyed>\n      {(content) => <span class=\"truncate\">{content}</span>}\n    </Match>\n    <Match when={props.emoji.type === 'CustomEmoji' && props.emoji} keyed>\n      {({ shortcode, url }) => (\n        <img\n          class=\"pointer-events-none h-full w-auto object-contain\"\n          src={url}\n          alt={`:${shortcode}:`}\n        />\n      )}\n    </Match>\n  </Switch>\n);\n\nexport default EmojiDisplay;\n","import { type Component, Match, Switch } from 'solid-js';\n\nimport HeartSolid from 'heroicons/24/solid/heart.svg';\n\nimport EmojiDisplay, { type EmojiTypes } from '@/components/EmojiDisplay';\nimport { type ReactionTypes } from '@/nostr/event/Reaction';\n\nexport type ReactionEmojiDisplayProps = {\n  reactionTypes: ReactionTypes;\n};\n\nexport const isPlus = (r: ReactionTypes) =>\n  r.type === 'LikeDislike' && (r.content === '+' || r.content.length === 0);\n\nexport const reactionTypesToEmojiTypes = (r: ReactionTypes): EmojiTypes | undefined => {\n  if (r.type === 'Emoji') return r;\n  if (r.type === 'CustomEmoji') return r;\n  return undefined;\n};\n\nconst ReactionEmojiDisplay: Component<ReactionEmojiDisplayProps> = (props) => (\n  <Switch fallback={<span class=\"truncate\">{props.reactionTypes.content}</span>}>\n    <Match when={isPlus(props.reactionTypes)}>\n      <span class=\"inline-block size-full pt-px text-r-reaction\">\n        <HeartSolid />\n      </span>\n    </Match>\n    <Match when={reactionTypesToEmojiTypes(props.reactionTypes)} keyed>\n      {(emoji) => <EmojiDisplay emoji={emoji} />}\n    </Match>\n  </Switch>\n);\n\nexport default ReactionEmojiDisplay;\n","import { onMount, onCleanup } from 'solid-js';\n\ntype UseLongPressProps = {\n  delay?: number;\n  onLongPress: () => void;\n  onClick: () => void;\n};\n\nconst DefaultDelay = 300;\n\nconst useLongPress = (propsProvider: () => UseLongPressProps) => {\n  let ref: HTMLElement | undefined;\n  let longPressed = false;\n\n  onMount(() => {\n    if (ref == null) return;\n    const { onLongPress, onClick, delay = DefaultDelay } = propsProvider();\n\n    let timer: ReturnType<typeof setTimeout> | undefined;\n\n    const startTimer = () => {\n      longPressed = false;\n      timer = setTimeout(() => {\n        longPressed = true;\n        onLongPress();\n      }, delay);\n    };\n\n    const clearTimer = () => {\n      if (timer != null) {\n        clearTimeout(timer);\n      }\n    };\n\n    const handlePressStart = () => {\n      startTimer();\n    };\n\n    const handlePressEnd = () => {\n      clearTimer();\n    };\n\n    const handleClick = () => {\n      if (longPressed) return;\n      clearTimer();\n      onClick();\n    };\n\n    ref.addEventListener('mousedown', handlePressStart);\n    ref.addEventListener('mouseup', handlePressEnd);\n\n    ref.addEventListener('touchstart', handlePressStart);\n    ref.addEventListener('touchend', handlePressEnd);\n\n    ref.addEventListener('click', handleClick);\n\n    onCleanup(() => {\n      clearTimer();\n      ref?.removeEventListener('mouseddown', handlePressStart);\n      ref?.removeEventListener('mouseup', handlePressEnd);\n\n      ref?.removeEventListener('touchstart', handlePressStart);\n      ref?.removeEventListener('touchend', handlePressEnd);\n\n      ref?.removeEventListener('click', handleClick);\n    });\n  });\n\n  return {\n    ref: (el: HTMLElement) => {\n      ref = el;\n    },\n  };\n};\n\nexport default useLongPress;\n","import { type JSX, Show, createMemo, createSignal, onMount } from 'solid-js';\n\nimport EmojiDisplay, { type EmojiTypes } from '@/components/EmojiDisplay';\nimport usePopup from '@/components/utils/usePopup';\nimport useLongPress from '@/hooks/useLongPress';\n\nexport type UseEmojiPopupProps = {\n  emoji: EmojiTypes;\n  onClick?: () => void;\n};\n\ntype UseEmojiPopup = {\n  emojiRef: (el: HTMLElement) => void;\n  popup: () => JSX.Element;\n};\n\nconst useEmojiPopup = (propsProvider: () => UseEmojiPopupProps | null): UseEmojiPopup => {\n  let emojiRef: HTMLElement | undefined;\n\n  const props = createMemo(propsProvider);\n\n  const [popupHover, setPopupHover] = createSignal(false);\n\n  const close = () => {\n    setTimeout(() => {\n      if (popupHover()) return;\n      popup.close();\n    }, 100);\n  };\n\n  const open = () => {\n    popup.open();\n  };\n\n  const popup = usePopup(() => ({\n    popup: () => (\n      <Show when={props()?.emoji} keyed>\n        {(emoji) => (\n          <div\n            onMouseEnter={() => {\n              setPopupHover(true);\n            }}\n            onMouseLeave={() => {\n              setPopupHover(false);\n              close();\n            }}\n          >\n            <div class=\"flex h-24 max-w-5xl min-w-24 items-center justify-center rounded-sm border border-border bg-bg text-5xl shadow-sm\">\n              <EmojiDisplay emoji={emoji} />\n            </div>\n          </div>\n        )}\n      </Show>\n    ),\n    position: { x: 'center', y: 'top' },\n  }));\n\n  const longPress = useLongPress(() => ({\n    onLongPress: () => open(),\n    onClick: () => props()?.onClick?.(),\n  }));\n\n  onMount(() => {\n    emojiRef?.addEventListener('mouseenter', open);\n    emojiRef?.addEventListener('mouseleave', close);\n  });\n\n  return {\n    emojiRef: (el) => {\n      emojiRef = el;\n      popup.targetRef(el);\n      longPress.ref(el);\n    },\n    popup: popup.popup,\n  };\n};\n\nexport default useEmojiPopup;\n","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m8.25 4.5 7.5 7.5-7.5 7.5\"/></svg>","import { createMemo, For, Switch, Match, type Component, type JSX } from 'solid-js';\n\nimport ChevronRight from 'heroicons/24/outline/chevron-right.svg';\n\nimport usePopup, { type UsePopupProps } from '@/components/utils/usePopup';\n\nexport type SelectableItem = {\n  content: JSX.Element;\n  when?: () => boolean;\n  onSelect: () => void;\n};\n\nexport type SubMenu = Omit<SelectableItem, 'type' | 'onSelect'> & {\n  content: JSX.Element;\n  items: (SelectableItem | SubMenu)[];\n};\n\nexport type MenuItem = SelectableItem | SubMenu;\n\nexport type UseContextMenuProps = Omit<UsePopupProps, 'popup'> & {\n  menu: (MenuItem | SubMenu)[];\n};\n\nexport type SelectableItemDisplayProps = {\n  item: SelectableItem;\n  onClose: () => void;\n};\n\nexport type SubMenuDisplayProps = {\n  submenu: SubMenu;\n  onClose: () => void;\n};\n\nconst SelectableItemDisplay: Component<SelectableItemDisplayProps> = (props) => {\n  const handleClick = () => {\n    props.item?.onSelect?.();\n    props.onClose();\n  };\n\n  return (\n    <li class=\"border-b border-border hover:bg-bg-tertiary\">\n      <button class=\"w-full px-4 py-1 text-start\" onClick={handleClick}>\n        {props.item.content}\n      </button>\n    </li>\n  );\n};\n\nconst SubMenuDisplay: Component<SubMenuDisplayProps> = (props) => {\n  const contextMenuPopup = useContextMenu(() => ({\n    menu: props.submenu.items,\n    position: { x: 'right', y: 'bottom' },\n  }));\n\n  const handleClick = () => {\n    contextMenuPopup.open();\n  };\n\n  return (\n    <li ref={contextMenuPopup.targetRef} class=\"border-b border-border hover:bg-bg-tertiary\">\n      <button class=\"flex w-full items-center py-1 ps-4 pe-2 text-start\" onClick={handleClick}>\n        <span class=\"flex-1\">{props.submenu.content}</span>\n        <span class=\"inline-block size-4 shrink-0\">\n          <ChevronRight />\n        </span>\n      </button>\n      {contextMenuPopup.popup()}\n    </li>\n  );\n};\n\nconst ensureSelectableItem = (item: MenuItem): SelectableItem | null => {\n  if ('onSelect' in item) return item;\n  return null;\n};\n\nconst ensureSubMenu = (item: MenuItem): SubMenu | null => {\n  if ('items' in item) return item;\n  return null;\n};\n\nconst useContextMenu = (propsProvider: () => UseContextMenuProps) => {\n  const props = createMemo(propsProvider);\n\n  const popup = usePopup(() => ({\n    ensureWidth: 300,\n    position: { x: 'right', y: 'bottom' },\n    ...props(),\n    popup: (\n      <ul class=\"min-w-[96px] rounded-sm border border-border bg-bg shadow-md\">\n        <For each={props().menu.filter((e) => e.when == null || e.when())}>\n          {(item) => (\n            <Switch>\n              <Match when={ensureSelectableItem(item)} keyed>\n                {(v) => <SelectableItemDisplay item={v} onClose={() => popup.close()} />}\n              </Match>\n              <Match when={ensureSubMenu(item)} keyed>\n                {(v) => <SubMenuDisplay submenu={v} onClose={() => popup.close()} />}\n              </Match>\n            </Switch>\n          )}\n        </For>\n      </ul>\n    ),\n  }));\n\n  return popup;\n};\n\nexport default useContextMenu;\n","export type ReplaceableEventIdentifier = {\n  kind: number;\n  pubkey: string;\n  identifier?: string;\n};\n\nexport const replaceableEventIdentifier = (identifier: ReplaceableEventIdentifier): string => {\n  if (identifier.identifier != null) {\n    return `${identifier.kind}:${identifier.pubkey}:${identifier.identifier}`;\n  }\n  return `${identifier.kind}:${identifier.pubkey}`;\n};\n","import * as Kind from 'nostr-tools/kinds';\nimport { type UnsignedEvent } from 'nostr-tools/pure';\n\nimport { type ReplaceableEventIdentifier, replaceableEventIdentifier } from '@/nostr/identifier';\nimport epoch from '@/utils/epoch';\n\nconst createDeletion = ({\n  pubkey,\n  identifier,\n  reason,\n  kind,\n}: {\n  pubkey: string;\n  identifier: string | ReplaceableEventIdentifier;\n  reason?: string;\n  kind: number;\n}): UnsignedEvent => {\n  const tags: string[][] = [];\n\n  if (typeof identifier === 'string') {\n    tags.push(['e', identifier]);\n  } else {\n    tags.push(['a', replaceableEventIdentifier(identifier)]);\n  }\n\n  tags.push(['k', kind.toString()]);\n\n  return {\n    kind: Kind.EventDeletion,\n    pubkey,\n    created_at: epoch(),\n    tags,\n    content: reason ?? '',\n  };\n};\n\nexport default createDeletion;\n","import { createMemo } from 'solid-js';\n\nimport createDeletion from '@/nostr/builder/createDeletion';\nimport usePublishEventMutation from '@/nostr/mutation/usePublishEventMutation';\n\nexport type UseDeleteMutationProps = {\n  id: string;\n};\n\nconst useDeleteMutation = (propsProvider: () => UseDeleteMutationProps) => {\n  const props = createMemo(propsProvider);\n\n  const { mutation, wrapMutate } = usePublishEventMutation(() => ({\n    mutationKey: ['useDeleteMutation', props().id],\n  }));\n\n  const deleteEvent = wrapMutate(createDeletion);\n\n  return { mutation, deleteEvent };\n};\n\nexport default useDeleteMutation;\n","import * as Kind from 'nostr-tools/kinds';\nimport { type UnsignedEvent } from 'nostr-tools/pure';\n\nimport { type ReactionTypes } from '@/nostr/event/Reaction';\nimport epoch from '@/utils/epoch';\n\nexport type CreateReactionParams = {\n  pubkey: string;\n  eventId: string;\n  kind: number;\n  reactionTypes: ReactionTypes;\n  notifyPubkey: string;\n};\n\n// NIP-25\nconst createReaction = ({\n  pubkey,\n  eventId,\n  kind,\n  reactionTypes,\n  notifyPubkey,\n}: CreateReactionParams): UnsignedEvent => {\n  const tags = [\n    ['e', eventId, ''],\n    ['p', notifyPubkey],\n    ['k', kind.toString()],\n  ];\n\n  if (reactionTypes.type === 'CustomEmoji') {\n    tags.push(['emoji', reactionTypes.shortcode, reactionTypes.url]);\n  }\n\n  return {\n    kind: Kind.Reaction,\n    pubkey,\n    created_at: epoch(),\n    tags,\n    content: reactionTypes.content,\n  };\n};\n\nexport default createReaction;\n","import { createMemo } from 'solid-js';\n\nimport { createQuery, useQueryClient, type UseQueryResult } from '@tanstack/solid-query';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport useConfig from '@/core/useConfig';\nimport { reaction } from '@/nostr/event';\nimport { eventsQuery } from '@/nostr/query';\nimport { BatchedEventsTask } from '@/nostr/useBatchedEvents';\n\nexport type UseReactionsProps = {\n  eventId: string;\n};\n\nexport type UseReactions = {\n  reactions: () => NostrEvent[];\n  reactionsGrouped: () => Map<string, NostrEvent[]>;\n  isReactedBy: (pubkey: string) => boolean;\n  isReactedByWithEmoji: (pubkey: string) => boolean;\n  query: UseQueryResult<NostrEvent[]>;\n};\n\nconst EmojiRegex = /\\p{Emoji_Presentation}/u;\n\nexport const queryKeyUseReactions = (props: UseReactionsProps | null) =>\n  ['useReactions', props] as const;\n\nconst useReactions = (propsProvider: () => UseReactionsProps | null): UseReactions => {\n  const { shouldMuteEvent } = useConfig();\n  const queryClient = useQueryClient();\n  const genQueryKey = createMemo(() => queryKeyUseReactions(propsProvider()));\n\n  const query = createQuery(() => ({\n    queryKey: genQueryKey(),\n    queryFn: eventsQuery<ReturnType<typeof queryKeyUseReactions>>({\n      taskProvider: ([, currentProps]) => {\n        if (currentProps == null) return null;\n        const { eventId: mentionedEventId } = currentProps;\n        return new BatchedEventsTask({ type: 'Reactions', mentionedEventId });\n      },\n      queryClient,\n    }),\n    staleTime: 1 * 60 * 1000, // 1 min\n    gcTime: 4 * 60 * 60 * 1000, // 4 hour\n    refetchInterval: 1 * 60 * 1000, // 1 min\n  }));\n\n  const reactions = () => {\n    const data = query.data ?? [];\n    return data.filter((ev) => !shouldMuteEvent(ev));\n  };\n\n  const reactionsGrouped = () => {\n    const result = new Map<string, NostrEvent[]>();\n    reactions().forEach((event) => {\n      const key = reaction(event).isCustomEmoji()\n        ? `${event.content}${reaction(event).getUrl() ?? ''}`\n        : event.content;\n      const events = result.get(key) ?? [];\n      events.push(event);\n      result.set(key, events);\n    });\n    return result;\n  };\n\n  const isReactedBy = (pubkey: string): boolean =>\n    reactions().findIndex((event) => event.pubkey === pubkey) !== -1;\n\n  const isReactedByWithEmoji = (pubkey: string): boolean =>\n    reactions().findIndex((event) => event.pubkey === pubkey && EmojiRegex.test(event.content)) !==\n    -1;\n\n  return {\n    reactions,\n    reactionsGrouped,\n    isReactedBy,\n    isReactedByWithEmoji,\n    query,\n  };\n};\n\nexport default useReactions;\n","import { createMemo } from 'solid-js';\n\nimport { useQueryClient } from '@tanstack/solid-query';\n\nimport createReaction from '@/nostr/builder/createReaction';\nimport usePublishEventMutation from '@/nostr/mutation/usePublishEventMutation';\nimport { queryKeyUseReactions } from '@/nostr/useReactions';\n\ntype UseReactionMutationProps = {\n  eventId: string;\n};\n\nconst useReactionMutation = (propsProvider: () => UseReactionMutationProps) => {\n  const queryClient = useQueryClient();\n  const props = createMemo(propsProvider);\n\n  const { mutation, wrapMutate } = usePublishEventMutation(() => ({\n    mutationKey: ['useReactionMutation', props().eventId] as const,\n    onSuccess: () => {\n      const queryKey = queryKeyUseReactions({ eventId: props().eventId });\n      queryClient\n        .invalidateQueries({ queryKey })\n        .catch((err) => console.error('failed to invalidate reactions', err));\n    },\n  }));\n\n  const publishReaction = wrapMutate(createReaction);\n\n  return { mutation, publishReaction };\n};\n\nexport default useReactionMutation;\n","import * as Kind from 'nostr-tools/kinds';\nimport { type UnsignedEvent } from 'nostr-tools/pure';\n\nimport epoch from '@/utils/epoch';\n\nexport type CreateRepostParams = {\n  pubkey: string;\n  eventId: string;\n  kind: number;\n  notifyPubkey: string;\n};\n\nconst createRepost = ({\n  pubkey,\n  eventId,\n  kind,\n  notifyPubkey,\n}: CreateRepostParams): UnsignedEvent => {\n  const tags = [\n    ['e', eventId, ''],\n    ['p', notifyPubkey],\n  ];\n  if (kind !== 1) {\n    tags.push(['k', kind.toString()]);\n  }\n\n  return {\n    kind: kind === 1 ? Kind.Repost : Kind.GenericRepost,\n    pubkey,\n    created_at: epoch(),\n    tags,\n    content: '',\n  };\n};\n\nexport default createRepost;\n","import { createMemo } from 'solid-js';\n\nimport { createQuery, useQueryClient, type UseQueryResult } from '@tanstack/solid-query';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport useConfig from '@/core/useConfig';\nimport { eventsQuery } from '@/nostr/query';\nimport { BatchedEventsTask } from '@/nostr/useBatchedEvents';\n\nexport type UseRepostsProps = {\n  eventId: string;\n};\n\nexport type UseReposts = {\n  reposts: () => NostrEvent[];\n  isRepostedBy: (pubkey: string) => boolean;\n  query: UseQueryResult<NostrEvent[]>;\n};\n\nexport const queryKeyUseReposts = (props: UseRepostsProps) => ['useReposts', props] as const;\n\nconst useReposts = (propsProvider: () => UseRepostsProps): UseReposts => {\n  const { shouldMuteEvent } = useConfig();\n  const queryClient = useQueryClient();\n  const props = createMemo(propsProvider);\n  const genQueryKey = createMemo(() => queryKeyUseReposts(props()));\n\n  const query = createQuery(() => ({\n    queryKey: genQueryKey(),\n    queryFn: eventsQuery<ReturnType<typeof genQueryKey>>({\n      taskProvider: ([, currentProps]) => {\n        if (currentProps == null) return null;\n        const { eventId: mentionedEventId } = currentProps;\n        return new BatchedEventsTask({ type: 'Reposts', mentionedEventId });\n      },\n      queryClient,\n    }),\n    staleTime: 1 * 60 * 1000, // 1 min\n    gcTime: 4 * 60 * 60 * 1000, // 4 hour\n    refetchInterval: 1 * 60 * 1000, // 1 min\n  }));\n\n  const reposts = () => {\n    const data = query.data ?? [];\n    return data.filter((ev) => !shouldMuteEvent(ev));\n  };\n\n  const isRepostedBy = (pubkey: string): boolean =>\n    reposts().findIndex((event) => event.pubkey === pubkey) !== -1;\n\n  return { reposts, isRepostedBy, query };\n};\n\nexport default useReposts;\n","import { createMemo } from 'solid-js';\n\nimport { useQueryClient } from '@tanstack/solid-query';\n\nimport createRepost from '@/nostr/builder/createRepost';\nimport usePublishEventMutation from '@/nostr/mutation/usePublishEventMutation';\nimport { queryKeyUseReposts } from '@/nostr/useReposts';\n\ntype UseRepostMutationProps = {\n  eventId: string;\n};\n\nconst useRepostMutation = (propsProvider: () => UseRepostMutationProps) => {\n  const queryClient = useQueryClient();\n\n  const props = createMemo(propsProvider);\n\n  const { mutation, wrapMutate } = usePublishEventMutation(() => ({\n    mutationKey: ['useRepostMutation', props().eventId] as const,\n    onSuccess: () => {\n      const queryKey = queryKeyUseReposts({ eventId: props().eventId });\n      queryClient\n        .invalidateQueries({ queryKey })\n        .catch((err) => console.error('failed to invalidate repost', err));\n    },\n  }));\n\n  const publishRepost = wrapMutate(createRepost);\n\n  return { mutation, publishRepost };\n};\n\nexport default useRepostMutation;\n","const Prefixes = ['k', 'M', 'G', 'T', 'P'] as const;\n\nexport type SIPrefix = {\n  value: number;\n  prefix: (typeof Prefixes)[number] | null;\n};\n\nconst siPrefix = (\n  value: number,\n  options?: { precision?: number; minDigits?: number },\n): SIPrefix => {\n  const precision = options?.precision ?? 3;\n  if (precision <= 0) throw new Error(`precision is too small: ${precision}`);\n\n  const minDigits = options?.minDigits ?? 4;\n  const minValue = 10 ** (minDigits - 1);\n  if (value < minValue) return { value, prefix: null };\n\n  const divider = 10 ** (Math.floor(Math.log10(value) / 3) * 3);\n  const divided = value / divider;\n  let rounded = Math.round(divided * 10 ** precision) / 10 ** precision;\n  let index = Math.max(Math.floor(Math.log10(value) / 3) - 1, 0);\n  if (rounded >= 1000) {\n    rounded /= 1000;\n    index += 1;\n  }\n  if (index >= Prefixes.length) return { value, prefix: null };\n\n  return { value: rounded, prefix: Prefixes[index] };\n};\n\nexport const formatSiPrefix = (\n  inputValue: number,\n  options?: { digits?: number; minDigits?: number },\n): string => {\n  const { value, prefix } = siPrefix(inputValue, {\n    precision: 2,\n    minDigits: options?.minDigits ?? 5,\n  });\n  if (prefix == null) return `${inputValue}`;\n\n  const digits = options?.digits ?? 3;\n  const wholeNumberDigits = Math.floor(Math.log10(value)) + 1;\n  const precision = Math.max(digits - wholeNumberDigits, 0);\n  const rounded = Math.round(value * 10 ** precision) / 10 ** precision;\n\n  return `${rounded}${prefix}`;\n};\n\nexport default siPrefix;\n","import {\n  type JSX,\n  type Component,\n  Switch,\n  Match,\n  Show,\n  lazy,\n  batch,\n  createSignal,\n  createMemo,\n  For,\n} from 'solid-js';\n\nimport ArrowPathRoundedSquare from 'heroicons/24/outline/arrow-path-rounded-square.svg';\nimport Bolt from 'heroicons/24/outline/bolt.svg';\nimport ChatBubbleLeft from 'heroicons/24/outline/chat-bubble-left.svg';\nimport EllipsisHorizontal from 'heroicons/24/outline/ellipsis-horizontal.svg';\nimport HeartOutlined from 'heroicons/24/outline/heart.svg';\nimport Plus from 'heroicons/24/outline/plus.svg';\nimport HeartSolid from 'heroicons/24/solid/heart.svg';\nimport * as Kind from 'nostr-tools/kinds';\nimport { neventEncode } from 'nostr-tools/nip19';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport ReactionEmojiDisplay, { reactionTypesToEmojiTypes } from '@/components/ReactionEmojiDisplay';\nimport useEmojiPicker, { type EmojiData } from '@/components/useEmojiPicker';\nimport useEmojiPopup from '@/components/useEmojiPopup';\nimport useContextMenu from '@/components/utils/useContextMenu';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { reaction } from '@/nostr/event';\nimport { type ReactionTypes } from '@/nostr/event/Reaction';\nimport TextNote from '@/nostr/event/TextNote';\nimport useDeleteMutation from '@/nostr/mutation/useDeleteMutation';\nimport useReactionMutation from '@/nostr/mutation/useReactionMutation';\nimport useRepostMutation from '@/nostr/mutation/useRepostMutation';\nimport usePubkey from '@/nostr/usePubkey';\nimport useReactions from '@/nostr/useReactions';\nimport useReposts from '@/nostr/useReposts';\nimport ensureNonNull from '@/utils/ensureNonNull';\nimport { getErrorMessage } from '@/utils/error';\nimport { formatSiPrefix } from '@/utils/siPrefix';\n\nconst EventDebugModal = lazy(() => import('@/components/modal/EventDebugModal'));\nconst UserList = lazy(() => import('@/components/modal/UserList'));\n\nconst ZapRequestModal = lazy(() => import('@/components/modal/ZapRequestModal'));\n\nexport type ActionProps = {\n  event: NostrEvent;\n  onClickReply: () => void;\n};\n\nconst emojiDataToReactionTypes = (emoji: EmojiData): ReactionTypes => {\n  if (emoji.native != null) {\n    return { type: 'Emoji', content: emoji.native };\n  }\n  if (emoji.src != null) {\n    return {\n      type: 'CustomEmoji',\n      content: `:${emoji.id}:`,\n      shortcode: emoji.id,\n      url: emoji.src,\n    };\n  }\n  throw new Error('unknown emoji');\n};\n\nconst ReactionAction = (props: { event: NostrEvent }) => {\n  const { config } = useConfig();\n  const pubkey = usePubkey();\n\n  const [reacted, setReacted] = createSignal(false);\n\n  const { reactions, isReactedByWithEmoji, isReactedBy } = useReactions(() => ({\n    eventId: props.event.id,\n  }));\n\n  const isReactedByMe = createMemo(() => {\n    const p = pubkey();\n    return (p != null && isReactedBy(p)) || reacted();\n  });\n  const isReactedByMeWithEmoji = createMemo(() => {\n    const p = pubkey();\n    return p != null && isReactedByWithEmoji(p);\n  });\n\n  const { mutation: reactionMutation, publishReaction } = useReactionMutation(() => ({\n    eventId: props.event.id,\n  }));\n\n  const doReaction = (reactionTypes?: ReactionTypes) => {\n    if (isReactedByMe()) {\n      // TODO remove reaction\n      return;\n    }\n    if (reactionMutation.isPending) {\n      return;\n    }\n\n    ensureNonNull([pubkey(), props.event.id] as const)(([pubkeyNonNull, eventIdNonNull]) => {\n      publishReaction({\n        pubkey: pubkeyNonNull,\n        reactionTypes: reactionTypes ?? { type: 'LikeDislike', content: '+' },\n        eventId: eventIdNonNull,\n        kind: props.event.kind,\n        notifyPubkey: props.event.pubkey,\n      })\n        .then(() => {\n          setReacted(true);\n        })\n        .catch((err) => {\n          window.alert(getErrorMessage(err));\n        });\n    });\n  };\n\n  const handleReaction: JSX.EventHandler<HTMLButtonElement, MouseEvent> = (ev) => {\n    ev.stopPropagation();\n    doReaction();\n  };\n\n  const handleEmojiSelect = (emoji: EmojiData) => {\n    doReaction(emojiDataToReactionTypes(emoji));\n  };\n\n  const emojiPickerPopup = useEmojiPicker(() => ({\n    onEmojiSelect: handleEmojiSelect,\n  }));\n\n  return (\n    <>\n      <div\n        class=\"flex shrink-0 items-center gap-1\"\n        classList={{\n          'text-fg-tertiary': !isReactedByMe() || isReactedByMeWithEmoji(),\n          'hover:text-r-reaction': !isReactedByMe() || isReactedByMeWithEmoji(),\n          'text-r-reaction':\n            (isReactedByMe() && !isReactedByMeWithEmoji()) || reactionMutation.isPending,\n        }}\n      >\n        <button class=\"size-4\" onClick={handleReaction} disabled={reactionMutation.isPending}>\n          <Show when={isReactedByMe() && !isReactedByMeWithEmoji()} fallback={<HeartOutlined />}>\n            <HeartSolid />\n          </Show>\n        </button>\n        <Show when={!config().hideCount && !config().showEmojiReaction && reactions().length > 0}>\n          <div class=\"text-sm text-fg-tertiary\">\n            {formatSiPrefix(reactions().length, { minDigits: 4 })}\n          </div>\n        </Show>\n      </div>\n      <Show when={config().useEmojiReaction}>\n        <div\n          class=\"flex shrink-0 items-center gap-1\"\n          classList={{\n            'text-fg-tertiary': !isReactedByMe() || !isReactedByMeWithEmoji(),\n            'hover:text-r-reaction': !isReactedByMe() || !isReactedByMeWithEmoji(),\n            'text-r-reaction':\n              (isReactedByMe() && isReactedByMeWithEmoji()) || reactionMutation.isPending,\n          }}\n        >\n          <button\n            ref={emojiPickerPopup.targetRef}\n            class=\"size-4\"\n            onClick={() => emojiPickerPopup.open()}\n          >\n            <Plus />\n          </button>\n          {emojiPickerPopup.popup()}\n        </div>\n      </Show>\n    </>\n  );\n};\n\nconst RepostAction = (props: { event: NostrEvent }) => {\n  const { config } = useConfig();\n  const pubkey = usePubkey();\n\n  const [reposted, setReposted] = createSignal(false);\n\n  const { reposts, isRepostedBy } = useReposts(() => ({\n    eventId: props.event.id,\n  }));\n\n  const isRepostedByMe = createMemo(() => {\n    const p = pubkey();\n    return (p != null && isRepostedBy(p)) || reposted();\n  });\n\n  const { mutation: repostMutation, publishRepost } = useRepostMutation(() => ({\n    eventId: props.event.id,\n  }));\n\n  const handleRepost: JSX.EventHandler<HTMLButtonElement, MouseEvent> = (ev) => {\n    ev.stopPropagation();\n\n    if (isRepostedByMe()) {\n      // TODO remove reaction\n      return;\n    }\n    if (repostMutation.isPending) {\n      return;\n    }\n\n    const p = pubkey();\n    const { id } = props.event;\n    if (p != null && id != null) {\n      publishRepost({\n        pubkey: p,\n        eventId: id,\n        kind: props.event.kind,\n        notifyPubkey: props.event.pubkey,\n      })\n        .then(() => {\n          setReposted(true);\n        })\n        .catch((err) => {\n          window.alert(getErrorMessage(err));\n        });\n    }\n  };\n\n  return (\n    <div\n      class=\"flex shrink-0 items-center gap-1\"\n      classList={{\n        'text-fg-tertiary': !isRepostedByMe(),\n        'hover:text-r-repost': !isRepostedByMe(),\n        'text-r-repost': isRepostedByMe() || repostMutation.isPending,\n      }}\n    >\n      <button onClick={handleRepost} disabled={repostMutation.isPending}>\n        <span class=\"flex size-4\">\n          <ArrowPathRoundedSquare />\n        </span>\n      </button>\n      <Show when={!config().hideCount && reposts().length > 0}>\n        <div class=\"text-sm text-fg-tertiary\">\n          {formatSiPrefix(reposts().length, { minDigits: 4 })}\n        </div>\n      </Show>\n    </div>\n  );\n};\n\nconst ReactionsModal: Component<{ event: NostrEvent; onClose: () => void }> = (props) => {\n  const { reactions } = useReactions(() => ({\n    eventId: props.event.id,\n  }));\n\n  return (\n    <UserList\n      data={reactions()}\n      pubkeyExtractor={(ev) => ev.pubkey}\n      renderInfo={(ev) => (\n        <div class=\"h-4 max-w-8 min-w-4\">\n          <ReactionEmojiDisplay reactionTypes={reaction(ev).toReactionTypes()} />\n        </div>\n      )}\n      onClose={props.onClose}\n    />\n  );\n};\n\nconst RepostsModal: Component<{ event: NostrEvent; onClose: () => void }> = (props) => {\n  const { reposts } = useReposts(() => ({\n    eventId: props.event.id,\n  }));\n\n  return <UserList data={reposts()} pubkeyExtractor={(ev) => ev.pubkey} onClose={props.onClose} />;\n};\n\nconst EmojiReactions: Component<{ event: NostrEvent }> = (props) => {\n  const { config } = useConfig();\n  const pubkey = usePubkey();\n\n  const [reacted, setReacted] = createSignal(false);\n\n  const { reactions, reactionsGrouped, isReactedBy } = useReactions(() => ({\n    eventId: props.event.id,\n  }));\n\n  const { mutation: reactionMutation, publishReaction } = useReactionMutation(() => ({\n    eventId: props.event.id,\n  }));\n\n  const isReactedByMe = () => {\n    const p = pubkey();\n    if (p == null) return reacted();\n    return reacted() || isReactedBy(p);\n  };\n\n  const doReaction = (reactionTypes?: ReactionTypes) => {\n    if (isReactedByMe()) {\n      // TODO remove reaction\n      return;\n    }\n    if (reactionMutation.isPending) {\n      return;\n    }\n\n    ensureNonNull([pubkey(), props.event.id] as const)(([pubkeyNonNull, eventIdNonNull]) => {\n      publishReaction({\n        pubkey: pubkeyNonNull,\n        reactionTypes: reactionTypes ?? { type: 'LikeDislike', content: '+' },\n        eventId: eventIdNonNull,\n        kind: props.event.kind,\n        notifyPubkey: props.event.pubkey,\n      })\n        .then(() => {\n          setReacted(true);\n        })\n        .catch((err) => {\n          window.alert(getErrorMessage(err));\n        });\n    });\n  };\n\n  return (\n    <Show when={config().showEmojiReaction && reactions().length > 0}>\n      <div class=\"scrollbar flex gap-2 overflow-x-auto py-1\">\n        <For each={[...reactionsGrouped().entries()]}>\n          {([, events]) => {\n            const isReactedByMeWithThisContent =\n              events.findIndex((ev) => ev.pubkey === pubkey()) >= 0;\n            const reactionTypes = reaction(events[0]).toReactionTypes();\n            const emojiTypes = reactionTypesToEmojiTypes(reactionTypes);\n\n            const emojiPopup = useEmojiPopup(() =>\n              ensureNonNull([emojiTypes] as const)(([emoji]) => ({\n                emoji,\n                onClick: () => {\n                  if (isReactedByMe()) return;\n                  if (reactionMutation.isPending) return;\n                  doReaction(reactionTypes);\n                },\n              })),\n            );\n\n            return (\n              <button\n                ref={(el) => emojiPopup.emojiRef(el)}\n                class=\"webkit-touch-callout-none flex h-6 touch-pan-x items-center rounded-sm border border-border px-1 select-none\"\n                classList={{\n                  'text-fg-tertiary': !isReactedByMeWithThisContent,\n                  'hover:bg-r-reaction/10': !isReactedByMeWithThisContent,\n                  'hover:border-r-reaction/40': !isReactedByMeWithThisContent,\n                  'bg-r-reaction/10': isReactedByMeWithThisContent,\n                  'border-r-reaction/40': isReactedByMeWithThisContent,\n                  'text-r-reaction': isReactedByMeWithThisContent,\n                }}\n                type=\"button\"\n              >\n                <span class=\"flex h-5 max-w-[128px] min-w-5 items-center justify-center\">\n                  <ReactionEmojiDisplay reactionTypes={reactionTypes} />\n                </span>\n                <Show when={!config().hideCount}>\n                  <span class=\"ml-1 text-sm\">{events.length}</span>\n                </Show>\n                {emojiPopup.popup()}\n              </button>\n            );\n          }}\n        </For>\n      </div>\n    </Show>\n  );\n};\n\nconst Actions: Component<ActionProps> = (props) => {\n  const i18n = useTranslation();\n  const { addMutedThread } = useConfig();\n  const pubkey = usePubkey();\n\n  const [modal, setModal] = createSignal<\n    'EventDebugModal' | 'Reactions' | 'Reposts' | 'ZapRequest' | null\n  >(null);\n\n  const closeModal = () => setModal(null);\n\n  const { mutation: deleteMutation, deleteEvent } = useDeleteMutation(() => ({\n    id: props.event.id,\n  }));\n\n  const muteThread = () => {\n    batch(() => {\n      addMutedThread(props.event.id);\n\n      if (props.event.kind === Kind.ShortTextNote) {\n        const rootEventId = new TextNote(props.event).rootEvent()?.id;\n        if (rootEventId != null) {\n          addMutedThread(rootEventId);\n        }\n      }\n    });\n  };\n\n  const otherActionsPopup = useContextMenu(() => ({\n    menu: [\n      {\n        content: i18n.t('post.copyEventId'),\n        onSelect: () => {\n          navigator.clipboard\n            .writeText(neventEncode({ id: props.event.id }))\n            .catch((err) => window.alert(err));\n        },\n      },\n      {\n        content: i18n.t('post.showJSON'),\n        onSelect: () => {\n          setModal('EventDebugModal');\n        },\n      },\n      {\n        content: i18n.t('post.muteThread'),\n        onSelect: () => muteThread(),\n      },\n      {\n        content: i18n.t('post.showReposts'),\n        onSelect: () => {\n          setModal('Reposts');\n        },\n      },\n      {\n        content: i18n.t('post.showReactions'),\n        onSelect: () => {\n          setModal('Reactions');\n        },\n      },\n      {\n        when: () => props.event.pubkey === pubkey(),\n        content: <span class=\"text-red-500\">{i18n.t('post.deletePost')}</span>,\n        onSelect: () => {\n          const p = pubkey();\n          if (p == null) return;\n          if (deleteMutation.isPending) return;\n\n          if (!window.confirm(i18n.t('post.confirmDelete'))) return;\n\n          deleteEvent({\n            pubkey: p,\n            identifier: props.event.id,\n            kind: props.event.kind,\n          })\n            .then((results) => {\n              if (results.failed.length === 0) {\n                window.alert(i18n.t('post.deletedSuccessfully'));\n              } else if (results.succeeded.length > 0) {\n                window.alert(\n                  i18n.t('post.failedToDeletePartially', { count: results.failed.length }),\n                );\n              } else {\n                window.alert(i18n.t('post.failedToDelete'));\n              }\n            })\n            .catch((err) => {\n              window.alert(getErrorMessage(err));\n            });\n        },\n      },\n    ],\n  }));\n\n  return (\n    <>\n      <EmojiReactions event={props.event} />\n      <div class=\"actions flex w-64 max-w-full items-center justify-between pt-1\">\n        <button\n          class=\"shrink-0 text-fg-tertiary hover:text-fg-tertiary/70\"\n          onClick={(ev) => {\n            ev.stopPropagation();\n            props.onClickReply();\n          }}\n        >\n          <span class=\"flex size-4\">\n            <ChatBubbleLeft />\n          </span>\n        </button>\n        <RepostAction event={props.event} />\n        <ReactionAction event={props.event} />\n        <button type=\"button\" onClick={() => setModal('ZapRequest')}>\n          <span class=\"flex size-4 text-fg-tertiary hover:text-r-zap\">\n            <Bolt />\n          </span>\n        </button>\n        <button\n          ref={otherActionsPopup.targetRef}\n          type=\"button\"\n          class=\"size-4 shrink-0 text-fg-tertiary hover:text-fg-tertiary/70\"\n          onClick={() => otherActionsPopup.open()}\n        >\n          <EllipsisHorizontal />\n        </button>\n        {otherActionsPopup.popup()}\n      </div>\n      <Switch>\n        <Match when={modal() === 'EventDebugModal'}>\n          <EventDebugModal event={props.event} onClose={closeModal} />\n        </Match>\n        <Match when={modal() === 'Reactions'}>\n          <ReactionsModal event={props.event} onClose={closeModal} />\n        </Match>\n        <Match when={modal() === 'Reposts'}>\n          <RepostsModal event={props.event} onClose={closeModal} />\n        </Match>\n        <Match when={modal() === 'ZapRequest'}>\n          <ZapRequestModal zapTo={{ event: props.event }} onClose={closeModal} />\n        </Match>\n      </Switch>\n    </>\n  );\n};\n\nexport default Actions;\n","import { createSignal, type Component, type JSX, Show } from 'solid-js';\n\nimport ExclamationTriangle from 'heroicons/24/outline/exclamation-triangle.svg';\n\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { type ContentWarning } from '@/nostr/event/TextNoteLike';\n\nexport type ContentWarningDisplayProps = {\n  contentWarning: ContentWarning;\n  children: JSX.Element;\n};\n\nconst ContentWarningDisplay: Component<ContentWarningDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const [showContentWarning, setShowContentWarning] = createSignal(false);\n\n  return (\n    <Show\n      when={!props.contentWarning.contentWarning || showContentWarning()}\n      fallback={\n        <button\n          class=\"mt-2 flex w-full flex-col items-center rounded-sm border border-border p-2 text-center text-xs text-fg-secondary\"\n          onClick={() => setShowContentWarning(true)}\n        >\n          <span class=\"inline-block size-4\">\n            <ExclamationTriangle />\n          </span>\n          <span>{i18n.t('post.contentWarning.show')}</span>\n          <Show when={props.contentWarning.reason != null}>\n            <span>\n              {i18n.t('post.contentWarning.reason')}: {props.contentWarning.reason}\n            </span>\n          </Show>\n        </button>\n      }\n    >\n      <div>{props.children}</div>\n      <Show when={props.contentWarning.contentWarning}>\n        <button\n          class=\"text-xs text-fg-secondary hover:text-fg-secondary/70\"\n          onClick={() => setShowContentWarning(false)}\n        >\n          {i18n.t('post.contentWarning.hide')}\n        </button>\n      </Show>\n    </Show>\n  );\n};\n\nexport default ContentWarningDisplay;\n","import { Show } from 'solid-js';\n\nimport useProfile from '@/nostr/useProfile';\nimport npubEncodeFallback from '@/utils/npubEncodeFallback';\n\nexport type GeneralUserMentionDisplayProps = {\n  pubkey: string;\n};\n\nconst GeneralUserMentionDisplay = (props: GeneralUserMentionDisplayProps) => {\n  const { profile } = useProfile(() => ({\n    pubkey: props.pubkey,\n  }));\n\n  return (\n    <Show\n      when={(profile()?.name?.length ?? 0) > 0}\n      fallback={`@${npubEncodeFallback(props.pubkey)}`}\n    >\n      @{profile()?.name ?? props.pubkey}\n    </Show>\n  );\n};\n\nexport default GeneralUserMentionDisplay;\n","import { type Component, type JSX, Show, createSignal, onCleanup, onMount } from 'solid-js';\n\nexport type LazyLoadProps = {\n  threshold?: number[] | number;\n  fallback?: JSX.Element;\n  children: () => JSX.Element;\n};\n\nconst LazyLoad: Component<LazyLoadProps> = (props) => {\n  let containerRef: HTMLDivElement | undefined;\n\n  const [visible, setVisible] = createSignal<boolean>(false);\n\n  onMount(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            setVisible(true);\n            observer.disconnect();\n          }\n        });\n      },\n      {\n        threshold: props.threshold ?? 0,\n      },\n    );\n    if (containerRef != null) {\n      observer.observe(containerRef);\n    }\n\n    onCleanup(() => {\n      observer.disconnect();\n    });\n  });\n\n  return (\n    <Show when={visible()} fallback={<div ref={containerRef}>{props.fallback}</div>} keyed>\n      {/* eslint-disable-next-line @typescript-eslint/no-unused-vars */}\n      {(_) => props.children()}\n    </Show>\n  );\n};\n\nexport default LazyLoad;\n","import { type Component, type JSX, createSignal, Show } from 'solid-js';\n\nimport { Dynamic } from 'solid-js/web';\n\nimport LazyLoad from '@/components/utils/LazyLoad';\n\ntype MediaDisplayProps = {\n  initialHidden: boolean;\n  children: (props: { error: () => void }) => JSX.Element;\n  placeholder: JSX.Element;\n  fallback: JSX.Element;\n  showButtonText: string;\n};\n\nconst MediaDisplay: Component<MediaDisplayProps> = (props) => {\n  const [hidden, setHidden] = createSignal(props.initialHidden);\n  const [isError, setIsError] = createSignal(false);\n\n  return (\n    <Show\n      when={!hidden()}\n      fallback={\n        <button\n          class=\"rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm\"\n          onClick={() => setHidden(false)}\n        >\n          {props.showButtonText}\n        </button>\n      }\n    >\n      <LazyLoad fallback={props.placeholder}>\n        {() => (\n          <Show when={!isError()} fallback={props.fallback}>\n            <Dynamic component={props.children} error={() => setIsError(true)} />\n          </Show>\n        )}\n      </LazyLoad>\n    </Show>\n  );\n};\n\nexport default MediaDisplay;\n","import { type Component } from 'solid-js';\n\nimport MediaDisplay from '@/components/event/textNote/MediaDisplay';\nimport SafeLink from '@/components/utils/SafeLink';\nimport { useTranslation } from '@/i18n/useTranslation';\n\ntype AudioDisplayProps = {\n  url: string;\n  initialHidden: boolean;\n};\n\nconst AudioDisplay: Component<AudioDisplayProps> = (props) => {\n  const i18n = useTranslation();\n\n  return (\n    <MediaDisplay\n      initialHidden={props.initialHidden}\n      placeholder={\n        <div class=\"max-w-full\">\n          <SafeLink class=\"text-link underline\" href={props.url} />\n        </div>\n      }\n      fallback={<SafeLink class=\"text-link underline\" href={props.url} />}\n      showButtonText={i18n.t('post.showAudio')}\n    >\n      {(mediaProps) => (\n        // eslint-disable-next-line jsx-a11y/media-has-caption\n        <audio src={props.url} controls onError={mediaProps.error}>\n          <a href={props.url}>{i18n.t('post.download')}</a>\n        </audio>\n      )}\n    </MediaDisplay>\n  );\n};\n\nexport default AudioDisplay;\n","import { type Component } from 'solid-js';\n\nimport MediaDisplay from '@/components/event/textNote/MediaDisplay';\nimport SafeLink from '@/components/utils/SafeLink';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { thumbnailUrl } from '@/utils/url';\n\ntype ImageDisplayProps = {\n  url: string;\n  initialHidden: boolean;\n};\n\nconst ImageDisplay: Component<ImageDisplayProps> = (props) => {\n  const i18n = useTranslation();\n\n  return (\n    <MediaDisplay\n      initialHidden={props.initialHidden}\n      placeholder={\n        <div class=\"aspect-video max-w-full\">\n          <SafeLink class=\"text-link underline\" href={props.url} />\n        </div>\n      }\n      fallback={<SafeLink class=\"text-link underline\" href={props.url} />}\n      showButtonText={i18n.t('post.showImage')}\n    >\n      {(mediaProps) => (\n        <SafeLink class=\"my-2 block\" href={props.url}>\n          <img\n            class=\"max-h-64 max-w-full rounded-sm object-contain shadow-sm hover:shadow-md\"\n            src={thumbnailUrl(props.url)}\n            alt={props.url}\n            onError={mediaProps.error}\n          />\n        </SafeLink>\n      )}\n    </MediaDisplay>\n  );\n};\n\nexport default ImageDisplay;\n","import { Show } from 'solid-js';\n\nimport * as Kind from 'nostr-tools/kinds';\n\nimport EventDisplayById from '@/components/event/EventDisplayById';\nimport EventLink from '@/components/EventLink';\nimport LazyLoad from '@/components/utils/LazyLoad';\nimport { type MentionedEvent } from '@/nostr/parseTextNote';\n\nexport type MentionedEventDisplayProps = {\n  mentionedEvent: MentionedEvent;\n};\n\nconst MentionedEventDisplay = (props: MentionedEventDisplayProps) => (\n  <Show\n    when={props.mentionedEvent.marker != null && props.mentionedEvent.marker.length > 0}\n    fallback={<EventLink eventId={props.mentionedEvent.eventId} />}\n  >\n    <div class=\"my-1 rounded-sm border p-1\">\n      <LazyLoad>\n        {() => (\n          <EventDisplayById\n            eventId={props.mentionedEvent.eventId}\n            embedding={false}\n            actions={false}\n            ensureKinds={[Kind.ShortTextNote]}\n          />\n        )}\n      </LazyLoad>\n    </div>\n  </Show>\n);\n\nexport default MentionedEventDisplay;\n","import GeneralUserMentionDisplay from '@/components/event/textNote/GeneralUserMentionDisplay';\nimport useModalState from '@/hooks/useModalState';\n\nexport type MentionedUserDisplayProps = {\n  pubkey: string;\n};\n\nconst MentionedUserDisplay = (props: MentionedUserDisplayProps) => {\n  const { showProfile } = useModalState();\n\n  const handleClick = () => {\n    showProfile(props.pubkey);\n  };\n  return (\n    <button class=\"inline text-link underline select-text\" onClick={handleClick}>\n      <GeneralUserMentionDisplay pubkey={props.pubkey} />\n    </button>\n  );\n};\n\nexport default MentionedUserDisplay;\n","import { createQuery } from '@tanstack/solid-query';\n\nimport { isAbsoluteUrl } from '@/utils/url';\n\nconst directAccessHosts = ['www3.nhk.or.jp'];\n\nexport type OgpContent = {\n  url: string;\n  title: string;\n  description: string;\n  image: string;\n};\n\nexport const getCharset = (source: Uint8Array<ArrayBuffer>): string | null => {\n  // https://www.w3.org/International/questions/qa-html-encoding-declarations.ja\n  const content = new TextDecoder('US-ASCII').decode(source.slice(0, 1024));\n\n  const metaCharsetMatch = content.match(/<meta\\s+charset=\"([-A-Za-z0-9_]+)\"/i);\n  if (metaCharsetMatch != null) {\n    return metaCharsetMatch[1].toLowerCase();\n  }\n\n  const metaContentTypeMatch = content.match(\n    /<meta\\s+http-equiv=\"Content-Type\"\\s*content=\"text\\/html;\\s*charset=([-A-Za-z0-9_]+)\"/i,\n  );\n  if (metaContentTypeMatch != null) {\n    return metaContentTypeMatch[1].toLowerCase();\n  }\n\n  return null;\n};\n\n// https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder/decode\nconst supportedEncodings = new Set(['utf-8', 'shift_jis', 'shift-jis', 'euc-jp', 'iso-2022-jp']);\n\nexport const fixEncoding = (source: Uint8Array<ArrayBuffer>): string => {\n  try {\n    const charset = getCharset(source) ?? 'utf-8';\n    if (!supportedEncodings.has(charset)) {\n      throw new Error(`Unsupported encodings: ${charset}`);\n    }\n    const decoder = new TextDecoder(charset);\n    return decoder.decode(source);\n  } catch (e) {\n    throw new Error('Failed to convert charset', { cause: e });\n  }\n};\n\nexport const parseOgpFromDOM = (doc: Document, urlString: string): OgpContent | null => {\n  const props: { [property: string]: string } = {};\n\n  Array.from(doc.head.querySelectorAll('meta')).forEach((m) => {\n    const property = m.getAttribute('property') || m.getAttribute('name');\n    const content = m.getAttribute('content');\n    if (property != null && content != null) {\n      props[property] = content;\n    }\n  });\n\n  // Required\n  const image = props['og:image'] || props['twitter:image'];\n  const title = props['og:title'] || props['twitter:title'];\n  const url = props['og:url'] || urlString;\n  // Optional\n  const description = props['og:description'] || props['twitter:description'] || '';\n\n  if (!(image && title && url)) return null;\n  if (!(isAbsoluteUrl(image) && isAbsoluteUrl(url))) return null;\n\n  return { title, description, image, url } satisfies OgpContent;\n};\n\nexport const parseOgp = (text: string, urlString: string): OgpContent | null => {\n  const doc = new DOMParser().parseFromString(text, 'text/html');\n  return parseOgpFromDOM(doc, urlString);\n};\n\nexport const isOgpUrl = (urlString: string): boolean => {\n  const url = new URL(urlString);\n  return url.protocol === 'https:';\n};\n\nexport const shouldAccessDirectly = (urlString: string): boolean => {\n  const url = new URL(urlString);\n  return directAccessHosts.includes(url.hostname);\n};\n\nexport const buildUrl = (urlString: string): string => {\n  if (shouldAccessDirectly(urlString)) return urlString;\n  const url = new URL('https://corsproxy.io/');\n  url.search = new URLSearchParams({ url: urlString }).toString();\n  return url.toString();\n};\n\nexport const fetchOgpContent = async (urlString: string): Promise<OgpContent | null> => {\n  try {\n    if (!isOgpUrl(urlString)) return null;\n\n    const url = buildUrl(urlString);\n\n    const res = await fetch(url, {\n      mode: 'cors',\n      headers: { Accept: 'text/html' },\n      credentials: 'omit',\n    });\n    const arrayBuffer = await res.arrayBuffer();\n    const encodedContent = fixEncoding(new Uint8Array(arrayBuffer));\n    return parseOgp(encodedContent, urlString);\n  } catch (err) {\n    console.error(`failed to fetch ogp for ${urlString}`, err);\n    return null;\n  }\n};\n\nexport type UseOgpProps = {\n  url: string;\n};\n\nexport const useOgp = (propsProvider: () => UseOgpProps) => {\n  const genQueryKey = () => ['useOgp', propsProvider().url] as const;\n\n  const query = createQuery(() => ({\n    queryKey: genQueryKey(),\n    queryFn: ({ queryKey: [, url] }) => fetchOgpContent(url),\n    staleTime: 4 * 60 * 60 * 1000, // 4 hour\n    gcTime: 4 * 60 * 60 * 1000, // 4 hour\n    refetchOnWindowFocus: false,\n    refetchOnMount: false,\n  }));\n\n  const ogp = () => query.data;\n\n  return { query, ogp };\n};\n","import {\n  type Component,\n  type JSX,\n  Switch,\n  Match,\n  createSignal,\n  createEffect,\n  Show,\n} from 'solid-js';\n\nimport LazyLoad from '@/components/utils/LazyLoad';\nimport SafeLink from '@/components/utils/SafeLink';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { useOgp, isOgpUrl } from '@/utils/ogp';\nimport { isTwitterUrl, parseYouTubeVideoUrl } from '@/utils/url';\n\ntype PreviewedLinkProps = {\n  url: string;\n  initialHidden: boolean;\n  children?: JSX.Element;\n};\n\nconst twitterUrl = (urlString: string): string => {\n  try {\n    const url = new URL(urlString);\n    url.host = 'twitter.com';\n    return url.href;\n  } catch {\n    return urlString;\n  }\n};\n\nconst youtubeUrl = (videoId: string): string => {\n  const iframeUrl = new URL(`https://www.youtube-nocookie.com/embed/`);\n  iframeUrl.pathname += videoId;\n  iframeUrl.searchParams.set('origin', window.location.origin);\n  return iframeUrl.href;\n};\n\nconst hasTwttr = () => window.twttr != null;\n\nconst TwitterEmbed: Component<{ url: string }> = (props) => {\n  let twitterRef: HTMLQuoteElement | undefined;\n\n  const { getColorTheme } = useConfig();\n\n  createEffect(() => {\n    if (isTwitterUrl(props.url)) {\n      window.twttr?.widgets?.load(twitterRef);\n    }\n  });\n\n  const dataTheme = () => {\n    const colorTheme = getColorTheme();\n    if (colorTheme.brightness === 'dark') {\n      return 'dark';\n    }\n    return 'light';\n  };\n\n  return (\n    <>\n      <SafeLink class=\"text-link underline\" href={props.url} />\n      <blockquote ref={twitterRef} class=\"twitter-tweet\" data-theme={dataTheme()}>\n        <a\n          class=\"text-link underline\"\n          href={twitterUrl(props.url)}\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n        >\n          {''}\n        </a>\n      </blockquote>\n    </>\n  );\n};\n\nconst OgpEmbed: Component<{ class?: string; url: string }> = (props) => {\n  const { ogp } = useOgp(() => ({\n    url: props.url,\n  }));\n\n  return (\n    <Show when={ogp()} fallback={<SafeLink class=\"text-link underline\" href={props.url} />} keyed>\n      {(ogpProps) => (\n        <>\n          <SafeLink class=\"text-link underline\" href={props.url} />\n          <SafeLink href={props.url}>\n            <div class=\"my-2 rounded-lg border border-border transition-colors hover:bg-bg-tertiary\">\n              <div class=\"overflow-hidden rounded-t-lg\">\n                <img\n                  alt={ogpProps.title}\n                  class=\"max-h-64 w-full object-cover shadow-sm\"\n                  src={ogpProps.image}\n                />\n              </div>\n              <div class=\"mb-1 overflow-hidden p-1\">\n                <div class=\"text-xs text-fg-secondary\">{new URL(ogpProps.url).host}</div>\n                <div class=\"text-sm\">{ogpProps.title}</div>\n                <div class=\"max-h-16 truncate text-xs break-all whitespace-normal text-fg-secondary\">\n                  {ogpProps.description}\n                </div>\n              </div>\n            </div>\n          </SafeLink>\n        </>\n      )}\n    </Show>\n  );\n};\n\ntype ClickToShowProps = {\n  initialHidden: boolean;\n  url: string;\n  children: JSX.Element;\n};\n\nconst ClickToShow: Component<ClickToShowProps> = (props) => {\n  const i18n = useTranslation();\n  const [hidden, setHidden] = createSignal(props.initialHidden);\n\n  return (\n    <Show\n      when={!hidden()}\n      fallback={\n        <>\n          <SafeLink class=\"text-link underline\" href={props.url} />\n          <div>\n            <button\n              class=\"flex flex-col items-center rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm\"\n              onClick={() => setHidden(false)}\n            >\n              {i18n.t('post.showPreview')}\n            </button>\n          </div>\n        </>\n      }\n    >\n      {props.children}\n    </Show>\n  );\n};\n\nconst PreviewedLink: Component<PreviewedLinkProps> = (props) => {\n  const { config } = useConfig();\n\n  return (\n    <Switch fallback={<SafeLink class=\"text-link underline\" href={props.url} />}>\n      <Match when={config().embedding.twitter && isTwitterUrl(props.url)}>\n        <Show\n          when={hasTwttr()}\n          fallback={<SafeLink class=\"text-link underline\" href={props.url} />}\n        >\n          <ClickToShow url={props.url} initialHidden={props.initialHidden}>\n            <LazyLoad>{() => <TwitterEmbed url={props.url} />}</LazyLoad>\n          </ClickToShow>\n        </Show>\n      </Match>\n      <Match when={config().embedding.youtube && parseYouTubeVideoUrl(props.url)} keyed>\n        {({ videoId }) => (\n          <ClickToShow url={props.url} initialHidden={props.initialHidden}>\n            <LazyLoad fallback={<SafeLink class=\"text-link underline\" href={props.url} />}>\n              {() => (\n                <>\n                  <SafeLink class=\"text-link underline\" href={props.url} />\n                  <div class=\"my-2 aspect-video w-full\">\n                    <iframe\n                      loading=\"lazy\"\n                      title=\"YouTube\"\n                      class=\"my-2 size-full\"\n                      src={youtubeUrl(videoId)}\n                      allowfullscreen\n                    />\n                  </div>\n                </>\n              )}\n            </LazyLoad>\n          </ClickToShow>\n        )}\n      </Match>\n      <Match when={config().embedding.ogp && isOgpUrl(props.url)}>\n        <ClickToShow url={props.url} initialHidden={props.initialHidden}>\n          <LazyLoad>{() => <OgpEmbed url={props.url} />}</LazyLoad>\n        </ClickToShow>\n      </Match>\n    </Switch>\n  );\n};\n\nexport default PreviewedLink;\n","import { type Component, createSignal, Show } from 'solid-js';\n\nimport LazyLoad from '@/components/utils/LazyLoad';\nimport SafeLink from '@/components/utils/SafeLink';\nimport { useTranslation } from '@/i18n/useTranslation';\n\ntype VideoDisplayProps = {\n  url: string;\n  initialHidden: boolean;\n};\n\nconst VideoDisplay: Component<VideoDisplayProps> = (props) => {\n  let videoRef: HTMLVideoElement | undefined;\n  const i18n = useTranslation();\n  const [hidden, setHidden] = createSignal(props.initialHidden);\n  const [error, setError] = createSignal(false);\n\n  return (\n    <Show\n      when={!hidden()}\n      fallback={\n        <button\n          class=\"rounded-sm bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow-sm\"\n          onClick={() => setHidden(false)}\n        >\n          {i18n.t('post.showVideo')}\n        </button>\n      }\n    >\n      <LazyLoad fallback={<div class=\"aspect-video max-w-full\" />}>\n        {() => (\n          <Show\n            when={!error()}\n            fallback={\n              <SafeLink class=\"text-link underline\" href={props.url}>\n                {props.url}\n              </SafeLink>\n            }\n          >\n            {/* eslint-disable-next-line jsx-a11y/media-has-caption */}\n            <video\n              ref={videoRef}\n              class=\"max-h-64 max-w-full rounded-sm object-contain shadow-sm\"\n              src={props.url}\n              onError={() => setError(true)}\n              controls\n            >\n              <SafeLink class=\"text-link underline\" href={props.url}>\n                {i18n.t('post.download')}\n              </SafeLink>\n            </video>\n          </Show>\n        )}\n      </LazyLoad>\n    </Show>\n  );\n};\n\nexport default VideoDisplay;\n","import { For } from 'solid-js';\n\nimport * as Kind from 'nostr-tools/kinds';\n\nimport EventDisplayById from '@/components/event/EventDisplayById';\n// import ParameterizedReplaceableEventDisplayById from '@/components/event/ParameterizedReplaceableEventDisplayById';\nimport AudioDisplay from '@/components/event/textNote/AudioDisplay';\nimport ImageDisplay from '@/components/event/textNote/ImageDisplay';\nimport MentionedEventDisplay from '@/components/event/textNote/MentionedEventDisplay';\nimport MentionedUserDisplay from '@/components/event/textNote/MentionedUserDisplay';\nimport PreviewedLink from '@/components/event/textNote/PreviewedLink';\nimport VideoDisplay from '@/components/event/textNote/VideoDisplay';\nimport EventLink from '@/components/EventLink';\nimport useEmojiPopup from '@/components/useEmojiPopup';\nimport { createRelaysColumn, createSearchColumn } from '@/core/column';\nimport useConfig from '@/core/useConfig';\nimport { useRequestCommand } from '@/hooks/useCommandBus';\nimport {\n  type ParsedTextNoteResolvedNode,\n  type ParsedTextNoteResolved,\n} from '@/nostr/parseTextNote';\nimport { isImageUrl, isVideoUrl, isAudioUrl, isWebSocketUrl } from '@/utils/url';\n\nexport type TextNoteContentDisplayProps = {\n  parsed: ParsedTextNoteResolved;\n  embedding: boolean;\n  initialHidden?: boolean;\n};\n\nconst TextNoteContentDisplay = (props: TextNoteContentDisplayProps) => {\n  const { config, saveColumn } = useConfig();\n\n  const request = useRequestCommand();\n\n  const addHashTagColumn = (query: string) => {\n    saveColumn(createSearchColumn({ query }));\n    request({ command: 'moveToLastColumn' }).catch((err) => console.error(err));\n  };\n\n  const addRelayColumn = (url: string) => {\n    saveColumn(createRelaysColumn({ name: url, relayUrls: [url] }));\n    request({ command: 'moveToLastColumn' }).catch((err) => console.error(err));\n  };\n\n  return (\n    <For each={props.parsed}>\n      {(item: ParsedTextNoteResolvedNode) => {\n        if (item.type === 'PlainText') {\n          return <span>{item.content}</span>;\n        }\n        if (item.type === 'URL') {\n          const initialHidden = () =>\n            !config().showMedia || !props.embedding || (props.initialHidden ?? false);\n\n          if (isImageUrl(item.content)) {\n            return <ImageDisplay url={item.content} initialHidden={initialHidden()} />;\n          }\n          if (isVideoUrl(item.content)) {\n            return <VideoDisplay url={item.content} initialHidden={initialHidden()} />;\n          }\n          if (isAudioUrl(item.content)) {\n            return <AudioDisplay url={item.content} initialHidden={initialHidden()} />;\n          }\n          if (isWebSocketUrl(item.content)) {\n            return (\n              <button\n                class=\"text-link underline select-text\"\n                onClick={() => addRelayColumn(item.content)}\n              >\n                {item.content}\n              </button>\n            );\n          }\n          return <PreviewedLink url={item.content} initialHidden={initialHidden()} />;\n        }\n        if (item.type === 'TagReferenceResolved') {\n          if (item.reference == null) {\n            return <span>{item.content}</span>;\n          }\n          if (item.reference.type === 'MentionedUser') {\n            return <MentionedUserDisplay pubkey={item.reference.pubkey} />;\n          }\n          if (item.reference.type === 'MentionedEvent') {\n            if (props.embedding) {\n              return <MentionedEventDisplay mentionedEvent={item.reference} />;\n            }\n            return <EventLink eventId={item.reference.eventId} />;\n          }\n        }\n        if (item.type === 'Bech32Entity') {\n          if (item.data.type === 'note' && props.embedding) {\n            return (\n              <div class=\"my-1 rounded-sm border border-border p-1\">\n                <EventDisplayById\n                  eventId={item.data.data}\n                  actions={false}\n                  embedding={false}\n                  ensureKinds={[Kind.ShortTextNote]}\n                />\n              </div>\n            );\n          }\n          if (item.data.type === 'nevent' && props.embedding) {\n            return (\n              <div class=\"my-1 rounded-sm border border-border p-1\">\n                <EventDisplayById eventId={item.data.data.id} actions={false} embedding={false} />\n              </div>\n            );\n          }\n          if (item.data.type === 'npub') {\n            return <MentionedUserDisplay pubkey={item.data.data} />;\n          }\n          if (item.data.type === 'nprofile') {\n            return <MentionedUserDisplay pubkey={item.data.data.pubkey} />;\n          }\n          return <span class=\"text-link underline\">{item.content}</span>;\n        }\n        if (item.type === 'HashTag') {\n          return (\n            <button\n              class=\"text-link underline select-text\"\n              onClick={() => addHashTagColumn(item.content)}\n            >\n              {item.content}\n            </button>\n          );\n        }\n        if (item.type === 'CustomEmojiResolved') {\n          const { url, shortcode, content } = item;\n          if (url == null) return <span>{item.content}</span>;\n          // const { imageRef, canvas } = useImageAnimation({ initialPlaying: false });\n          const { emojiRef, popup } = useEmojiPopup(() => ({\n            emoji: { type: 'CustomEmoji', url, shortcode },\n          }));\n\n          return (\n            <>\n              {popup()}\n              <img\n                ref={emojiRef}\n                class=\"inline-block h-8 max-w-32\"\n                src={url}\n                alt={content}\n                title={shortcode}\n              />\n            </>\n          );\n        }\n        console.error('Not all ParsedTextNoteNodes are covered', item);\n        return null;\n      }}\n    </For>\n  );\n};\n\nexport default TextNoteContentDisplay;\n","import { createSignal, onMount, onCleanup } from 'solid-js';\n\nimport throttle from 'lodash/throttle';\n\n// TODO Find a better way to solve this. Firefox on Windows can cause 2px gap.\nconst Offset = 2;\n\nconst ThrottleWaitMs = 200;\n\n/**\n * Detect overflow if the height of the target element content is bigger than\n * actual displayed height or window height.\n */\nconst useDetectOverflow = () => {\n  let elementRef: HTMLElement | undefined;\n  const [overflow, setOverflow] = createSignal(false);\n\n  const setElementRef = (el: HTMLElement) => {\n    elementRef = el;\n  };\n\n  const detectOverflow = throttle(() => {\n    if (elementRef != null) {\n      setOverflow(\n        elementRef.scrollHeight > elementRef.clientHeight + Offset ||\n          elementRef.scrollHeight > document.documentElement.clientHeight + Offset,\n      );\n    }\n  }, ThrottleWaitMs);\n\n  onMount(() => {\n    if (elementRef != null) {\n      detectOverflow();\n\n      const observer = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (entry.isIntersecting) {\n              detectOverflow();\n            }\n          });\n        },\n        {\n          threshold: [0, 0.25, 0.5, 0.75, 1],\n        },\n      );\n      observer.observe(elementRef);\n\n      const handleResize = () => detectOverflow();\n      window.addEventListener('resize', handleResize);\n\n      onCleanup(() => {\n        observer.disconnect();\n        window.removeEventListener('resize', handleResize);\n      });\n    }\n  });\n\n  return { overflow, elementRef: setElementRef };\n};\n\nexport default useDetectOverflow;\n","import { type Component, type JSX, Show, createSignal } from 'solid-js';\n\nimport LazyLoad from '@/components/utils/LazyLoad';\nimport useDetectOverflow from '@/hooks/useDetectOverflow';\nimport useFormatDate from '@/hooks/useFormatDate';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useProfile from '@/nostr/useProfile';\nimport npubEncodeFallback from '@/utils/npubEncodeFallback';\nimport { thumbnailUrl } from '@/utils/url';\n\nexport type PostProps = {\n  authorPubkey: string;\n  createdAt: Date;\n  content: JSX.Element;\n  actions?: JSX.Element;\n  footer?: JSX.Element;\n  onShowProfile?: () => void;\n  onShowEvent?: () => void;\n};\n\nconst Post: Component<PostProps> = (props) => {\n  const i18n = useTranslation();\n  const { overflow, elementRef } = useDetectOverflow();\n  const formatDate = useFormatDate();\n\n  const [showOverflow, setShowOverflow] = createSignal(false);\n  const createdAt = () => formatDate(props.createdAt);\n  const createdAtFull = () => props.createdAt.toLocaleString();\n\n  const { profile: author } = useProfile(() => ({\n    pubkey: props.authorPubkey,\n  }));\n\n  return (\n    <div class=\"post flex flex-col\">\n      <div class=\"flex w-full gap-1\">\n        <button\n          type=\"button\"\n          class=\"author-icon size-10 shrink-0 overflow-hidden rounded-sm\"\n          onClick={(ev) => {\n            ev.preventDefault();\n            props.onShowProfile?.();\n          }}\n        >\n          <Show when={author()?.picture} keyed>\n            {(url) => (\n              <LazyLoad>\n                {() => (\n                  <img\n                    src={thumbnailUrl(url, 'icon')}\n                    alt=\"icon\"\n                    referrerpolicy=\"no-referrer\"\n                    class=\"size-full object-cover\"\n                  />\n                )}\n              </LazyLoad>\n            )}\n          </Show>\n        </button>\n        <div class=\"min-w-0 flex-auto\">\n          <div class=\"flex justify-between gap-1 text-xs\">\n            <button\n              type=\"button\"\n              class=\"author flex min-w-0 truncate select-text hover:text-link\"\n              onClick={(ev) => {\n                ev.preventDefault();\n                props?.onShowProfile?.();\n              }}\n            >\n              <span class=\"author flex min-w-0 truncate hover:text-link\">\n                <Show when={(author()?.display_name?.length ?? 0) > 0}>\n                  <div class=\"author-name truncate pr-1 font-bold hover:underline\">\n                    {author()?.display_name}\n                  </div>\n                </Show>\n                <div class=\"author-username truncate text-fg-secondary\">\n                  <Show\n                    when={author()?.name != null}\n                    fallback={`@${npubEncodeFallback(props.authorPubkey)}`}\n                  >\n                    @{author()?.name}\n                  </Show>\n                  {/* TODO <Match when={author()?.nip05 != null}>@{author()?.nip05}</Match> */}\n                </div>\n              </span>\n            </button>\n            <div class=\"created-at shrink-0\">\n              <button\n                type=\"button\"\n                class=\"select-text hover:underline\"\n                onClick={(ev) => {\n                  ev.preventDefault();\n                  props.onShowEvent?.();\n                }}\n                title={createdAtFull()}\n              >\n                {createdAt()}\n              </button>\n            </div>\n          </div>\n          <div\n            ref={elementRef}\n            class=\"overflow-hidden\"\n            classList={{ 'max-h-screen': !showOverflow(), 'max-h-none': showOverflow() }}\n          >\n            {props.content}\n          </div>\n          <Show when={overflow()}>\n            <button\n              class=\"mt-2 w-full rounded-sm border border-border p-2 text-center text-xs text-fg-secondary shadow-sm hover:bg-bg-tertiary hover:shadow-sm\"\n              onClick={(ev) => {\n                ev.stopPropagation();\n                setShowOverflow((current) => !current);\n              }}\n            >\n              <Show when={!showOverflow()} fallback={i18n.t('post.hideOverflow')}>\n                {i18n.t('post.showOverflow')}\n              </Show>\n            </button>\n          </Show>\n          <div class=\"actions\">{props.actions}</div>\n        </div>\n      </div>\n      <Show when={props.footer}>{props.footer}</Show>\n    </div>\n  );\n};\n\nexport default Post;\n","import { createContext, useContext } from 'solid-js';\n\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\nimport { createStore } from 'solid-js/store';\n\nexport type TimelineContent = {\n  type: 'Replies';\n  event: NostrEvent;\n};\n\nexport type TimelineState = {\n  content?: TimelineContent;\n};\n\nexport type UseTimelineState = {\n  timelineState: TimelineState;\n  setTimeline: (content: TimelineContent) => void;\n  clearTimeline: () => void;\n};\n\nexport const TimelineContext = createContext<UseTimelineState>();\n\nexport const useTimelineContext = () => useContext(TimelineContext);\n\nexport const useTimelineState = (): UseTimelineState => {\n  const [timelineState, setTimelineState] = createStore<TimelineState>({});\n\n  return {\n    timelineState,\n    setTimeline: (content: TimelineContent) => setTimelineState('content', content),\n    clearTimeline: () => setTimelineState('content', undefined),\n  };\n};\n","import { Show, For, createSignal, createMemo, type Component } from 'solid-js';\n\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport Actions from '@/components/Actions';\nimport EventDisplayById from '@/components/event/EventDisplayById';\nimport ContentWarningDisplay from '@/components/event/textNote/ContentWarningDisplay';\nimport GeneralUserMentionDisplay from '@/components/event/textNote/GeneralUserMentionDisplay';\nimport TextNoteContentDisplay from '@/components/event/textNote/TextNoteContentDisplay';\nimport NotePostForm from '@/components/NotePostForm';\nimport Post from '@/components/Post';\nimport { useTimelineContext } from '@/components/timeline/TimelineContext';\nimport LazyLoad from '@/components/utils/LazyLoad';\nimport useModalState from '@/hooks/useModalState';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { textNote } from '@/nostr/event';\n\nexport type TextNoteProps = {\n  event: NostrEvent;\n  embedding?: boolean;\n  actions?: boolean;\n};\n\nconst TextNote: Component<TextNoteProps> = (props) => {\n  let textAreaRef: HTMLTextAreaElement | undefined;\n\n  const i18n = useTranslation();\n  const { showProfile } = useModalState();\n  const timelineContext = useTimelineContext();\n\n  const [showReplyForm, setShowReplyForm] = createSignal(false);\n  const closeReplyForm = () => setShowReplyForm(false);\n  const toggleReplyForm = () => {\n    setShowReplyForm((current) => !current);\n    if (showReplyForm() && textAreaRef != null) {\n      textAreaRef.focus();\n    }\n  };\n\n  const event = createMemo(() => textNote(props.event));\n\n  const embedding = () => props.embedding ?? true;\n  const actions = () => props.actions ?? true;\n\n  const showReplyEvent = (): string | undefined => {\n    if (embedding()) {\n      const replyingToEvent = event().replyingToEvent();\n\n      if (replyingToEvent != null && !event().containsEventMention(replyingToEvent.id)) {\n        return replyingToEvent.id;\n      }\n\n      const rootEvent = event().rootEvent();\n\n      if (\n        replyingToEvent == null &&\n        rootEvent != null &&\n        !event().containsEventMention(rootEvent.id)\n      ) {\n        return rootEvent.id;\n      }\n    }\n    return undefined;\n  };\n\n  return (\n    <div class=\"nostr-textnote\">\n      <Post\n        authorPubkey={event().pubkey}\n        createdAt={event().createdAtAsDate()}\n        content={\n          <div class=\"textnote-content\">\n            <Show when={showReplyEvent()} keyed>\n              {(id) => (\n                <div class=\"mt-1 rounded-sm border border-border p-1\">\n                  <LazyLoad fallback={<div class=\"h-12\" />}>\n                    {() => <EventDisplayById eventId={id} actions={false} embedding={false} />}\n                  </LazyLoad>\n                </div>\n              )}\n            </Show>\n            <Show when={event().taggedPubkeys().length > 0}>\n              <div class=\"text-xs\">\n                {i18n.t('post.replyToPre')}\n                <For each={event().taggedPubkeys()}>\n                  {(replyToPubkey: string) => (\n                    <button\n                      class=\"pr-1 text-link select-text hover:underline\"\n                      onClick={(ev) => {\n                        ev.stopPropagation();\n                        showProfile(replyToPubkey);\n                      }}\n                    >\n                      <GeneralUserMentionDisplay pubkey={replyToPubkey} />\n                    </button>\n                  )}\n                </For>\n                {i18n.t('post.replyToPost')}\n              </div>\n            </Show>\n            <ContentWarningDisplay contentWarning={event().contentWarning()}>\n              <div class=\"content wrap-break-word whitespace-pre-wrap\">\n                <TextNoteContentDisplay\n                  parsed={event().parsed()}\n                  embedding={embedding()}\n                  initialHidden={event().contentWarning().contentWarning}\n                />\n              </div>\n            </ContentWarningDisplay>\n          </div>\n        }\n        actions={\n          <Show when={actions()}>\n            <LazyLoad fallback={<div class=\"h-5\" />}>\n              {() => <Actions event={props.event} onClickReply={toggleReplyForm} />}\n            </LazyLoad>\n          </Show>\n        }\n        footer={\n          <Show when={showReplyForm()}>\n            <NotePostForm\n              textAreaRef={(el) => {\n                textAreaRef = el;\n              }}\n              mode=\"reply\"\n              replyTo={props.event}\n              onClose={closeReplyForm}\n              onPost={closeReplyForm}\n            />\n          </Show>\n        }\n        onShowProfile={() => {\n          showProfile(event().pubkey);\n        }}\n        onShowEvent={() => {\n          timelineContext?.setTimeline({ type: 'Replies', event: props.event });\n        }}\n      />\n    </div>\n  );\n};\n\nexport default TextNote;\n","import { Switch, Match, type Component } from 'solid-js';\n\nimport * as Kind from 'nostr-tools/kinds';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\n// import ChannelInfo from '@/components/event/ChannelInfo';\n\nimport Repost from '@/components/event/Repost';\nimport TextNote from '@/components/event/TextNote';\nimport EventLink from '@/components/EventLink';\nimport { useTranslation } from '@/i18n/useTranslation';\n\nexport type EventDisplayProps = {\n  event: NostrEvent;\n  embedding?: boolean;\n  actions?: boolean;\n  ensureKinds?: number[];\n};\n\nconst EventDisplay: Component<EventDisplayProps> = (props) => {\n  const i18n = useTranslation();\n\n  const isAllowedKind = () =>\n    props.ensureKinds == null ||\n    props.ensureKinds.length === 0 ||\n    props.ensureKinds.includes(props.event.kind);\n\n  return (\n    <Switch\n      fallback={\n        <div>\n          <span>{i18n.t('post.unsupportedKind', { kind: props.event.kind })}</span>\n          <EventLink eventId={props.event.id} kind={props.event.kind} />\n        </div>\n      }\n    >\n      <Match when={!isAllowedKind()} keyed>\n        <div>\n          <span>{i18n.t('post.unexpectedKind', { kind: props.event.kind })}</span>\n          <EventLink eventId={props.event.id} kind={props.event.kind} />\n        </div>\n      </Match>\n      <Match when={props.event.kind === Kind.ShortTextNote}>\n        <TextNote event={props.event} embedding={props.actions} actions={props.actions} />\n      </Match>\n      <Match when={props.event.kind === Kind.Repost}>\n        <Repost event={props.event} />\n      </Match>\n    </Switch>\n  );\n  /*\n      <Match when={props.event.kind === Kind.ChannelCreation}>\n        <ChannelInfo event={props.event} />\n      </Match>\n   */\n};\n\nexport default EventDisplay;\n"],"file":"EventDisplay-CEqmSDPH.js"}