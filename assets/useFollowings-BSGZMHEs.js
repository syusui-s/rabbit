import{t as m,i as h,j as E,a as r,h as k,F as x,w as g,c as f,u as L,D as _,b as M,v as p,d as q,z as C,A as O,x as T}from"./index-B7R5E62q.js";import{e as Q}from"./EventDisplay-CICIyOWE.js";import{q as b,w as K,x as R,B as $,r as S}from"./SideBar-DtCkeG-j.js";const U=m('<div class="block shrink-0 overflow-hidden border-b border-border p-1">'),y=t=>(()=>{const n=U();return h(n,()=>t.children),n})(),W=t=>{const{shouldMuteEvent:n}=E();return r(x,{get each(){return t.events},children:e=>r(k,{get when(){return!n(e)},get children(){return r(y,{get children(){return r(Q,{event:e})}})}})})},j=m('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary"><span>'),P=m('<button class="flex h-12 w-full flex-col items-center justify-center hover:text-fg-secondary disabled:text-fg-secondary/30"><span>'),G=t=>{const n=g(t),e=i=>{const{duration:v}=n();if(v!=null)return i-v},[s,o]=f([]),[u,l]=f(e(b())),[a,c]=f();return{setEvents:o,since:u,until:a,continuous:()=>a()==null,loadLatest:()=>{p(()=>{c(void 0),l(e(b()))}),n().onLoad?.()},loadOld:()=>{const i=K(s());i!=null&&(p(()=>{c(i.created_at),l(e(i.created_at))}),n().onLoad?.())}}},H=t=>{const n=L();return[r(k,{get when(){return!t.loadMore.continuous()},get children(){return r(y,{get children(){const e=j(),s=e.firstChild;return e.$$click=()=>t.loadMore.loadLatest(),h(s,()=>n.t("column.loadLatest")),e}})}}),_(()=>t.children),r(y,{get children(){const e=P(),s=e.firstChild;return e.$$click=()=>t.loadMore.loadOld(),h(s,()=>n.t("column.loadOld")),M(()=>e.disabled=!t.eose),e}})]};q(["click"]);const B=t=>["useFollowings",t],F=t=>{const n=()=>{const s=t();if(s==null)return[];const o=[];return T(s).pTags().forEach(l=>{const[,a,c,w]=l,d={pubkey:a,petname:w};c!=null&&c.length>0&&(d.mainRelayUrl=c),o.push(d)}),o};return{followings:n,followingPubkeys:()=>n().map(s=>s.pubkey),data:t}},J=async({pubkey:t},n)=>{const e=new $({type:"Followings",pubkey:t});S({task:e,signal:n});const s=await e.latestEventPromise();return F(()=>s)},N=t=>{const n=C(),e=g(t),s=g(()=>B(e())),o=O(()=>({queryKey:s(),queryFn:R({taskProvider:([,l])=>{if(l==null)return null;const{pubkey:a}=l;return new $({type:"Followings",pubkey:a})},queryClient:n}),staleTime:300*1e3,gcTime:4320*60*1e3,refetchOnMount:!0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchInterval:0})),u=()=>n.invalidateQueries({queryKey:s()});return{...F(()=>o.data),invalidateFollowings:u,query:o}};export{y as C,H as L,W as T,G as a,J as f,B as q,N as u};
//# sourceMappingURL=useFollowings-BSGZMHEs.js.map
