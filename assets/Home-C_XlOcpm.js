const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-CQoKNekD.js","assets/index-CvufKy-1.js","assets/index-COSNOKCH.css","assets/EventDisplay-o840Rscw.js","assets/SideBar-BD5ARE8G.js","assets/resolveAsset-D-MKg2vE.js","assets/SafeLink-Cf9K7VbA.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-DbQuuN-7.js","assets/_baseClone-DtEf7fiO.js","assets/arrow-left-auFxq3f0.js","assets/useFollowings-C6qvwves.js","assets/useSubscription-JbOrRf0k.js","assets/NostrSet-C_EhWi4d.js"])))=>i.map(i=>d[i]);
import{s as V,t as h,d as z,c as T,i as m,a as t,h as _,M as p,S as X,j as w,k as J,l as ye,u as I,m as E,n as Q,b as A,p as $e,F as G,f as F,q as ne,r as oe,v as ke,w as P,x as xe,y as re,z as we,A as be,B as H,o as Y,C as le,D as ce,E as Ce,G as _e,H as Te,_ as pe,R as Ie,I as Se,Z as Ee,N as se,J as Re,K as Le}from"./index-CvufKy-1.js";import{u as te,a as ie,b as ue,d as Me,p as ae,c as Oe,r as Fe,t as Pe,B as ze,e as He,H as De,U as me,f as de,g as W,h as Ne,i as Ue,j as Ae,k as Be,l as je,G as qe,M as Ke,m as Qe,S as Ve,n as Ge,o as Ze}from"./SideBar-BD5ARE8G.js";import{A as Je}from"./arrow-left-auFxq3f0.js";import{T as B,C as K,u as We,a as D,L as N}from"./useFollowings-C6qvwves.js";import{u as R}from"./useSubscription-JbOrRf0k.js";import{u as Xe,T as Ye,C as et,E as tt,a as nt,b as ot,c as rt,d as lt,R as ct,e as st,r as it,f as ut,g as at,A as mt,H as dt}from"./EventDisplay-o840Rscw.js";import{N as gt,a as ht}from"./NostrSet-C_EhWi4d.js";import{t as ft}from"./url-DPIb-kBm.js";const vt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ee=(e={})=>(()=>{const n=vt();return V(n,e,!0),n})(),yt=h("<button class=truncate>"),$t=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),kt=h('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),xt=h("<span class=truncate>"),U=e=>{const[n,o]=T(!1),i=()=>o(r=>!r);return(()=>{const r=$t(),c=r.firstChild,l=c.firstChild,u=l.nextSibling,a=u.firstChild;return m(l,t(_,{get when(){return e.icon},keyed:!0,children:s=>(()=>{const d=kt();return m(d,s),d})()}),null),m(l,t(_,{get when(){return e.onClickHeader},get fallback(){return(()=>{const s=xt();return m(s,()=>e.name),s})()},get children(){const s=yt();return s.$$click=()=>e.onClickHeader?.(),m(s,()=>e.name),s}}),null),u.$$click=()=>i(),m(a,t(ee,{})),m(r,t(_,{get when(){return n()},get children(){return e.settings()}}),null),r})()};z(["click"]);const wt=e=>{const n=[e.id],o=e.rootEvent()?.id;o!=null&&n.push(o);const i=e.replyingToEvent()?.id;return i!=null&&n.push(i),J(n)},bt=e=>{const{config:n}=w(),o=()=>ye(e.event),{events:i}=R(()=>({relayUrls:n().relayUrls,filters:[{kinds:[1],ids:wt(o()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return t(B,{get events(){return[...i()].reverse()}})},Ct=e=>t(X,{get children(){return t(p,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:n=>t(bt,{get event(){return n.event}})})}}),_t=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),Tt=h('<div class="shrink-0 border-b border-border">'),pt=h('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),It=h('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),St=h('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),L=e=>{let n;const o=Xe(),i=I(),r=()=>e.width??"medium";te(()=>({commandType:"moveToColumn",handler:u=>{u.command==="moveToColumn"&&u.columnIndex===e.columnIndex&&n?.scrollIntoView({behavior:"smooth",inline:"center"})}})),te(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&n?.scrollIntoView({behavior:"smooth"})}}));const[c,l]=T();return E(()=>{const u={scrollToTop:()=>{c()?.scrollTo(0,0)}};e.columnOperatorRef?.(u)}),t(Ye.Provider,{value:o,get children(){const u=_t(),a=n;return typeof a=="function"?Q(a,u):n=u,m(u,t(_,{get when(){return o.timelineState.content},keyed:!0,get fallback(){return[(()=>{const s=Tt();return m(s,()=>e.header),s})(),(()=>{const s=pt();return Q(l,s),m(s,()=>e.children),s})()]},children:s=>[(()=>{const d=It(),g=d.firstChild,$=g.firstChild,f=$.nextSibling;return g.$$click=()=>o?.clearTimeline(),m($,t(Je,{})),m(f,()=>i.t("column.back")),d})(),(()=>{const d=St();return Q(l,d),m(d,t(Ct,{timelineContent:s})),d})()]})),A(s=>$e(u,{"sm:w-[500px]":r()==="widest","sm:w-[360px]":r()==="wide","sm:w-[320px]":r()==="medium","sm:w-[280px]":r()==="narrow"},s)),u}})};z(["click"]);const Et=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),Rt=(e={})=>(()=>{const n=Et();return V(n,e,!0),n})(),Lt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),Mt=(e={})=>(()=>{const n=Lt();return V(n,e,!0),n})(),Ot=h('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),Ft=h('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),Pt=h('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),zt=h('<button class="rounded-md border px-4 text-fg-secondary">'),ge=e=>(()=>{const n=Ot(),o=n.firstChild,i=o.nextSibling;return m(o,()=>e.title),m(i,()=>e.children),n})(),M=e=>{const n=I(),{saveColumn:o,removeColumn:i,moveColumn:r}=w(),c=ie(),l=a=>{o({...e.column,width:a})},u=a=>{r(e.column.id,a),c({command:"moveToColumn",columnIndex:a}).catch(s=>console.error(s))};return(()=>{const a=Pt(),s=a.firstChild,d=s.firstChild,g=d.firstChild,$=d.nextSibling,f=$.firstChild,k=$.nextSibling,v=k.nextSibling,x=v.firstChild;return m(a,t(ge,{get title(){return n.t("column.config.columnWidth")},get children(){const y=Ft();return m(y,t(G,{each:["widest","wide","medium","narrow"],children:S=>(()=>{const b=zt();return b.$$click=()=>l(S),m(b,()=>n.t(`column.config.${S}`)),A(C=>{const O=e.column.width===S,j=e.column.width===S,Z=e.column.width!==S,q=e.column.width!==S;return O!==C._v$5&&b.classList.toggle("border-fg-secondary",C._v$5=O),j!==C._v$6&&b.classList.toggle("font-bold",C._v$6=j),Z!==C._v$7&&b.classList.toggle("border-border",C._v$7=Z),q!==C._v$8&&b.classList.toggle("font-normal",C._v$8=q),C},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),b})()})),y}}),s),m(a,t(_,{get when(){return e.renderOtherSettings},keyed:!0,children:y=>y({column:e.column,saveColumn:o})}),s),d.$$click=()=>u(e.columnIndex-1),m(g,t(Rt,{})),$.$$click=()=>u(e.columnIndex+1),m(f,t(et,{})),v.$$click=()=>i(e.column.id),m(x,t(Mt,{})),A(y=>{const S=n.t("column.config.moveLeft"),b=n.t("column.config.moveRight"),C=n.t("column.config.removeColumn"),O=n.t("column.config.removeColumn");return S!==y._v$&&F(d,"title",y._v$=S),b!==y._v$2&&F($,"title",y._v$2=b),C!==y._v$3&&F(v,"title",y._v$3=C),O!==y._v$4&&F(x,"aria-label",y._v$4=O),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()};z(["click"]);const[Ht,Dt]=ne(()=>T({})),Nt=(e,n)=>Dt(o=>({...o,[e]:n})),[Ut,At]=ne(()=>T({})),Bt=e=>oe(()=>Ut()[e]??!1),he=e=>{const n=ue(),[o,i]=T(null);return E(()=>{const r=e();if(r==null||r.encrypted.length===0)return;const{encrypted:c}=r,l=oe(()=>Ht()[c]);if(l!=null){i(l);return}if(Bt(c))return;const u=n();if(u==null)return;const a=s=>At(d=>({...d,[c]:s}));a(!0),Me(u,c).then(s=>{ke(()=>{Nt(c,s),i(s)})}).catch(s=>{console.error(`failed to decrypt "${c}"`,s)}).finally(()=>{a(!1)})}),o},jt=e=>{const n=P(()=>xe(e.event)),o=he(()=>{const{content:c}=n();return c==null||c.length===0?null:{id:n().id,encrypted:c}}),i=()=>{const c=o();if(c==null)return[];console.log(c);try{return ae(c).taggedEventIds()}catch(l){return console.warn(l),[]}},r=()=>n().taggedEventIds();return t(G,{get each(){return[...r(),...i()]},children:c=>t(K,{get children(){return t(tt,{eventId:c,get ensureKinds(){return[re]}})}})})},qt=e=>["useParameterizedReplaceableEvent",e],fe=e=>{const n=we(),o=P(e),i=()=>qt(o()),r=be(()=>({queryKey:i(),queryFn:({queryKey:l,signal:u})=>{const[,a]=l;if(a==null)return Promise.resolve(null);const{kind:s,author:d,identifier:g}=a,$=new ze({type:"ParameterizedReplaceableEvent",kind:s,author:d,identifier:g}),f=$.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${s}:${d}:${g}`)});return $.onUpdate(k=>{const v=Oe(k);n.setQueryData(l,v)}),Fe({task:$,signal:u}),Pe(15e3,`useParameterizedReplaceableEvent: ${s}:${d}:${g}`)(f)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>r.data??null,query:r}},Kt=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=T(),{event:c}=fe(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.bookmark")},get icon(){return t(He,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(_,{get when(){return c()},keyed:!0,children:l=>t(jt,{event:l})})}})},Qt=e=>{const n=I(),{config:o,removeColumn:i}=w(),{followingPubkeys:r}=We(()=>({pubkey:e.column.pubkey})),[c,l]=T(),u=D(()=>({duration:4*60*60,onLoad:()=>{c()?.scrollToTop()}})),{events:a,eose:s}=R(()=>{const d=J([...r()]);return d.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:d,limit:20,since:u.since(),until:u.until()}],eoseLimit:20,continuous:u.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:g=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(g.content)}});return E(()=>{console.log("home",a()),u.setEvents(a())}),Y(()=>console.log("home timeline mounted")),le(()=>console.log("home timeline unmounted")),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.home")},get icon(){return t(De,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>c()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:l,get children(){return t(N,{loadMore:u,get eose(){return s()},get children(){return t(B,{get events(){return a()}})}})}})},Vt=h('<button type=button class="size-4 shrink-0">'),Gt=h('<div class="flex items-start gap-2 break-all border-t border-border p-1"><div class="mt-1 size-14 shrink-0 overflow-hidden rounded"></div><div class="flex flex-1 flex-col overflow-hidden"><h3 class="truncate text-lg font-bold"></h3><p class="max-h-[3.25rem] overflow-y-auto break-all text-sm">'),Zt=h('<img class="size-full object-cover"alt=icon>'),Jt=h('<div class=text-xs><button class="select-text truncate hover:text-link hover:underline">'),Wt=e=>{const{showProfile:n}=de(),o=nt(()=>({menu:e.otherActionMenuItems??[]}));return(()=>{const i=Gt(),r=i.firstChild,c=r.nextSibling,l=c.firstChild,u=l.nextSibling;return m(r,t(_,{get when(){return e.image},keyed:!0,children:a=>(()=>{const s=Zt();return F(s,"src",a),s})()})),m(l,()=>e.title),m(u,()=>e.description),m(c,t(_,{get when(){return e.authorPubkey},keyed:!0,children:a=>(()=>{const s=Jt(),d=s.firstChild;return d.$$click=()=>n(a),m(d,t(me,{pubkey:a})),s})()}),null),m(i,t(_,{get when(){return e.otherActionMenuItems},get children(){return[(()=>{const a=Vt();a.$$click=()=>o.open();const s=o.targetRef;return typeof s=="function"?Q(s,a):o.targetRef=a,m(a,t(ee,{})),a})(),P(()=>o.popup())]}}),null),i})()};z(["click"]);const Xt=e=>{const n=P(e),{query:o}=fe(()=>({kind:ce,author:n().author,identifier:n().identifier})),i=()=>o.data,r=he(()=>W([i()?.content])(([g])=>({encrypted:g}))),c=P(()=>{const g=r();if(g==null)return null;const $=ae(g);return new gt($.tags)}),l=P(()=>o.data==null?null:new ht(o.data));return{event:i,followSet:l,pubkeys:()=>[...l()?.taggedPubkeys()??[],...c()?.taggedPubkeys()??[]],title:()=>l()?.title()||c()?.title(),description:()=>l()?.description()||c()?.description(),image:()=>l()?.image()||c()?.image(),query:o}},Yt=e=>{const n=I(),o=()=>Ce({pubkey:e.author,identifier:e.identifier,kind:ce}),i=[{content:n.t("column.columnInfoCommon.copyId"),onSelect:()=>{navigator.clipboard.writeText(o()).catch(r=>window.alert(r))}}];return t(Wt,{get image(){return e.image},get authorPubkey(){return e.author},get title(){return e.title??e.identifier},get description(){return e.description},otherActionMenuItems:i})},en=e=>{const n=I(),{config:o,removeColumn:i}=w(),{followSet:r,image:c,title:l,description:u,pubkeys:a}=Xt(()=>({author:e.column.author,identifier:e.column.identifier})),s=()=>e.column.name||l()||r()?.identifier()||n.t("column.followSet"),d=D(()=>({duration:null})),{events:g,eose:$}=R(()=>{const f=J([...a()]);return f.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:f,limit:20,since:d.since(),until:d.until()}],eoseLimit:20,continuous:d.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:k=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(k.content)}});return t(L,{get header(){return t(U,{get name(){return s()},get icon(){return t(Ne,{})},settings:()=>[t(Yt,{get author(){return e.column.author},get identifier(){return e.column.identifier},get image(){return c()},get title(){return l()},get description(){return u()}}),t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}})],onClose:()=>i(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return t(N,{loadMore:d,get eose(){return $()},get children(){return t(B,{get events(){return g()}})}})}})},tn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),nn=(e={})=>(()=>{const n=tn();return V(n,e,!0),n})(),on=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),rn=(e={})=>(()=>{const n=on();return V(n,e,!0),n})(),ln=h('<div class="flex items-center gap-1 pl-[2px] text-sm"><span class="webkit-touch-callout-none notification-icon flex h-4 min-w-4 max-w-[64px] shrink-0 select-none place-items-center overflow-hidden"></span><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),cn=h('<div class="notification-event py-1">'),sn=h('<img alt=icon class="size-full object-cover">'),un=h("<div class=truncate> "),an=e=>{const n=I(),o=ot(),{shouldMuteEvent:i}=w(),{showProfile:r}=de(),c=()=>_e(e.event),l=()=>c().lastTaggedEventId(),{profile:u}=Ue(()=>({pubkey:e.event.pubkey})),{event:a,query:s}=rt(()=>W([l()])(([k])=>({eventId:k}))),d=()=>s.isSuccess&&a()==null,g=()=>c().toReactionTypes(),$=()=>it(g()),f=lt(()=>W([$()])(([k])=>({emoji:k})));return t(_,{get when(){return P(()=>!d())()&&!i(e.event)},get children(){return[(()=>{const k=ln(),v=k.firstChild,x=v.nextSibling,y=x.firstChild,S=y.nextSibling,b=S.firstChild,C=b.nextSibling,O=x.nextSibling,j=f.emojiRef;return typeof j=="function"?Q(j,v):f.emojiRef=v,m(v,t(ct,{get reactionTypes(){return g()}})),m(k,()=>f.popup(),x),m(y,t(_,{get when(){return u()?.picture},keyed:!0,children:Z=>(()=>{const q=sn();return A(()=>F(q,"src",ft(Z,"icon"))),q})()})),b.$$click=()=>r(e.event.pubkey),m(b,t(me,{get pubkey(){return e.event.pubkey}})),m(C,()=>n.t("notification.reacted")),m(O,()=>o(c().createdAtAsDate())),k})(),(()=>{const k=cn();return m(k,t(_,{get when(){return a()},get fallback(){return(()=>{const v=un(),x=v.firstChild;return m(v,()=>n.t("general.loading"),x),m(v,l,null),v})()},keyed:!0,children:v=>t(st,{event:v})})),k})()]}})};z(["click"]);const mn=h("<div>unknown event"),dn=Te(()=>pe(()=>import("./ZapReceipt-CQoKNekD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ve=e=>{const{shouldMuteEvent:n}=w();return t(G,{get each(){return e.events},children:o=>t(_,{get when(){return!n(o)},get children(){return t(X,{get fallback(){return mn()},get children(){return[t(p,{get when(){return o.kind===re},get children(){return t(K,{get children(){return t(ut,{event:o})}})}}),t(p,{get when(){return o.kind===Ie},get children(){return t(K,{get children(){return t(an,{event:o})}})}}),t(p,{get when(){return o.kind===Se},get children(){return t(K,{get children(){return t(at,{event:o})}})}}),t(p,{get when(){return o.kind===Ee},get children(){return t(K,{get children(){return t(dn,{event:o})}})}})]}})}})})},gn=h('<div class="flex gap-1">'),hn=h('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),fn={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},vn=e=>{const n=I(),o=[{notificationType:"Replies",title:n.t("column.notificationSettings.types.replies"),icon:t(nn,{})},{notificationType:"Repost",title:n.t("column.notificationSettings.types.reposts"),icon:t(mt,{})},{notificationType:"Reaction",title:n.t("column.notificationSettings.types.reactions"),icon:t(dt,{})},{notificationType:"Zap",title:n.t("column.notificationSettings.types.zap"),icon:t(rn,{})}],i=()=>e.column.notificationTypes??[...se],r=l=>i().includes(l),c=l=>{const u=[...i()];r(l)?u.splice(u.indexOf(l),1):u.push(l),e.saveColumn({...e.column,notificationTypes:u})};return t(ge,{get title(){return n.t("column.notificationSettings.notificationTypes")},get children(){const l=gn();return m(l,t(G,{each:o,children:({notificationType:u,title:a,icon:s})=>(()=>{const d=hn(),g=d.firstChild,$=g.nextSibling;return d.$$click=()=>c(u),F(d,"title",a),m(g,s),m($,a),A(f=>{const k=!!r(u),v=!!r(u),x=!r(u),y=!r(u);return k!==f._v$&&d.classList.toggle("border-fg-secondary",f._v$=k),v!==f._v$2&&d.classList.toggle("font-bold",f._v$2=v),x!==f._v$3&&d.classList.toggle("border-border",f._v$3=x),y!==f._v$4&&d.classList.toggle("font-normal",f._v$4=y),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),d})()})),l}})},yn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=T(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),u=()=>e.column.notificationTypes??[...se],a=()=>J(u().flatMap(g=>fn[g])),{events:s,eose:d}=R(()=>a().length>0?{relayUrls:o().relayUrls,filters:[{kinds:a(),"#p":[e.column.pubkey],limit:20,since:l.since(),until:l.until()}],eoseLimit:20,clientEventFilter:g=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(g.content)}:null);return E(()=>l.setEvents(s())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.notification")},get icon(){return t(Ae,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:vn}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return d()},get children(){return t(ve,{get events(){return s()}})}})}})};z(["click"]);const $n=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=T(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:u,eose:a}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:s=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(s.content)}));return E(()=>l.setEvents(u())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.posts")},get icon(){return t(Be,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return a()},get children(){return t(B,{get events(){return u()}})}})}})},kn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=T(),l=D(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:u,eose:a}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:s=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(s.content)}));return E(()=>l.setEvents(u())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.reactions")},get icon(){return t(je,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(N,{loadMore:l,get eose(){return a()},get children(){return t(ve,{get events(){return u()}})}})}})},xn=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=T(),c=D(()=>({duration:4*60*60,onLoad:()=>{i()?.scrollToTop()}})),{events:l,eose:u}=R(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:c.since(),until:c.until()}],eoseLimit:20,clientEventFilter:a=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(a.content)}));return E(()=>c.setEvents(l())),t(L,{get header(){return t(U,{get name(){return e.column.name??n.t("column.relay")},get icon(){return t(qe,{})},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(N,{loadMore:c,get eose(){return u()},get children(){return t(B,{get events(){return l()}})}})}})},wn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block size-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),bn=e=>{const[n,o]=T(!1),[i,r]=T(""),{saveColumn:c}=w(),l=()=>o(g=>!g),u=()=>{i()!==e.column.query&&c({...e.column,query:i()})},a=()=>{u()},s=g=>{r(g.currentTarget.value)},d=g=>{g.preventDefault(),u()};return Y(()=>{r(e.column.query)}),(()=>{const g=wn(),$=g.firstChild,f=$.firstChild,k=f.firstChild,v=f.nextSibling,x=v.firstChild,y=v.nextSibling;return m(k,t(Ke,{})),v.addEventListener("submit",d),x.addEventListener("blur",a),x.addEventListener("change",s),y.$$click=()=>l(),m(y,t(ee,{})),m(g,t(_,{get when(){return n()},get children(){return e.settings()}}),null),A(()=>x.value=i()),g})()},Cn=e=>{const{removeColumn:n}=w(),[o,i]=T(),r=D(()=>({duration:null,onLoad:()=>{o()?.scrollToTop()}})),{events:c,eose:l}=R(()=>{const{query:u}=e.column;return u.length===0?null:{relayUrls:Re,filters:[{kinds:[1],search:u,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:a=>a.tags.findIndex(([s])=>s==="mostr"||s==="proxy")>=0?!1:e.column.contentFilter==null?!0:H(e.column.contentFilter)(a.content)}});return E(()=>{r.setEvents(c())}),t(L,{get header(){return t(bn,{get column(){return e.column},settings:()=>t(M,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>n(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:i,get children(){return t(N,{loadMore:r,get eose(){return l()},get children(){return t(B,{get events(){return c()}})}})}})};z(["click"]);const _n=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),Tn=()=>{const{config:e}=w();return(()=>{const n=_n();return m(n,t(G,{get each(){return e().columns},children:(o,i)=>{const r=()=>i()+1,c=()=>r()===e().columns.length;return t(X,{get children(){return[t(p,{get when(){return o.columnType==="Following"&&o},keyed:!0,children:l=>t(Qt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Notification"&&o},keyed:!0,children:l=>t(yn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Posts"&&o},keyed:!0,children:l=>t($n,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Reactions"&&o},keyed:!0,children:l=>t(kn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Relays"&&o},keyed:!0,children:l=>t(xn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="FollowSet"&&o},keyed:!0,children:l=>t(en,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Bookmark"&&o},keyed:!0,children:l=>t(Kt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Search"&&o},keyed:!0,children:l=>t(Cn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})})]}})}})),n})()},pn=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],In=e=>{const n=new Map;return e.forEach(o=>{n.set(o.key,o)}),n},Sn=({shortcuts:e=pn,onShortcut:n})=>{const o=In(e);Y(()=>{const i=Qe(r=>{if(r.type!=="keydown"||r.ctrlKey||r.altKey||r.metaKey||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLInputElement)return;const c=o.get(r.key);c!=null&&n(c)},50);window.addEventListener("keydown",i),le(()=>{window.removeEventListener("keydown",i)})})},En=()=>{const e=ie();Sn({onShortcut:n=>{e(n.command).then(()=>console.debug(`shortcut key '${n.key}' was processed successfully`),o=>console.error(o))}})},Rn=h('<div class="absolute inset-0 flex h-dvh w-screen touch-manipulation flex-row overflow-hidden">'),Ln=()=>{En();const e=Ze(),{config:n,initializeColumns:o}=w(),i=ue();return E(()=>{Promise.allSettled(n().relayUrls.map(async r=>{try{const c=await e().ensureRelay(r);c.onnotice=l=>{console.error(`NOTICE: ${r}: ${l}`)},c.onclose=()=>{console.warn(`CLOSE: ${r}`)}}catch(c){console.error("ensureRelay failed",c)}})).catch(()=>{})}),E(()=>{const r=i();r!=null&&o({pubkey:r})}),Le(r=>{console.error("uncaught error: ",r)}),(()=>{const r=Rn();return m(r,t(Ve,{}),null),m(r,t(Tn,{}),null),m(r,t(Ge,{}),null),r})()},Un=Object.freeze(Object.defineProperty({__proto__:null,default:Ln},Symbol.toStringTag,{value:"Module"}));export{rn as B,Un as H};
//# sourceMappingURL=Home-C_XlOcpm.js.map
