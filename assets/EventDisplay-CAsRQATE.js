const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EventDebugModal-BeOsYptq.js","assets/index-BgJdOkFT.js","assets/index-D0gJNBac.css","assets/BasicModal-CDNKO_66.js","assets/SideBar-Co9awlXP.js","assets/resolveAsset-D5-NVMcQ.js","assets/Copy-QrSJ0tuy.js","assets/UserList-MzXUc5OI.js","assets/url-DPIb-kBm.js","assets/SafeLink-HYpJts1W.js","assets/ZapRequestModal-CwUm9Hp6.js","assets/lud16ToLnurlPayUrl-BSUJ8YU2.js","assets/_baseClone-t5bDlApG.js","assets/useSubscription-CQ-uABI7.js"])))=>i.map(i=>d[i]);
import{s as H,t as g,r as _,a as n,i as d,f as E,h as b,aK as pe,aL as Ye,y as N,u as I,aM as Je,j as D,M as x,ag as Xe,S as U,c as C,q as xe,A as Q,p as Ee,d as M,v as et,o as V,F as Z,n as L,x as G,B as W,ab as re,C as oe,_ as se,b as P,m as K,ak as tt,w as Y,aN as nt,al as rt,ao as ot,aj as st,ai as lt,K as it,l as ct,D as at}from"./index-BgJdOkFT.js";import{r as ut,t as J,B as le,f as q,U as dt,g as ie,x as Ce,y as Re,o as ce,b as X,z as ht,j as gt,P as ft,E as vt,e as Te,n as Se,a as mt,k as $t,N as yt}from"./SideBar-Co9awlXP.js";import{S as T}from"./SafeLink-HYpJts1W.js";import{t as Pe,a as Me,p as bt,b as wt,c as kt,d as _t,i as pt}from"./url-DPIb-kBm.js";const xt=g('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3">'),Ie=(e={})=>(()=>{const t=xt();return H(t,e,!0),t})(),Et=g("<span>"),Ct=g('<a class="text-link underline">'),Rt=e=>{try{return pe(e)}catch(t){return console.error("failed to encode event id into Bech32 entity (NIP-19) but ignore",e,t),e}},Tt=(e,t)=>{try{return Ye({id:e,kind:t})}catch(r){return console.error("failed to encode event id into Bech32 entity (NIP-19) but ignore",e,r),e}},F=e=>{const t=_(()=>e.kind==null||e.kind===1?Rt(e.eventId):Tt(e.eventId,e.kind)),r=()=>t()!==e.eventId?`nostr:${t()}`:null;return n(b,{get when(){return r()},get fallback(){return(()=>{const c=Et();return d(c,()=>e.eventId),c})()},keyed:!0,children:c=>(()=>{const l=Ct();return E(l,"href",c),d(l,t),l})()})},St=e=>{const t=_(e),r=N(()=>({queryKey:["useEvent",t()],queryFn:({queryKey:l,signal:i})=>{const[,o]=l;if(o==null)return null;const{eventId:s}=o,a=new le({type:"Event",eventId:s}),u=a.firstEventPromise().catch(()=>{throw new Error(`event not found: ${s}`)});return console.log("useEvent",t()),ut({task:a,signal:i}),J(15e3,`useEvent: ${s}`)(u)},staleTime:4*60*60*1e3,gcTime:4*60*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{event:()=>r.data??null,query:r}},Pt=g("<span>"),Mt=g("<div class=truncate> "),O=e=>{const t=I(),[r,c]=Je(e,["eventId"]),{shouldMuteEvent:l}=D(),{event:i,query:o}=St(()=>q([r.eventId])(([a])=>({eventId:a}))),s=()=>{const a=i();return e.displayForcibly?!1:a!=null&&l(a)};return n(U,{get fallback(){return(()=>{const a=Pt();return d(a,()=>t.t("post.failedToFetchEvent"),null),d(a,()=>e.eventId,null),a})()},get children(){return[n(x,{get when(){return s()},children:null}),n(x,{get when(){return i()},keyed:!0,children:a=>n(qr,Xe({event:a},c))}),n(x,{get when(){return o.isLoading&&r.eventId},keyed:!0,children:a=>(()=>{const u=Mt(),h=u.firstChild;return d(u,()=>t.t("general.loading"),h),d(u,n(F,{eventId:a}),null),u})()})]}})},De=e=>{const[t,r]=C(new Date);return xe(()=>{const c=setInterval(()=>{r(new Date)},e().interval);Q(()=>clearInterval(c))}),t},It=e=>{switch(e.kind){case"now":return"now";case"seconds":return`${e.value}s`;case"minutes":return`${e.value}m`;case"hours":return`${e.value}h`;case"days":return`${e.value}d`;case"abs":default:return e.value.toLocaleDateString()}},he=e=>`${e.getHours()}:${e.getMinutes().toString().padStart(2,"0")}`,Dt=e=>{switch(e.kind){case"today":return e.value.toLocaleTimeString();case"yesterday":case"abs":default:return e.value.toLocaleString()}},jt=e=>{switch(e.kind){case"today":return he(e.value);case"yesterday":return`昨日 ${he(e.value)}`;case"abs":default:return e.value.toLocaleString()}},Lt=(e,t)=>Math.round(Number(t)-Number(e))/1e3,At=(e,t)=>{const r=Lt(e,t);return r<10?{kind:"now"}:r<60?{kind:"seconds",value:Math.round(r)}:r<3600?{kind:"minutes",value:Math.round(r/60)}:r<86400?{kind:"hours",value:Math.round(r/3600)}:r<604800?{kind:"days",value:Math.round(r/86400)}:{kind:"abs",value:e}},ge=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),Ut=e=>new Date(+e-24*60*60*1e3),je=(e,t,r)=>ge(e,t)?r({kind:"today",value:e}):ge(e,Ut(t))?r({kind:"yesterday",value:e}):r({kind:"abs",value:e}),Ht=(e,t=new Date)=>je(e,t,Dt),Bt=(e,t=new Date)=>je(e,t,jt),fe=(e,t=new Date,r=It)=>r(At(e,t)),ve=Ee(()=>De(()=>({interval:7e3}))),me=Ee(()=>De(()=>({interval:60*1e3}))),Le=()=>{const{config:e}=D();return t=>{switch(e().dateFormat){case"absolute-long":return Ht(t,me());case"absolute-short":return Bt(t,me());case"relative":return fe(t,ve());default:return fe(t,ve())}}},qt=g('<div><div class="flex items-center gap-1"><div class="flex shrink-0 place-items-center pl-[2px]"aria-hidden=true><span class="size-4 text-r-repost"></span></div><div class="notification-user flex min-w-0 flex-1 overflow-hidden text-xs"><button class="select-text truncate hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div><div class=text-xs></div></div><div class=pt-1>'),Ft=e=>{const t=I(),{showProfile:r}=ie(),c=Le(),l=_(()=>et(e.event)),i=()=>l().lastTaggedEventId();return(()=>{const o=qt(),s=o.firstChild,a=s.firstChild,u=a.firstChild,h=a.nextSibling,m=h.firstChild,f=m.nextSibling,$=h.nextSibling,w=s.nextSibling;return d(u,n(Ie,{})),m.$$click=()=>r(e.event.pubkey),d(m,n(dt,{get pubkey(){return e.event.pubkey}})),d(f,()=>t.t("notification.reposted")),d($,()=>c(l().createdAtAsDate())),d(w,n(O,{get eventId(){return i()}})),o})()};M(["click"]);const Ot=g('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5z">'),zt=(e={})=>(()=>{const t=Ot();return H(t,e,!0),t})(),Wt=g('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741z">'),Kt=(e={})=>(()=>{const t=Wt();return H(t,e,!0),t})(),Nt=g('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0">'),Qt=(e={})=>(()=>{const t=Nt();return H(t,e,!0),t})(),Vt=g('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path d="m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z">'),Ae=(e={})=>(()=>{const t=Vt();return H(t,e,!0),t})(),Zt=g("<span class=truncate>"),Gt=g('<img class="pointer-events-none h-full w-auto object-contain">'),Ue=e=>n(U,{get children(){return[n(x,{get when(){return e.emoji.type==="Emoji"&&e.emoji.content},keyed:!0,children:t=>(()=>{const r=Zt();return d(r,t),r})()}),n(x,{get when(){return e.emoji.type==="CustomEmoji"&&e.emoji},keyed:!0,children:({shortcode:t,url:r})=>(()=>{const c=Gt();return E(c,"src",r),E(c,"alt",`:${t}:`),c})()})]}}),Yt=g('<span class="inline-block size-full pt-px text-r-reaction">'),Jt=g("<span class=truncate>"),Xt=e=>e.type==="LikeDislike"&&(e.content==="+"||e.content.length===0),He=e=>{if(e.type==="Emoji"||e.type==="CustomEmoji")return e},Be=e=>n(U,{get fallback(){return(()=>{const t=Jt();return d(t,()=>e.reactionTypes.content),t})()},get children(){return[n(x,{get when(){return Xt(e.reactionTypes)},get children(){const t=Yt();return d(t,n(Ae,{})),t}}),n(x,{get when(){return He(e.reactionTypes)},keyed:!0,children:t=>n(Ue,{emoji:t})})]}}),en=300,tn=e=>{let t,r=!1;return V(()=>{if(t==null)return;const{onLongPress:c,onClick:l,delay:i=en}=e();let o;const s=()=>{r=!1,o=setTimeout(()=>{r=!0,c()},i)},a=()=>{o!=null&&clearTimeout(o)},u=f=>{f.preventDefault(),s()},h=f=>{f.preventDefault(),a()},m=()=>{r||(a(),l())};t.addEventListener("mousedown",u),t.addEventListener("mouseup",h),t.addEventListener("touchstart",u),t.addEventListener("touchend",h),t.addEventListener("click",m),Q(()=>{a(),t?.removeEventListener("mouseddown",u),t?.removeEventListener("mouseup",h),t?.removeEventListener("touchstart",u),t?.removeEventListener("touchend",h),t?.removeEventListener("click",m)})}),{ref:c=>{t=c}}},nn=g('<div><div class="flex h-24 min-w-24 max-w-screen-lg items-center justify-center rounded border border-border bg-bg text-5xl shadow">'),qe=e=>{let t;const r=_(e),[c,l]=C(!1);let i;const o=()=>{setTimeout(()=>{c()||i.close()},100)},s=()=>{i.open()};i=Ce(()=>({popup:()=>n(b,{get when(){return r()?.emoji},keyed:!0,children:u=>(()=>{const h=nn(),m=h.firstChild;return h.addEventListener("mouseleave",()=>{l(!1),o()}),h.addEventListener("mouseenter",()=>{l(!0)}),d(m,n(Ue,{emoji:u})),h})()}),position:{x:"center",y:"top"}}));const a=tn(()=>({onLongPress:()=>s(),onClick:()=>r()?.onClick?.()}));return V(()=>{t?.addEventListener("mouseenter",s),t?.addEventListener("mouseleave",o)}),{emojiRef:u=>{t=u,i.targetRef(u),a.ref(u)},popup:i.popup}},rn=g('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m8.25 4.5 7.5 7.5-7.5 7.5">'),on=(e={})=>(()=>{const t=rn();return H(t,e,!0),t})(),sn=g('<li class="border-b border-border hover:bg-bg-tertiary"><button class="w-full px-4 py-1 text-start">'),ln=g('<li class="border-b border-border hover:bg-bg-tertiary"><button class="flex w-full items-center py-1 pe-2 ps-4 text-start"><span class=flex-1></span><span class="inline-block size-4 shrink-0">'),cn=g('<ul class="min-w-[96px] rounded border border-border bg-bg shadow-md">'),an=e=>{const t=()=>{e.item?.onSelect?.(),e.onClose()};return(()=>{const r=sn(),c=r.firstChild;return c.$$click=t,d(c,()=>e.item.content),r})()},un=e=>{const t=Fe(()=>({menu:e.submenu.items,position:{x:"right",y:"bottom"}})),r=()=>{t.open()};return(()=>{const c=ln(),l=c.firstChild,i=l.firstChild,o=i.nextSibling,s=t.targetRef;return typeof s=="function"?L(s,c):t.targetRef=c,l.$$click=r,d(i,()=>e.submenu.content),d(o,n(on,{})),d(c,()=>t.popup(),null),c})()},dn=e=>"onSelect"in e?e:null,hn=e=>"items"in e?e:null,Fe=e=>{const t=_(e),r=Ce(()=>({ensureWidth:300,position:{x:"right",y:"bottom"},...t(),popup:(()=>{const c=cn();return d(c,n(Z,{get each(){return t().menu.filter(l=>l.when==null||l.when())},children:l=>n(U,{get children(){return[n(x,{get when(){return dn(l)},keyed:!0,children:i=>n(an,{item:i,onClose:()=>r.close()})}),n(x,{get when(){return hn(l)},keyed:!0,children:i=>n(un,{submenu:i,onClose:()=>r.close()})})]}})})),c})()}));return r};M(["click"]);const gn=/\p{Emoji_Presentation}/u,Oe=e=>["useReactions",e],ae=e=>{const{shouldMuteEvent:t}=D(),r=G(),c=_(()=>Oe(e())),l=N(()=>({queryKey:c(),queryFn:Re({taskProvider:([,u])=>{if(u==null)return null;const{eventId:h}=u;return new le({type:"Reactions",mentionedEventId:h})},queryClient:r}),staleTime:1*60*1e3,gcTime:4*60*60*1e3,refetchInterval:1*60*1e3})),i=()=>(l.data??[]).filter(h=>!t(h));return{reactions:i,reactionsGrouped:()=>{const u=new Map;return i().forEach(h=>{const m=W(h).isCustomEmoji()?`${h.content}${W(h).getUrl()??""}`:h.content,f=u.get(m)??[];f.push(h),u.set(m,f)}),u},isReactedBy:u=>i().findIndex(h=>h.pubkey===u)!==-1,isReactedByWithEmoji:u=>i().findIndex(h=>h.pubkey===u&&gn.test(h.content))!==-1,query:l}},ze=e=>{const t=G(),r=_(e),c=ce();return re(()=>({mutationKey:["useReactionMutation",r().eventId],mutationFn:(...i)=>c.publishReaction(...i).then(o=>Promise.allSettled(o.map(J(5e3)))),onSuccess:i=>{const o=i.filter(a=>a.status==="fulfilled").length,s=i.length-o;o===i.length?console.log("Succeeded to publish a reaction"):o>0?console.warn(`failed to publish a reaction on ${s} relays`):console.error("failed to publish reaction on all relays")},onError:i=>{console.error("failed to publish reaction: ",i)},onSettled:()=>{const i=Oe({eventId:r().eventId});t.refetchQueries({queryKey:i}).then(()=>t.invalidateQueries({queryKey:i})).catch(o=>console.error("failed to refetch reactions",o))}}))},We=e=>["useReposts",e],Ke=e=>{const{shouldMuteEvent:t}=D(),r=G(),c=_(e),l=_(()=>We(c())),i=N(()=>({queryKey:l(),queryFn:Re({taskProvider:([,a])=>{if(a==null)return null;const{eventId:u}=a;return new le({type:"Reposts",mentionedEventId:u})},queryClient:r}),staleTime:1*60*1e3,gcTime:4*60*60*1e3,refetchInterval:1*60*1e3})),o=()=>(i.data??[]).filter(u=>!t(u));return{reposts:o,isRepostedBy:a=>o().findIndex(u=>u.pubkey===a)!==-1,query:i}},fn=e=>{const t=G(),r=_(e),c=ce();return re(()=>({mutationKey:["useRepostMutation",r().eventId],mutationFn:(...i)=>c.publishRepost(...i).then(o=>Promise.allSettled(o.map(J(1e4)))),onSuccess:i=>{const o=i.filter(a=>a.status==="fulfilled").length,s=i.length-o;o===i.length?console.log("Succeeded to publish a repost"):o>0?console.warn(`Failed to publish a repost on ${s} relays`):console.error("Failed to publish a repost on all relays")},onError:i=>{console.error("failed to publish repost: ",i)},onSettled:()=>{const i=We({eventId:r().eventId});t.refetchQueries({queryKey:i}).then(()=>t.invalidateQueries({queryKey:i})).catch(o=>console.error("failed to refetch repost",o))}}))},$e=["k","M","G","T","P"],vn=(e,t)=>{const r=t?.precision,l=10**((t?.minDigits??4)-1);if(e<l)return{value:e,prefix:null};const i=10**(Math.floor(Math.log10(e)/3)*3),o=e/i;let s=Math.round(o*10**r)/10**r,a=Math.max(Math.floor(Math.log10(e)/3)-1,0);return s>=1e3&&(s/=1e3,a+=1),a>=$e.length?{value:e,prefix:null}:{value:s,prefix:$e[a]}},Ne=(e,t)=>{const{value:r,prefix:c}=vn(e,{precision:2,minDigits:t?.minDigits??5});if(c==null)return`${e}`;const l=t?.digits??3,i=Math.floor(Math.log10(r))+1,o=Math.max(l-i,0);return`${Math.round(r*10**o)/10**o}${c}`},Qe=g('<div class="text-sm text-fg-tertiary">'),ye=g('<div class="flex shrink-0 items-center gap-1"><button class=size-4>'),mn=g('<div class="flex shrink-0 items-center gap-1"><button><span class="flex size-4">'),$n=g('<div class="h-4 min-w-4 max-w-8">'),yn=g('<div class="scrollbar flex gap-2 overflow-x-auto py-1">'),bn=g('<span class="ml-1 text-sm">'),wn=g('<button class="webkit-touch-callout-none flex h-6 touch-none select-none items-center rounded border border-border px-1"type=button><span class="flex h-5 min-w-5 max-w-[128px] items-center justify-center">'),kn=g("<span class=text-red-500>"),_n=g('<div class="actions flex w-64 max-w-full items-center justify-between pt-1"><button class="shrink-0 text-fg-tertiary hover:text-fg-tertiary/70"><span class="flex size-4"></span></button><button type=button><span class="flex size-4 text-fg-tertiary hover:text-r-zap"></span></button><button type=button class="size-4 shrink-0 text-fg-tertiary hover:text-fg-tertiary/70">'),pn=oe(()=>se(()=>import("./EventDebugModal-BeOsYptq.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ve=oe(()=>se(()=>import("./UserList-MzXUc5OI.js"),__vite__mapDeps([7,1,2,4,5,8,3,9]))),xn=oe(()=>se(()=>import("./ZapRequestModal-CwUm9Hp6.js"),__vite__mapDeps([10,1,2,3,4,5,6,11,12,13,9,8]))),En=e=>{if(e.native!=null)return{type:"Emoji",content:e.native};if(e.src!=null)return{type:"CustomEmoji",content:`:${e.id}:`,shortcode:e.id,url:e.src};throw new Error("unknown emoji")},Cn=e=>{const{config:t}=D(),r=X(),[c,l]=C(!1),{reactions:i,isReactedByWithEmoji:o,isReactedBy:s}=ae(()=>({eventId:e.event.id})),a=_(()=>{const v=r();return v!=null&&s(v)||c()}),u=_(()=>{const v=r();return v!=null&&o(v)}),h=ze(()=>({eventId:e.event.id})),m=v=>{a()||q([r(),e.event.id])(([k,y])=>{h.mutate({relayUrls:t().relayUrls,pubkey:k,reactionTypes:v??{type:"LikeDislike",content:"+"},eventId:y,kind:e.event.kind,notifyPubkey:e.event.pubkey}),l(!0)})},f=v=>{v.stopPropagation(),m()},$=v=>{m(En(v))},w=ht(()=>({onEmojiSelect:$}));return[(()=>{const v=ye(),k=v.firstChild;return k.$$click=f,d(k,n(b,{get when(){return _(()=>!!a())()&&!u()},get fallback(){return n(gt,{})},get children(){return n(Ae,{})}})),d(v,n(b,{get when(){return _(()=>!t().hideCount&&!t().showEmojiReaction)()&&i().length>0},get children(){const y=Qe();return d(y,()=>Ne(i().length,{minDigits:4})),y}}),null),P(y=>{const S={"text-fg-tertiary":!a()||u(),"hover:text-r-reaction":!a()||u(),"text-r-reaction":a()&&!u()||h.isPending},R=h.isPending;return y._v$=K(v,S,y._v$),R!==y._v$2&&(k.disabled=y._v$2=R),y},{_v$:void 0,_v$2:void 0}),v})(),n(b,{get when(){return t().useEmojiReaction},get children(){const v=ye(),k=v.firstChild;k.$$click=()=>w.open();const y=w.targetRef;return typeof y=="function"?L(y,k):w.targetRef=k,d(k,n(ft,{})),d(v,()=>w.popup(),null),P(S=>K(v,{"text-fg-tertiary":!a()||!u(),"hover:text-r-reaction":!a()||!u(),"text-r-reaction":a()&&u()||h.isPending},S)),v}})]},Rn=e=>{const{config:t}=D(),r=X(),[c,l]=C(!1),{reposts:i,isRepostedBy:o}=Ke(()=>({eventId:e.event.id})),s=_(()=>{const h=r();return h!=null&&o(h)||c()}),a=fn(()=>({eventId:e.event.id})),u=h=>{h.stopPropagation(),!s()&&q([r(),e.event.id])(([m,f])=>{a.mutate({relayUrls:t().relayUrls,pubkey:m,eventId:f,kind:e.event.kind,notifyPubkey:e.event.pubkey}),l(!0)})};return(()=>{const h=mn(),m=h.firstChild,f=m.firstChild;return m.$$click=u,d(f,n(Ie,{})),d(h,n(b,{get when(){return _(()=>!t().hideCount)()&&i().length>0},get children(){const $=Qe();return d($,()=>Ne(i().length,{minDigits:4})),$}}),null),P($=>{const w={"text-fg-tertiary":!s(),"hover:text-r-repost":!s(),"text-r-repost":s()||a.isPending},v=a.isPending;return $._v$3=K(h,w,$._v$3),v!==$._v$4&&(m.disabled=$._v$4=v),$},{_v$3:void 0,_v$4:void 0}),h})()},Tn=e=>{const{reactions:t}=ae(()=>({eventId:e.event.id}));return n(Ve,{get data(){return t()},pubkeyExtractor:r=>r.pubkey,renderInfo:r=>(()=>{const c=$n();return d(c,n(Be,{get reactionTypes(){return W(r).toReactionTypes()}})),c})(),get onClose(){return e.onClose}})},Sn=e=>{const{reposts:t}=Ke(()=>({eventId:e.event.id}));return n(Ve,{get data(){return t()},pubkeyExtractor:r=>r.pubkey,get onClose(){return e.onClose}})},Pn=e=>{const{config:t}=D(),r=X(),[c,l]=C(!1),{reactions:i,reactionsGrouped:o,isReactedBy:s}=ae(()=>({eventId:e.event.id})),a=ze(()=>({eventId:e.event.id})),u=()=>{const m=r();return m==null?c():c()||s(m)},h=m=>{u()||q([r(),e.event.id])(([f,$])=>{a.mutate({relayUrls:t().relayUrls,pubkey:f,reactionTypes:m??{type:"LikeDislike",content:"+"},eventId:$,kind:e.event.kind,notifyPubkey:e.event.pubkey}),l(!0)})};return n(b,{get when(){return _(()=>!!t().showEmojiReaction)()&&i().length>0},get children(){const m=yn();return d(m,n(Z,{get each(){return[...o().entries()]},children:([,f])=>{const $=f.findIndex(y=>y.pubkey===r())>=0,w=W(f[0]).toReactionTypes(),v=He(w),k=qe(()=>q([v])(([y])=>({emoji:y,onClick:()=>{u()||a.isPending||h(w)}})));return(()=>{const y=wn(),S=y.firstChild;return L(R=>k.emojiRef(R),y),d(S,n(Be,{reactionTypes:w})),d(y,n(b,{get when(){return!t().hideCount},get children(){const R=bn();return d(R,()=>f.length),R}}),null),d(y,()=>k.popup(),null),P(R=>K(y,{"text-fg-tertiary":!$,"hover:bg-r-reaction/10":!$,"hover:border-r-reaction/40":!$,"bg-r-reaction/10":$,"border-r-reaction/40":$,"text-r-reaction":$},R)),y})()}})),m}})},Mn=e=>{const t=I(),{config:r,addMutedThread:c}=D(),l=X(),i=ce(),[o,s]=C(null),a=()=>s(null),u=re(()=>({mutationKey:["deleteEvent",e.event.id],mutationFn:(...f)=>i.deleteEvent(...f).then($=>Promise.allSettled($.map(J(1e4)))),onSuccess:f=>{const $=f.filter(v=>v.status==="fulfilled").length,w=f.length-$;$===f.length?window.alert(t.t("post.deletedSuccessfully")):$>0?window.alert(t.t("post.failedToDeletePartially",{count:w})):window.alert(t.t("post.failedToDelete"))},onError:f=>{console.error("failed to delete",f)}})),h=()=>{tt(()=>{if(c(e.event.id),e.event.kind===Y){const f=new nt(e.event).rootEvent()?.id;f!=null&&c(f)}})},m=Fe(()=>({menu:[{content:t.t("post.copyEventId"),onSelect:()=>{navigator.clipboard.writeText(pe(e.event.id)).catch(f=>window.alert(f))}},{content:t.t("post.showJSON"),onSelect:()=>{s("EventDebugModal")}},{content:t.t("post.muteThread"),onSelect:()=>h()},{content:t.t("post.showReposts"),onSelect:()=>{s("Reposts")}},{content:t.t("post.showReactions"),onSelect:()=>{s("Reactions")}},{when:()=>e.event.pubkey===l(),content:(()=>{const f=kn();return d(f,()=>t.t("post.deletePost")),f})(),onSelect:()=>{const f=l();f!=null&&window.confirm(t.t("post.confirmDelete"))&&u.mutate({relayUrls:r().relayUrls,pubkey:f,eventId:e.event.id,kind:e.event.kind})}}]}));return[n(Pn,{get event(){return e.event}}),(()=>{const f=_n(),$=f.firstChild,w=$.firstChild,v=$.nextSibling,k=v.firstChild,y=v.nextSibling;$.$$click=R=>{R.stopPropagation(),e.onClickReply()},d(w,n(Kt,{})),d(f,n(Rn,{get event(){return e.event}}),v),d(f,n(Cn,{get event(){return e.event}}),v),v.$$click=()=>s("ZapRequest"),d(k,n(zt,{})),y.$$click=()=>m.open();const S=m.targetRef;return typeof S=="function"?L(S,y):m.targetRef=y,d(y,n(Qt,{})),d(f,()=>m.popup(),null),f})(),n(U,{get children(){return[n(x,{get when(){return o()==="EventDebugModal"},get children(){return n(pn,{get event(){return e.event},onClose:a})}}),n(x,{get when(){return o()==="Reactions"},get children(){return n(Tn,{get event(){return e.event},onClose:a})}}),n(x,{get when(){return o()==="Reposts"},get children(){return n(Sn,{get event(){return e.event},onClose:a})}}),n(x,{get when(){return o()==="ZapRequest"},get children(){return n(xn,{get zapTo(){return{event:e.event}},onClose:a})}})]}})]};M(["click"]);const In=g("<div>"),Dn=g('<button class="text-xs text-fg-secondary hover:text-fg-secondary/70">'),jn=g("<span>: "),Ln=g('<button class="mt-2 flex w-full flex-col items-center rounded border border-border p-2 text-center text-xs text-fg-secondary"><span class="inline-block size-4"></span><span>'),An=e=>{const t=I(),[r,c]=C(!1);return n(b,{get when(){return!e.contentWarning.contentWarning||r()},get fallback(){return(()=>{const l=Ln(),i=l.firstChild,o=i.nextSibling;return l.$$click=()=>c(!0),d(i,n(vt,{})),d(o,()=>t.t("post.contentWarning.show")),d(l,n(b,{get when(){return e.contentWarning.reason!=null},get children(){const s=jn(),a=s.firstChild;return d(s,()=>t.t("post.contentWarning.reason"),a),d(s,()=>e.contentWarning.reason,null),s}}),null),l})()},get children(){return[(()=>{const l=In();return d(l,()=>e.children),l})(),n(b,{get when(){return e.contentWarning.contentWarning},get children(){const l=Dn();return l.$$click=()=>c(!1),d(l,()=>t.t("post.contentWarning.hide")),l}})]}})};M(["click"]);const Ze=e=>{const{profile:t}=Te(()=>({pubkey:e.pubkey}));return n(b,{get when(){return(t()?.name?.length??0)>0},get fallback(){return`@${Se(e.pubkey)}`},get children(){return["@",_(()=>t()?.name??e.pubkey)]}})},Un=g("<div>"),j=e=>{let t;const[r,c]=C(!1);return V(()=>{const l=new IntersectionObserver(i=>{i.forEach(o=>{o.isIntersecting&&(c(!0),l.disconnect())})},{threshold:e.threshold??0});t!=null&&l.observe(t),Q(()=>{l.disconnect()})}),n(b,{get when(){return r()},get fallback(){return(()=>{const l=Un(),i=t;return typeof i=="function"?L(i,l):t=l,d(l,()=>e.fallback),l})()},keyed:!0,children:l=>e.children()})},Hn=g('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),Bn=g("<div class=max-w-full>"),qn=g("<audio controls><a>"),Fn=e=>{const t=I(),[r,c]=C(e.initialHidden);return n(b,{get when(){return!r()},get fallback(){return(()=>{const l=Hn();return l.$$click=()=>c(!1),d(l,()=>t.t("post.showAudio")),l})()},get children(){return n(j,{get fallback(){return Bn()},children:()=>n(T,{class:"my-2 block",get href(){return e.url},get children(){const l=qn(),i=l.firstChild;return d(i,()=>t.t("post.download")),P(o=>{const s=e.url,a=e.url;return s!==o._v$&&E(l,"src",o._v$=s),a!==o._v$2&&E(i,"href",o._v$2=a),o},{_v$:void 0,_v$2:void 0}),l}})})}})};M(["click"]);const On=g('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),zn=g('<div class="aspect-video max-w-full">'),Wn=g('<img class="max-h-64 max-w-full rounded object-contain shadow hover:shadow-md">'),Kn=e=>{let t;const r=I(),[c,l]=C(e.initialHidden),[i,o]=C(!1);return n(b,{get when(){return!c()},get fallback(){return(()=>{const s=On();return s.$$click=()=>l(!1),d(s,()=>r.t("post.showImage")),s})()},get children(){return n(j,{get fallback(){return(()=>{const s=zn();return d(s,n(T,{class:"text-link underline",get href(){return e.url}})),s})()},children:()=>n(b,{get when(){return!i()},get fallback(){return n(T,{class:"text-link underline",get href(){return e.url}})},get children(){return n(T,{class:"my-2 block",get href(){return e.url},get children(){const s=Wn();s.addEventListener("error",()=>o(!0));const a=t;return typeof a=="function"?L(a,s):t=s,P(u=>{const h=Pe(e.url),m=e.url;return h!==u._v$&&E(s,"src",u._v$=h),m!==u._v$2&&E(s,"alt",u._v$2=m),u},{_v$:void 0,_v$2:void 0}),s}})}})})}})};M(["click"]);const Nn=g('<div class="my-1 rounded border p-1">'),Qn=e=>n(b,{get when(){return e.mentionedEvent.marker!=null&&e.mentionedEvent.marker.length>0},get fallback(){return n(F,{get eventId(){return e.mentionedEvent.eventId}})},get children(){const t=Nn();return d(t,n(j,{children:()=>n(O,{get eventId(){return e.mentionedEvent.eventId},embedding:!1,actions:!1,get ensureKinds(){return[Y]}})})),t}}),Vn=g('<button class="inline select-text text-link underline">'),ee=e=>{const{showProfile:t}=ie(),r=()=>{t(e.pubkey)};return(()=>{const c=Vn();return c.$$click=r,d(c,n(Ze,{get pubkey(){return e.pubkey}})),c})()};M(["click"]);const Zn=["www3.nhk.or.jp"],Gn=e=>{const t=new TextDecoder("US-ASCII").decode(e.slice(0,1024)),r=t.match(/<meta\s+charset="([-A-Za-z0-9]+)"/i);if(r!=null)return r[1].toLowerCase();const c=t.match(/<meta\s+http-equiv="Content-Type"\s*content="text\/html;\s*charset=([-A-Za-z0-9_]+)"/i);return c!=null?c[1].toLowerCase():null},Yn=new Set(["utf-8","shift_jis","shift-jis","euc-jp","iso-2022-jp"]),Jn=e=>{try{const t=Gn(e)??"utf-8";if(!Yn.has(t))throw new Error(`Unsupported encodings: ${t}`);return new TextDecoder(t).decode(e)}catch(t){throw new Error("Failed to convert charset",{cause:t})}},Xn=(e,t)=>{const r={};Array.from(e.head.querySelectorAll("meta")).forEach(s=>{const a=s.getAttribute("property")||s.getAttribute("name"),u=s.getAttribute("content");a!=null&&u!=null&&(r[a]=u)});const c=r["og:image"]||r["twitter:image"],l=r["og:title"]||r["twitter:title"],i=r["og:url"]||t,o=r["og:description"]||r["twitter:description"]||"";return c&&l&&i?{title:l,description:o,image:c,url:i}:null},er=(e,t)=>{const r=new DOMParser().parseFromString(e,"text/html");return Xn(r,t)},Ge=e=>new URL(e).protocol==="https:",tr=e=>{const t=new URL(e);return Zn.includes(t.hostname)},nr=e=>tr(e)?e:`https://corsproxy.io/?${encodeURIComponent(e)}`,rr=async e=>{try{if(!Ge(e))return null;const t=nr(e),c=await(await fetch(t,{mode:"cors",headers:{Accept:"text/html"},credentials:"omit"})).arrayBuffer(),l=Jn(c);return er(l,e)}catch(t){return console.error(`failed to fetch ogp for ${e}`,t),null}},or=e=>{const t=()=>["useOgp",e().url],r=N(()=>({queryKey:t(),queryFn:({queryKey:[,l]})=>rr(l),staleTime:144e5,gcTime:144e5,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{query:r,ogp:()=>r.data}},sr=g('<blockquote class=twitter-tweet><a class="text-link underline"target=_blank rel="noreferrer noopener">'),lr=g('<div class="my-2 rounded-lg border border-border transition-colors hover:bg-bg-tertiary"><img class="max-w-full rounded-t-lg object-contain shadow"><div class="mb-1 p-1"><div class="text-xs text-fg-secondary"></div><div class=text-sm></div><div class="text-xs text-fg-secondary">'),ir=g('<div><button class="flex flex-col items-center rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),cr=g('<div class="my-2 aspect-video w-full"><iframe loading=lazy title=YouTube class="my-2 size-full"allowfullscreen>'),ar=e=>{try{const t=new URL(e);return t.host="twitter.com",t.href}catch{return e}},ur=e=>{const t=new URL("https://www.youtube-nocookie.com/embed/");return t.pathname+=e,t.searchParams.set("origin",window.location.origin),t.href},dr=()=>window.twttr!=null,hr=e=>{let t;const{getColorTheme:r}=D();xe(()=>{Me(e.url)&&window.twttr?.widgets?.load(t)});const c=()=>r().brightness==="dark"?"dark":"light";return[n(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const l=sr(),i=l.firstChild,o=t;return typeof o=="function"?L(o,l):t=l,P(s=>{const a=c(),u=ar(e.url);return a!==s._v$&&E(l,"data-theme",s._v$=a),u!==s._v$2&&E(i,"href",s._v$2=u),s},{_v$:void 0,_v$2:void 0}),l})()]},gr=e=>{const{ogp:t}=or(()=>({url:e.url}));return n(b,{get when(){return t()},get fallback(){return n(T,{class:"text-link underline",get href(){return e.url}})},keyed:!0,children:r=>[n(T,{class:"text-link underline",get href(){return e.url}}),n(T,{get href(){return e.url},get children(){const c=lr(),l=c.firstChild,i=l.nextSibling,o=i.firstChild,s=o.nextSibling,a=s.nextSibling;return d(o,()=>new URL(r.url).host),d(s,()=>r.title),d(a,()=>r.description),P(u=>{const h=r.title,m=r.image;return h!==u._v$3&&E(l,"alt",u._v$3=h),m!==u._v$4&&E(l,"src",u._v$4=m),u},{_v$3:void 0,_v$4:void 0}),c}})]})},te=e=>{const t=I(),[r,c]=C(e.initialHidden);return n(b,{get when(){return!r()},get fallback(){return[n(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const l=ir(),i=l.firstChild;return i.$$click=()=>c(!1),d(i,()=>t.t("post.showPreview")),l})()]},get children(){return e.children}})},fr=e=>{const{config:t}=D();return n(U,{get fallback(){return n(T,{class:"text-link underline",get href(){return e.url}})},get children(){return[n(x,{get when(){return _(()=>!!t().embedding.twitter)()&&Me(e.url)},get children(){return n(b,{get when(){return dr()},get fallback(){return n(T,{class:"text-link underline",get href(){return e.url}})},get children(){return n(te,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return n(j,{children:()=>n(hr,{get url(){return e.url}})})}})}})}}),n(x,{get when(){return _(()=>!!t().embedding.youtube)()&&bt(e.url)},keyed:!0,children:({videoId:r})=>n(te,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return n(j,{get fallback(){return n(T,{class:"text-link underline",get href(){return e.url}})},children:()=>[n(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const c=cr(),l=c.firstChild;return P(()=>E(l,"src",ur(r))),c})()]})}})}),n(x,{get when(){return _(()=>!!t().embedding.ogp)()&&Ge(e.url)},get children(){return n(te,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return n(j,{children:()=>n(gr,{get url(){return e.url}})})}})}})]}})};M(["click"]);const vr=g('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),mr=g('<div class="aspect-video max-w-full">'),$r=g('<video class="max-h-64 max-w-full rounded-sm object-contain shadow"controls><a>'),yr=e=>{let t;const r=I(),[c,l]=C(e.initialHidden);return n(b,{get when(){return!c()},get fallback(){return(()=>{const i=vr();return i.$$click=()=>l(!1),d(i,()=>r.t("post.showVideo")),i})()},get children(){return n(j,{get fallback(){return mr()},children:()=>n(T,{class:"my-2 block",get href(){return e.url},get children(){const i=$r(),o=i.firstChild,s=t;return typeof s=="function"?L(s,i):t=i,d(o,()=>r.t("post.download")),P(a=>{const u=e.url,h=e.url;return u!==a._v$&&E(i,"src",a._v$=u),h!==a._v$2&&E(o,"href",a._v$2=h),a},{_v$:void 0,_v$2:void 0}),i}})})}})};M(["click"]);const ne=g("<span>"),be=g('<button class="select-text text-link underline">'),we=g('<div class="my-1 rounded border border-border p-1">'),br=g('<span class="text-link underline">'),wr=g('<img class="inline-block h-8 max-w-32">'),kr=e=>{const{config:t,saveColumn:r}=D(),c=mt(),l=o=>{r(rt({query:o})),c({command:"moveToLastColumn"}).catch(s=>console.error(s))},i=o=>{r(ot({name:o,relayUrls:[o]})),c({command:"moveToLastColumn"}).catch(s=>console.error(s))};return n(Z,{get each(){return e.parsed},children:o=>{if(o.type==="PlainText")return(()=>{const s=ne();return d(s,()=>o.content),s})();if(o.type==="URL"){const s=()=>!t().showMedia||!e.embedding||(e.initialHidden??!1);return wt(o.content)?n(Kn,{get url(){return o.content},get initialHidden(){return s()}}):kt(o.content)?n(yr,{get url(){return o.content},get initialHidden(){return s()}}):_t(o.content)?n(Fn,{get url(){return o.content},get initialHidden(){return s()}}):pt(o.content)?(()=>{const a=be();return a.$$click=()=>i(o.content),d(a,()=>o.content),a})():n(fr,{get url(){return o.content},get initialHidden(){return s()}})}if(o.type==="TagReferenceResolved"){if(o.reference==null)return(()=>{const s=ne();return d(s,()=>o.content),s})();if(o.reference.type==="MentionedUser")return n(ee,{get pubkey(){return o.reference.pubkey}});if(o.reference.type==="MentionedEvent")return e.embedding?n(Qn,{get mentionedEvent(){return o.reference}}):n(F,{get eventId(){return o.reference.eventId}})}if(o.type==="Bech32Entity")return o.data.type==="note"&&e.embedding?(()=>{const s=we();return d(s,n(O,{get eventId(){return o.data.data},actions:!1,embedding:!1,get ensureKinds(){return[Y]}})),s})():o.data.type==="nevent"&&e.embedding?(()=>{const s=we();return d(s,n(O,{get eventId(){return o.data.data.id},actions:!1,embedding:!1})),s})():o.data.type==="npub"?n(ee,{get pubkey(){return o.data.data}}):o.data.type==="nprofile"?n(ee,{get pubkey(){return o.data.data.pubkey}}):(()=>{const s=br();return d(s,()=>o.content),s})();if(o.type==="HashTag")return(()=>{const s=be();return s.$$click=()=>l(o.content),d(s,()=>o.content),s})();if(o.type==="CustomEmojiResolved"){const{url:s,shortcode:a,content:u}=o;if(s==null)return(()=>{const f=ne();return d(f,()=>o.content),f})();const{emojiRef:h,popup:m}=qe(()=>({emoji:{type:"CustomEmoji",url:s,shortcode:a}}));return[_(m),(()=>{const f=wr();return L(h,f),E(f,"src",s),E(f,"alt",u),E(f,"title",a),f})()]}return console.error("Not all ParsedTextNoteNodes are covered",o),null}})};M(["click"]);const ke=2,_r=200,pr=()=>{let e;const[t,r]=C(!1),c=i=>{e=i},l=$t(()=>{e!=null&&r(e.scrollHeight>e.clientHeight+ke||e.scrollHeight>document.documentElement.clientHeight+ke)},_r);return V(()=>{if(e!=null){l();const i=new IntersectionObserver(s=>{s.forEach(a=>{a.isIntersecting&&l()})},{threshold:[0,.25,.5,.75,1]});i.observe(e);const o=()=>l();window.addEventListener("resize",o),Q(()=>{i.disconnect(),window.removeEventListener("resize",o)})}}),{overflow:t,elementRef:c}},xr=g('<div class="author-name truncate pr-1 font-bold hover:underline">'),Er=g('<button class="mt-2 w-full rounded border border-border p-2 text-center text-xs text-fg-secondary shadow-sm hover:bg-bg-tertiary hover:shadow">'),Cr=g('<div class="post flex flex-col"><div class="flex w-full gap-1"><button type=button class="author-icon size-10 shrink-0 overflow-hidden rounded"></button><div class="min-w-0 flex-auto"><div class="flex justify-between gap-1 text-xs"><button type=button class="author flex min-w-0 select-text truncate hover:text-link"><span class="author flex min-w-0 truncate hover:text-link"><div class="author-username truncate text-fg-secondary"></div></span></button><div class="created-at shrink-0"><button type=button class="select-text hover:underline"></button></div></div><div class=overflow-hidden></div><div class=actions>'),Rr=g('<img alt=icon referrerpolicy=no-referrer class="size-full object-cover">'),Tr=e=>{const t=I(),{overflow:r,elementRef:c}=pr(),l=Le(),[i,o]=C(!1),s=()=>l(e.createdAt),a=()=>e.createdAt.toLocaleString(),{profile:u}=Te(()=>({pubkey:e.authorPubkey}));return(()=>{const h=Cr(),m=h.firstChild,f=m.firstChild,$=f.nextSibling,w=$.firstChild,v=w.firstChild,k=v.firstChild,y=k.firstChild,S=v.nextSibling,R=S.firstChild,B=w.nextSibling,ue=B.nextSibling;return f.$$click=p=>{p.preventDefault(),e.onShowProfile?.()},d(f,n(b,{get when(){return u()?.picture},keyed:!0,children:p=>n(j,{children:()=>(()=>{const A=Rr();return P(()=>E(A,"src",Pe(p,"icon"))),A})()})})),v.$$click=p=>{p.preventDefault(),e?.onShowProfile?.()},d(k,n(b,{get when(){return(u()?.display_name?.length??0)>0},get children(){const p=xr();return d(p,()=>u()?.display_name),p}}),y),d(y,n(b,{get when(){return u()?.name!=null},get fallback(){return`@${Se(e.authorPubkey)}`},get children(){return["@",_(()=>u()?.name)]}})),R.$$click=p=>{p.preventDefault(),e.onShowEvent?.()},d(R,s),L(c,B),d(B,()=>e.content),d($,n(b,{get when(){return r()},get children(){const p=Er();return p.$$click=A=>{A.stopPropagation(),o(z=>!z)},d(p,n(b,{get when(){return!i()},get fallback(){return t.t("post.hideOverflow")},get children(){return t.t("post.showOverflow")}})),p}}),ue),d(ue,()=>e.actions),d(h,n(b,{get when(){return e.footer},get children(){return e.footer}}),null),P(p=>{const A=a(),z=!i(),de=!!i();return A!==p._v$&&E(R,"title",p._v$=A),z!==p._v$2&&B.classList.toggle("max-h-screen",p._v$2=z),de!==p._v$3&&B.classList.toggle("max-h-none",p._v$3=de),p},{_v$:void 0,_v$2:void 0,_v$3:void 0}),h})()};M(["click"]);const Sr=lt(),Pr=()=>st(Sr),Kr=()=>{const[e,t]=it({});return{timelineState:e,setTimeline:r=>t("content",r),clearTimeline:()=>t("content",void 0)}},Mr=g("<div class=nostr-textnote>"),Ir=g("<div class=text-xs>"),Dr=g('<div class="content whitespace-pre-wrap break-words">'),jr=g("<div class=textnote-content>"),Lr=g('<div class="mt-1 rounded border border-border p-1">'),Ar=g("<div class=h-12>"),Ur=g('<button class="select-text pr-1 text-link hover:underline">'),Hr=g("<div class=h-5>"),Br=e=>{let t;const r=I(),{showProfile:c}=ie(),l=Pr(),[i,o]=C(!1),s=()=>o(!1),a=()=>{o($=>!$),i()&&t!=null&&t.focus()},u=_(()=>ct(e.event)),h=()=>e.embedding??!0,m=()=>e.actions??!0,f=()=>{if(h()){const $=u().replyingToEvent();if($!=null&&!u().containsEventMention($.id))return $.id;const w=u().rootEvent();if($==null&&w!=null&&!u().containsEventMention(w.id))return w.id}};return(()=>{const $=Mr();return d($,n(Tr,{get authorPubkey(){return u().pubkey},get createdAt(){return u().createdAtAsDate()},get content(){return(()=>{const w=jr();return d(w,n(b,{get when(){return f()},keyed:!0,children:v=>(()=>{const k=Lr();return d(k,n(j,{get fallback(){return Ar()},children:()=>n(O,{eventId:v,actions:!1,embedding:!1})})),k})()}),null),d(w,n(b,{get when(){return u().taggedPubkeys().length>0},get children(){const v=Ir();return d(v,()=>r.t("post.replyToPre"),null),d(v,n(Z,{get each(){return u().taggedPubkeys()},children:k=>(()=>{const y=Ur();return y.$$click=S=>{S.stopPropagation(),c(k)},d(y,n(Ze,{pubkey:k})),y})()}),null),d(v,()=>r.t("post.replyToPost"),null),v}}),null),d(w,n(An,{get contentWarning(){return u().contentWarning()},get children(){const v=Dr();return d(v,n(kr,{get parsed(){return u().parsed()},get embedding(){return h()},get initialHidden(){return u().contentWarning().contentWarning}})),v}}),null),w})()},get actions(){return n(b,{get when(){return m()},get children(){return n(j,{get fallback(){return Hr()},children:()=>n(Mn,{get event(){return e.event},onClickReply:a})})}})},get footer(){return n(b,{get when(){return i()},get children(){return n(yt,{textAreaRef:w=>{t=w},mode:"reply",get replyTo(){return e.event},onClose:s,onPost:s})}})},onShowProfile:()=>{c(u().pubkey)},onShowEvent:()=>{l?.setTimeline({type:"Replies",event:e.event})}})),$})()};M(["click"]);const _e=g("<div><span>"),qr=e=>{const t=I(),r=()=>e.ensureKinds==null||e.ensureKinds.length===0||e.ensureKinds.includes(e.event.kind);return n(U,{get fallback(){return(()=>{const c=_e(),l=c.firstChild;return d(l,()=>t.t("post.unsupportedKind",{kind:e.event.kind})),d(c,n(F,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),c})()},get children(){return[n(x,{get when(){return!r()},keyed:!0,get children(){const c=_e(),l=c.firstChild;return d(l,()=>t.t("post.unexpectedKind",{kind:e.event.kind})),d(c,n(F,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),c}}),n(x,{get when(){return e.event.kind===Y},get children(){return n(Br,{get event(){return e.event},get embedding(){return e.actions},get actions(){return e.actions}})}}),n(x,{get when(){return e.event.kind===at},get children(){return n(Ft,{get event(){return e.event}})}})]}})};export{Ie as A,zt as B,on as C,O as E,Ae as H,j as L,Be as R,Sr as T,Le as a,St as b,qe as c,qr as d,Br as e,Ft as f,Fe as g,Qt as h,kr as i,Ne as j,He as r,Kr as u};
//# sourceMappingURL=EventDisplay-CAsRQATE.js.map
