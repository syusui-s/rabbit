import{t as m,s as A,c as U,i as r,a as n,h as S,d as M,u as E,j as I,F as O,b as F,aF as ge,g as P,aG as pe,aH as k,aI as z,aJ as h,aK as R,aL as be,aM as se,n as ie,aN as $e,aO as he,w as ve,A as ye,aP as _e,aQ as C,aR as xe,aS as we,aT as ke,aU as X,aV as Ce,v as Se}from"./index-9cbshM_8.js";import{A as je}from"./arrow-left-mspiIRQX.js";import{A as Ee,C as Re,U as ae,X as D,b as Ie,g as Le,f as ce,n as Te,k as Ue,P as Fe,F as Me}from"./SideBar-el7yUy1L.js";import{B as de}from"./BasicModal-C5pYuCW6.js";import{L as Z,E as Oe}from"./EventDisplay-CEqmSDPH.js";import{S as Q}from"./SafeLink-BFzf23U-.js";import{s as Pe}from"./url-CEJjbZ3u.js";import"./resolveAsset-C5PFNW9K.js";const Ne=m('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12c1.292 4.338 5.31 7.5 10.066 7.5.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88">'),ze=((e={})=>(()=>{const t=Ne();return A(t,e,!0,!0),t})()),De=m('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128m0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42">'),qe=((e={})=>(()=>{const t=De();return A(t,e,!0,!0),t})()),Be=m('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M5.25 14.25h13.5m-13.5 0a3 3 0 0 1-3-3m3 3a3 3 0 1 0 0 6h13.5a3 3 0 1 0 0-6m-16.5-3a3 3 0 0 1 3-3h13.5a3 3 0 0 1 3 3m-19.5 0a4.5 4.5 0 0 1 .9-2.7L5.737 5.1a3.375 3.375 0 0 1 2.7-1.35h7.126c1.062 0 2.062.5 2.7 1.35l2.587 3.45a4.5 4.5 0 0 1 .9 2.7m0 0a3 3 0 0 1-3 3m0 3h.008v.008h-.008zm0-6h.008v.008h-.008zm-3 6h.008v.008h-.008zm0-6h.008v.008h-.008z">'),Ae=((e={})=>(()=>{const t=Be();return A(t,e,!0,!0),t})()),Ke=m('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m19.5 8.25-7.5 7.5-7.5-7.5">'),Je=((e={})=>(()=>{const t=Ke();return A(t,e,!0,!0),t})()),He=m('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m4.5 15.75 7.5-7.5 7.5 7.5">'),Ge=((e={})=>(()=>{const t=He();return A(t,e,!0,!0),t})()),Ve=m('<div class="border-t border-border p-2">'),Xe=m('<div class="mb-2 rounded-sm border border-border shadow-sm hover:shadow-md"><h3 class="text-lg font-bold"><button type=button class="flex w-full items-center p-2 text-start"><span class="flex-1 hover:text-fg-secondary"></span><span class="inline-block size-4 shrink-0 text-fg">'),j=e=>{const[t,i]=U(e.initialOpened??!0),g=()=>i(f=>!f);return(()=>{const f=Xe(),s=f.firstChild,l=s.firstChild,o=l.firstChild,c=o.nextSibling;return l.$$click=()=>g(),r(o,()=>e.title),r(c,n(S,{get when(){return t()},get fallback(){return n(Je,{})},get children(){return n(Ge,{})}})),r(f,n(S,{get when(){return t()},get children(){const a=Ve();return r(a,()=>e.children),a}}),null),f})()};M(["click"]);const Qe=m('<div class="scrollbar flex flex-col overflow-y-auto rounded-md border border-border">'),Ye=m('<button type=button class="border-t border-border px-2 py-1 text-left first:border-none">'),We=()=>{const e=E(),{config:t,setConfig:i}=I(),g=s=>{const l=t().colorTheme;return l.type==="specific"?l.id===s:!1},f=s=>{i(l=>({...l,colorTheme:{type:"specific",id:s}}))};return n(j,{get title(){return e.t("config.display.colorTheme")},get children(){const s=Qe();return r(s,n(O,{get each(){return Object.values(ge)},children:l=>(()=>{const o=Ye();return o.$$click=()=>f(l.id),r(o,()=>l.name),F(c=>{const a=!!g(l.id),u=!!g(l.id),b=!g(l.id);return a!==c._v$&&o.classList.toggle("bg-primary",c._v$=a),u!==c._v$2&&o.classList.toggle("text-primary-fg",c._v$2=u),b!==c._v$3&&o.classList.toggle("text-fg",c._v$3=b),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),o})()})),s}})};M(["click"]);const Ze=m('<div class="flex flex-col justify-evenly gap-2 sm:flex-row">'),et=m('<div class="flex flex-1 flex-row items-center gap-1 sm:flex-col"><button type=button class="w-48 rounded-sm border border-primary p-2 font-bold sm:w-full"></button><div class=text-xs>'),tt=()=>{const e=E(),{config:t,setConfig:i}=I(),g=[{id:"relative",name:e.t("config.display.relativeTimeNotation"),example:e.t("config.display.relativeTimeNotationExample")},{id:"absolute-short",name:e.t("config.display.absoluteTimeNotationShort"),example:e.t("config.display.absoluteTimeNotationShortExample")},{id:"absolute-long",name:e.t("config.display.absoluteTimeNotationLong"),example:e.t("config.display.absoluteTimeNotationLongExample")}],f=s=>{i(l=>({...l,dateFormat:s}))};return n(j,{get title(){return e.t("config.display.timeNotation")},get children(){const s=Ze();return r(s,n(O,{each:g,children:({id:l,name:o,example:c})=>(()=>{const a=et(),u=a.firstChild,b=u.nextSibling;return u.$$click=()=>f(l),r(u,o),r(b,c),F(d=>{const p=t().dateFormat===l,$=t().dateFormat===l,y=t().dateFormat!==l,w=t().dateFormat!==l;return p!==d._v$&&u.classList.toggle("bg-primary",d._v$=p),$!==d._v$2&&u.classList.toggle("text-primary-fg",d._v$2=$),y!==d._v$3&&u.classList.toggle("bg-bg",d._v$3=y),w!==d._v$4&&u.classList.toggle("text-primary",d._v$4=w),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()})),s}})};M(["click"]);const rt=m('<button class="flex h-[24px] w-[48px] items-center rounded-full border border-primary/80 px-1"><span class="m-[-3px] inline-block size-5 rounded-full border bg-primary-fg shadow-sm">'),N=e=>(()=>{const t=rt();return t.$$click=i=>e.onClick(i),F(i=>{const g=!e.value,f=!e.value,s=!!e.value,l=!!e.value,o=e.value;return g!==i._v$&&t.classList.toggle("bg-bg-tertiary",i._v$=g),f!==i._v$2&&t.classList.toggle("justify-start",i._v$2=f),s!==i._v$3&&t.classList.toggle("bg-primary",i._v$3=s),l!==i._v$4&&t.classList.toggle("justify-end",i._v$4=l),o!==i._v$5&&P(t,"area-label",i._v$5=o),i},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})();M(["click"]);const nt=m("<p>"),lt=m('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1>YouTube</div></div><div class="flex w-full"><div class=flex-1>X (Twitter)</div></div><div class="flex w-full"><div class=flex-1>OGP'),ot=()=>{const e=E(),{config:t,setConfig:i}=I(),g=f=>{i(s=>({...s,embedding:{...s.embedding,[f]:!s.embedding[f]}}))};return n(j,{get title(){return e.t("config.display.embedding")},get children(){return[(()=>{const f=nt();return r(f,()=>e.t("config.display.embeddingDescription")),f})(),(()=>{const f=lt(),s=f.firstChild;s.firstChild;const l=s.nextSibling;l.firstChild;const o=l.nextSibling;return o.firstChild,r(s,n(N,{get value(){return t().embedding.youtube},onClick:()=>g("youtube")}),null),r(l,n(N,{get value(){return t().embedding.twitter},onClick:()=>g("twitter")}),null),r(o,n(N,{get value(){return t().embedding.ogp},onClick:()=>g("ogp")}),null),f})()]}})},st=m('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),it=()=>{const e=E(),{config:t,setConfig:i}=I(),g=()=>{i(l=>({...l,keepOpenPostForm:!(l.keepOpenPostForm??!1)}))},f=()=>{i(l=>({...l,showMedia:!(l.showMedia??!0)}))},s=()=>{i(l=>({...l,hideCount:!(l.hideCount??!1)}))};return n(j,{get title(){return e.t("config.display.others")},get children(){const l=st(),o=l.firstChild,c=o.firstChild,a=o.nextSibling,u=a.firstChild,b=a.nextSibling,d=b.firstChild;return r(c,()=>e.t("config.display.keepOpenPostForm")),r(o,n(N,{get value(){return t().keepOpenPostForm},onClick:()=>g()}),null),r(u,()=>e.t("config.display.showMediaByDefault")),r(a,n(N,{get value(){return t().showMedia},onClick:()=>f()}),null),r(d,()=>e.t("config.display.hideNumbers")),r(b,n(N,{get value(){return t().hideCount},onClick:()=>s()}),null),l}})},at=m('<div class="flex flex-col justify-evenly gap-2"><div class="flex w-full"><div class=flex-1></div></div><div class="flex w-full"><div class=flex-1>'),ct=()=>{const e=E(),{config:t,setConfig:i}=I(),g=()=>{i(s=>({...s,useEmojiReaction:!(s.useEmojiReaction??!1)}))},f=()=>{i(s=>({...s,showEmojiReaction:!(s.showEmojiReaction??!1)}))};return n(j,{get title(){return e.t("config.display.reaction")},get children(){const s=at(),l=s.firstChild,o=l.firstChild,c=l.nextSibling,a=c.firstChild;return r(o,()=>e.t("config.display.enableEmojiReaction")),r(l,n(N,{get value(){return t().useEmojiReaction},onClick:()=>g()}),null),r(a,()=>e.t("config.display.showEmojiReaction")),r(c,n(N,{get value(){return t().showEmojiReaction},onClick:()=>f()}),null),s}})},le=k().length(64).regex(/^[0-9a-f]{64}$/),ee=k().regex(/^\w+$/),dt=z({shortcode:ee,url:k().url(),keywords:h(R(ee))}),ut=z({manifest:be("emojipack_v1"),name:k(),emojis:R(dt),description:h(k()),author:h(le),publisher:h(le)}).refine(e=>Ee(e.emojis,i=>i.shortcode).length===e.emojis.length,{message:"shortcodes should be unique"}),ue=pe(ee,k().url());ut.or(ue);const ft=e=>Object.entries(e).map(([t,i])=>({shortcode:t,url:i})),mt=m("<p>"),gt=m('<form class="flex flex-col gap-2"><textarea class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"name=json placeholder="{ &quot;smiley&quot;: &quot;https://example.com/smiley.png&quot; }"></textarea><button type=submit class="w-24 self-end rounded-sm bg-primary p-2 font-bold text-primary-fg">'),pt=()=>{const e=E(),{saveEmojis:t}=I(),[i,g]=U(""),f=s=>{if(s.preventDefault(),i().length!==0)try{const l=ue.parse(JSON.parse(i())),o=ft(l);t(o),g("")}catch(l){const o=l instanceof Error?`:${l.message}`:"";window.alert(`JSONの読み込みに失敗しました${o}`)}};return n(j,{get title(){return e.t("config.customEmoji.emojiImport")},get children(){return[(()=>{const s=mt();return r(s,()=>e.t("config.customEmoji.emojiImportDescription")),s})(),(()=>{const s=gt(),l=s.firstChild,o=l.nextSibling;return s.addEventListener("submit",f),l.addEventListener("change",c=>g(c.currentTarget.value)),r(o,()=>e.t("config.customEmoji.importEmoji")),F(()=>l.value=i()),s})()]}})},bt=m('<form class="flex flex-col gap-2"><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=shortcode placeholder=smiley pattern=^\\w+$ required></label><label class="flex flex-1 items-center gap-1"><div class=w-9></div><input class="flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=url placeholder=https://example.com/smiley.png required></label><button type=submit class="w-24 self-end rounded-sm bg-primary p-2 font-bold text-primary-fg">'),$t=m('<ul class="mt-4 flex max-h-[40vh] min-h-64 flex-wrap overflow-y-auto border-t border-border">'),ht=m('<div class="flex min-w-24 flex-col items-center rounded-sm border border-border bg-bg shadow-sm"><div class="flex items-center p-1"><img class="h-20 max-w-20 object-contain"></div><div class="p-1 text-center text-sm"></div><div class="w-full border-t border-border"><button type=button class="w-full px-2 py-1 text-danger">'),vt=m('<li class="min-w-0 basis-1/2 sm:basis-1/4"><button type=button class="flex w-full flex-col items-center gap-1 rounded-sm p-2 hover:bg-bg-tertiary/20 hover:shadow-sm"><div class="w-full truncate text-xs text-fg-secondary">'),yt=m("<div class=size-8>"),_t=m('<div class="flex h-8 max-w-8 items-center"><img class=object-contain>'),xt=()=>{const e=E(),{config:t,saveEmoji:i,removeEmoji:g}=I(),[f,s]=U(""),[l,o]=U(""),c=a=>{a.preventDefault(),!(f().length===0||l().length===0)&&(i({shortcode:f(),url:l()}),s(""),o(""))};return n(j,{get title(){return e.t("config.customEmoji.customEmoji")},get children(){return[(()=>{const a=bt(),u=a.firstChild,b=u.firstChild,d=b.nextSibling,p=u.nextSibling,$=p.firstChild,y=$.nextSibling,w=p.nextSibling;return a.addEventListener("submit",c),r(b,()=>e.t("config.customEmoji.shortcode")),d.addEventListener("change",x=>s(x.currentTarget.value)),r($,()=>e.t("config.customEmoji.url")),y.addEventListener("change",x=>o(x.currentTarget.value)),P(y,"pattern",se),r(w,()=>e.t("config.customEmoji.addEmoji")),F(()=>d.value=f()),F(()=>y.value=l()),a})(),(()=>{const a=$t();return r(a,n(O,{get each(){return Object.values(t().customEmojis)},children:({shortcode:u,url:b})=>{const d=Re(()=>({popup:(()=>{const p=ht(),$=p.firstChild,y=$.firstChild,w=$.nextSibling,x=w.nextSibling,L=x.firstChild;return P(y,"src",b),P(y,"alt",u),r(w,u),L.$$click=()=>g(u),r(L,()=>e.t("config.customEmoji.removeEmoji")),p})()}));return(()=>{const p=vt(),$=p.firstChild,y=$.firstChild,w=d.targetRef;return typeof w=="function"?ie(w,p):d.targetRef=p,$.$$click=()=>d.open(),r($,n(Z,{get fallback(){return yt()},children:()=>(()=>{const x=_t(),L=x.firstChild;return P(L,"src",b),P(L,"alt",u),x})()}),y),r(y,u),r(p,()=>d.popup(),null),p})()}})),a})()]}})};M(["click"]);const wt=m('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border focus:border-border focus:ring-primary"type=text name=keyword><button type=submit class="rounded-sm bg-primary p-2 font-bold text-primary-fg">'),fe=m('<ul class="mt-2 flex max-h-[50vh] min-h-64 flex-col overflow-y-auto border-t border-border">'),te=m('<li class="flex items-center border-b border-border pr-4"><div class="flex-1 truncate"></div><button class="size-3 shrink-0">'),kt=m('<form class="flex gap-2"><select name=type class="w-24 appearance-none rounded-sm border border-border bg-bg p-2 font-bold text-primary-fg ring-border focus:border-border focus:ring-primary"><option value=emoji></option><option value=url></option></select><input class="flex-1 rounded-md border border-border bg-bg ring-border focus:border-border focus:ring-primary"type=text name=reaction><button type=submit class="rounded-sm bg-primary p-2 font-bold text-primary-fg">'),Ct=m('<ul class="flex max-h-[50vh] min-h-64 flex-col overflow-y-auto">'),St=m('<ul class="flex max-h-[50vh] min-h-64 flex-col gap-1 overflow-y-auto">'),oe=m("<div class=h-4>"),jt=m('<li class="flex items-center"><div class="flex-1 truncate rounded-sm border border-border p-2"></div><button class=p-4><span class="inline-block size-4">'),Et=()=>{const e=E(),{config:t,addMutedKeyword:i,removeMutedKeyword:g}=I(),[f,s]=U(""),l=o=>{o.preventDefault(),f().length!==0&&(i(f()),s(""))};return n(j,{get title(){return e.t("config.mute.mutedKeywords")},initialOpened:!1,get children(){return[(()=>{const o=wt(),c=o.firstChild,a=c.nextSibling;return o.addEventListener("submit",l),c.addEventListener("change",u=>s(u.currentTarget.value)),r(a,()=>e.t("config.mute.add")),F(()=>c.value=f()),o})(),(()=>{const o=fe();return r(o,n(O,{get each(){return t().mutedKeywords},children:c=>(()=>{const a=te(),u=a.firstChild,b=u.nextSibling;return r(u,c),b.$$click=()=>g(c),r(b,n(D,{})),a})()})),o})()]}})},Rt=()=>{const e=E(),{config:t,addMutedReaction:i,removeMutedReaction:g}=I(),[f,s]=U("emoji"),[l,o]=U(""),c=a=>{if(a.preventDefault(),l().length!==0){switch(f()){case"emoji":i({type:"emoji",emoji:l()});break;case"url":i({type:"url",url:l()});break;default:throw new Error("Unexpected reaction type")}o("")}};return n(j,{get title(){return e.t("config.mute.mutedReactions.mutedReactions")},initialOpened:!1,get children(){return[(()=>{const a=kt(),u=a.firstChild,b=u.firstChild,d=b.nextSibling,p=u.nextSibling,$=p.nextSibling;return a.addEventListener("submit",c),u.addEventListener("change",y=>s(y.currentTarget.value)),r(b,()=>e.t("config.mute.mutedReactions.emoji")),r(d,()=>e.t("config.mute.mutedReactions.url")),p.addEventListener("change",y=>o(y.currentTarget.value)),r($,()=>e.t("config.mute.add")),F(()=>p.value=l()),a})(),(()=>{const a=fe();return r(a,n(O,{get each(){return t().mutedReactions},children:u=>(()=>{const b=te(),d=b.firstChild,p=d.nextSibling;return r(d,n(S,{get when(){return u.type==="emoji"&&u},keyed:!0,children:({emoji:$})=>$}),null),r(d,n(S,{get when(){return u.type==="url"&&u},keyed:!0,children:({url:$})=>$}),null),p.$$click=()=>g(u),r(p,n(D,{})),b})()})),a})()]}})},It=()=>{const e=E(),{config:t,removeMutedPubkey:i,removeMutedThread:g}=I();return[n(j,{get title(){return e.t("config.mute.mutedUsers")},initialOpened:!1,get children(){const f=Ct();return r(f,n(O,{get each(){return t().mutedPubkeys},children:s=>(()=>{const l=te(),o=l.firstChild,c=o.nextSibling;return r(o,n(Z,{get fallback(){return oe()},children:()=>n(ae,{pubkey:s})})),c.$$click=()=>i(s),r(c,n(D,{})),l})()})),f}}),n(Et,{}),n(Rt,{}),n(j,{get title(){return e.t("config.mute.mutedThreads")},initialOpened:!1,get children(){const f=St();return r(f,n(O,{get each(){return t().mutedThreads},children:s=>(()=>{const l=jt(),o=l.firstChild,c=o.nextSibling,a=c.firstChild;return r(o,n(Z,{get fallback(){return oe()},children:()=>n(Oe,{eventId:s,actions:!1,displayForcibly:!0})})),c.$$click=()=>g(s),r(a,n(D,{})),l})()})),f}})]};M(["click"]);const Lt=m('<div class="scrollbar mt-2 flex flex-col divide-y divide-border overflow-y-auto rounded-md border border-border">'),Tt=m('<form class="mt-2 flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=url placeholder=https://...><button type=submit class="rounded-sm bg-primary p-2 font-bold text-primary-fg">'),Ut=m('<button type=button><span class="inline-block size-4">'),Ft=m('<div class="flex px-2 py-1 text-left text-fg"><button type=button class="flex-1 text-start">'),Mt=()=>{const e=E(),{config:t,setFileServer:i,addCustomFileServer:g,removeCustomFileServer:f}=I(),[s,l]=U(""),o=a=>{a.preventDefault(),g({type:"nip96",name:s(),serverUrl:s()}),a.currentTarget.reset()},c=()=>[...$e.map(a=>({...a,custom:!1})),...t().customFileServers.map(a=>({...a,custom:!0}))];return n(j,{get title(){return e.t("config.posting.fileServer")},get children(){return[(()=>{const a=Lt();return r(a,n(O,{get each(){return c()},children:u=>{const b=()=>u.name===t().fileServer.name;return(()=>{const d=Ft(),p=d.firstChild;return p.$$click=()=>i(u),r(p,()=>u.name),r(d,n(S,{get when(){return u.custom},get children(){const $=Ut(),y=$.firstChild;return $.$$click=()=>f(u.name),r(y,n(D,{})),$}}),null),F($=>{const y=!!b(),w=!!b(),x=!b();return y!==$._v$&&d.classList.toggle("bg-primary",$._v$=y),w!==$._v$2&&d.classList.toggle("text-primary-fg",$._v$2=w),x!==$._v$3&&d.classList.toggle("text-fg",$._v$3=x),$},{_v$:void 0,_v$2:void 0,_v$3:void 0}),d})()}})),a})(),(()=>{const a=Tt(),u=a.firstChild,b=u.nextSibling;return a.addEventListener("submit",o),u.addEventListener("change",d=>l(d.currentTarget.value)),P(u,"pattern",se),r(b,()=>e.t("config.posting.addCustomFileServer")),F(()=>u.value=s()),a})()]}})};M(["click"]);const Ot=m('<div class="flex gap-2 py-1"><button class="rounded-sm border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded-sm border border-primary px-4 py-1 font-bold text-primary">'),Pt=m("<input type=file hidden name=config accept=application/json>"),Nt=()=>{let e;const t=E(),i=I(),g=()=>{const o=JSON.stringify(i.config(),null,2),c=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(c),u=new Date().toISOString(),b=document.createElement("a");b.href=a,b.download=`rabbit-${u}.json`,b.click()},f=()=>{e?.click()},s=async o=>{try{const c=await o.text(),a=he.parse(JSON.parse(c));i.setConfig(a),window.alert(t.t("config.account.restored")),window.location.reload()}catch(c){c instanceof Error?window.alert(`${t.t("config.account.failedToRestore")}: ${c.message}`):window.alert(t.t("config.account.failedToRestore"))}},l=o=>{o.preventDefault();const c=[...o.currentTarget.files??[]];if(c.length!==1)return;const a=c[0];s(a).catch(u=>console.log(u))};return n(j,{get title(){return t.t("config.account.backupConfig")},get children(){return[(()=>{const o=Ot(),c=o.firstChild,a=c.nextSibling;return c.$$click=g,r(c,()=>t.t("config.account.save")),a.$$click=f,r(a,()=>t.t("config.account.restore")),o})(),(()=>{const o=Pt();o.addEventListener("change",l);const c=e;return typeof c=="function"?ie(c,o):e=o,o.multiple=!1,o})()]}})};M(["click"]);const zt=m('<div class="flex gap-2 py-1"><button class="rounded-sm border border-primary px-4 py-1 font-bold text-primary"></button><button class="rounded-sm border border-primary px-4 py-1 font-bold text-primary">'),Dt=()=>{const e=E(),t=Ie(),{showProfile:i,showProfileEdit:g}=ce();return n(j,{get title(){return e.t("config.account.profile")},get children(){const f=zt(),s=f.firstChild,l=s.nextSibling;return s.$$click=()=>Le([t()])(([o])=>{i(o)}),r(s,()=>e.t("config.account.openProfile")),l.$$click=()=>g(),r(l,()=>e.t("config.account.editProfile")),f}})};M(["click"]);const qt=z({max_message_length:h(C()),max_subscriptions:h(C()),max_filters:h(C()),max_limit:h(C()),max_subid_length:h(C()),max_event_tags:h(C()),max_content_length:h(C()),min_pow_difficulty:h(C()),auth_required:h(X()),payment_required:h(X()),restricted_writes:h(X()),created_at_lower_limit:h(C()),created_at_upper_limit:h(C())}),Bt=R(z({kinds:R(ke([C(),R(C())])),time:we(C())})),Y=z({amount:C(),unit:k(),period:h(C()),kinds:h(R(C()))}),At=z({admission:h(R(Y)),subscription:h(R(Y)),publication:h(R(Y))}),Kt=z({name:h(k()),description:h(k()),pubkey:h(k().refine(xe)),contact:h(k()),supported_nips:h(R(C())),software:h(k()),version:h(k()),icon:h(k().url()),limitation:h(qt),retention:h(Bt),relay_countries:h(R(k())),language_tags:h(R(k())),tags:h(R(k())),posting_policy:h(k().url()),payments_url:h(k().url()),fees:h(At)}),Jt=e=>{const t=new URL(e);if(t.protocol==="wss:")t.protocol="https";else if(t.protocol==="ws:")t.protocol="http";else throw new Error("unexpected protocol");return t},Ht=async e=>{const t=Jt(e),i=await fetch(t,{headers:{Accept:"application/nostr+json"},mode:"cors"});if(i.status!==200)throw new Error("failed to fetch relay info: status was not 200");const g=await i.json();if(!_e(Kt)(g))throw new Error("failed to fetch relay info: unexpected form of data");return g},me=e=>{const t=ve(e),i=ye(()=>({queryKey:["useRelayInfo",t()],queryFn:({queryKey:g})=>{const[,f]=g;if(f!=null)return Ht(f.relayUrl)},enabled:t()!=null,staleTime:300*1e3,gcTime:2160*60*60*1e3}));return{relayInfo:()=>i.data,query:i}},Gt=m('<div class="scrollbar max-h-24 overflow-scroll px-4 py-2 wrap-break-word whitespace-pre-wrap">'),Vt=m('<pre class="w-full overflow-scroll rounded-lg border border-border p-4">'),Xt=m('<div class="divide-y divide-border"><div class="flex max-w-full items-center gap-4 p-4"><div class="min-w-0 flex-1"><h3 class="truncate text-2xl font-bold"></h3><div class="truncate text-sm"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex divide-x divide-border"><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div><div class="flex-1 shrink-0 px-4 py-2"><div class="text-sm text-fg-secondary"></div></div></div><div class="flex flex-col gap-2 p-4"><button class="rounded-lg border border-border bg-bg-tertiary/20 p-2 text-fg-secondary select-text hover:bg-bg-tertiary">'),Qt=m('<div class="size-16 overflow-hidden rounded-lg shadow-md"><img alt="icon of relay"class="size-full object-cover">'),V=m("<div>"),Yt=m('<div class="wrap-break-word whitespace-normal"><button class="inline underline select-text">'),W=m('<div class="break-all whitespace-pre-wrap">'),Wt=m('<div class="flex-1 shrink-0 border-t border-border px-4 py-2"><div class="text-sm text-fg-secondary"></div><div class="scrollbar flex w-full gap-1 overflow-x-scroll pt-1">'),Zt=m('<span class="inline-block w-12 rounded-xl border border-border py-2 text-center hover:border-fg-tertiary hover:text-fg-secondary">'),er=e=>`https://github.com/nostr-protocol/nips/blob/master/${e.toString(10).padStart(2,"0")}.md`,tr=e=>{const t=E(),{relayInfo:i}=me(()=>({relayUrl:e.relayUrl})),[g,f]=U(!1),s=()=>f(o=>!o),{showProfile:l}=ce();return n(de,{get onClose(){return e.onClose},get children(){const o=Xt(),c=o.firstChild,a=c.firstChild,u=a.firstChild,b=u.nextSibling,d=c.nextSibling,p=d.firstChild,$=p.firstChild,y=p.nextSibling,w=y.firstChild,x=d.nextSibling,L=x.firstChild,K=L.firstChild,J=L.nextSibling,H=J.firstChild,q=x.nextSibling,B=q.firstChild;return r(c,n(S,{get when(){return i()?.icon},keyed:!0,children:v=>(()=>{const _=Qt(),T=_.firstChild;return P(T,"src",v),_})()}),a),r(u,()=>i()?.name??e.relayUrl),r(b,()=>e.relayUrl),r(o,n(S,{get when(){return i()?.description},keyed:!0,get children(){const v=Gt();return r(v,()=>i()?.description),v}}),d),r($,()=>t.t("relayInfo.administrator")),r(p,n(S,{get when(){return i()?.pubkey},get fallback(){return(()=>{const v=V();return r(v,()=>t.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=Yt(),T=_.firstChild;return T.$$click=()=>l(v),r(T,n(ae,{pubkey:v})),_})()}),null),r(w,()=>t.t("relayInfo.contact")),r(y,n(S,{get when(){return i()?.contact},get fallback(){return(()=>{const v=V();return r(v,()=>t.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=W();return r(_,n(Q,{class:"underline",href:v,children:v})),_})()}),null),r(K,()=>t.t("relayInfo.software")),r(L,n(S,{get when(){return i()?.software},get fallback(){return(()=>{const v=V();return r(v,()=>t.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=W();return r(_,n(S,{get when(){return Pe(v)},fallback:v,keyed:!0,children:T=>n(Q,{class:"underline",href:T})})),_})()}),null),r(H,()=>t.t("relayInfo.version")),r(J,n(S,{get when(){return i()?.version},get fallback(){return(()=>{const v=V();return r(v,()=>t.t("relayInfo.unknown")),v})()},keyed:!0,children:v=>(()=>{const _=W();return r(_,v),_})()}),null),r(o,n(S,{get when(){return i()?.supported_nips},keyed:!0,children:v=>(()=>{const _=Wt(),T=_.firstChild,G=T.nextSibling;return r(T,()=>t.t("relayInfo.supportedNips")),r(G,n(O,{each:v,children:re=>n(Q,{get href(){return er(re)},get children(){const ne=Zt();return r(ne,re),ne}})})),_})()}),q),B.$$click=s,r(B,()=>t.t("relayInfo.showJSON")),r(q,n(S,{get when(){return g()},get children(){const v=Vt();return r(v,()=>JSON.stringify(i(),null,2)),v}}),null),o}})};M(["click"]);const rr=m("<p class=py-1>"),nr=m('<form class="flex gap-2"><input class="flex-1 rounded-md border border-border bg-bg ring-border placeholder:text-fg-secondary focus:border-border focus:ring-primary"type=text name=relayUrl placeholder=wss://...><button type=submit class="rounded-sm bg-primary p-2 font-bold text-primary-fg">'),lr=m('<ul class="mt-2 divide-y divide-border rounded-sm border border-border">'),or=m('<button type=button class="rounded-sm bg-primary p-2 font-bold text-primary-fg">'),sr=m('<li class=flex><button class="flex flex-1 items-center truncate rounded-sm py-1 text-start hover:bg-bg-tertiary"><div class="shrink-0 px-2"><span class="inline-block size-2 rounded-full"aria-label=""></span></div><div class="min-w-0 flex-1"><div class=truncate></div><div class="truncate text-xs text-fg-secondary"></div></div></button><button class="flex shrink-0 items-center justify-center ps-4 pe-6"><span class=size-3>'),ir=()=>{const e=E(),{config:t,addRelay:i,removeRelay:g}=I(),f=Te(),[s,l]=U(""),[o,c]=U(null),a=()=>c(null),u=d=>{d.preventDefault(),s().length!==0&&(i(s()),l(""))},b=async()=>{if(window.nostr==null)return;const d=Object.entries(await window.nostr?.getRelays?.()??[]),p=d.map(([x])=>x).join(`
`);if(d.length===0){window.alert(e.t("config.relays.notConfigured"));return}if(!window.confirm(`${e.t("config.relays.askImport")}

${p}`))return;const $=t().relayUrls.length;Se(()=>{d.forEach(([x])=>{i(x)})});const w=t().relayUrls.length-$;window.alert(e.t("config.relays.imported",{count:w}))};return[n(j,{get title(){return e.t("config.relays.relays")},get children(){return[(()=>{const d=rr();return r(d,()=>e.t("config.relays.numOfRelays",{count:t().relayUrls.length})),d})(),(()=>{const d=nr(),p=d.firstChild,$=p.nextSibling;return d.addEventListener("submit",u),p.addEventListener("change",y=>l(y.currentTarget.value)),P(p,"pattern",Ce),r($,()=>e.t("config.relays.addRelay")),F(()=>p.value=s()),d})(),(()=>{const d=lr();return r(d,n(O,{get each(){return t().relayUrls},children:p=>{const{relayInfo:$}=me(()=>({relayUrl:p})),y=()=>f().getRelay(p)?.connected??!1;return(()=>{const w=sr(),x=w.firstChild,L=x.firstChild,K=L.firstChild,J=L.nextSibling,H=J.firstChild,q=H.nextSibling,B=x.nextSibling,v=B.firstChild;return x.$$click=()=>c({type:"RelayInfo",relayUrl:p}),r(H,()=>$()?.name??p),r(q,p),B.$$click=()=>g(p),r(v,n(D,{})),F(_=>{const T=!y(),G=!!y();return T!==_._v$&&K.classList.toggle("bg-rose-500",_._v$=T),G!==_._v$2&&K.classList.toggle("bg-green-500",_._v$2=G),_},{_v$:void 0,_v$2:void 0}),w})()}})),d})()]}}),n(j,{get title(){return e.t("config.relays.importRelays")},get children(){const d=or();return d.$$click=()=>{b().catch(p=>{console.error("failed to import relays",p),window.alert(e.t("config.relays.failedToImport"))})},r(d,()=>e.t("config.relays.importFromExtension")),d}}),n(S,{get when(){return o()},keyed:!0,children:d=>n(S,{get when(){return d.type==="RelayInfo"},get children(){return n(tr,{get relayUrl(){return d.relayUrl},onClose:()=>a()})}})})]};M(["click"]);const ar=m("<div class=p-4>"),cr=m('<h2 class="flex-1 text-center text-lg font-bold">'),dr=m('<ul class="flex flex-col">'),ur=m('<li class=w-full><button class="flex w-full gap-2 py-3 hover:text-primary"><span class="inline-block size-6">'),fr=m('<div class="flex flex-col"><div><button class="pr-4 text-fg hover:text-fg-secondary"><span class="inline-block size-6"></span></button></div><div class="w-full flex-1 pt-4">'),_r=e=>{const t=E(),[i,g]=U(null),f=[{name:()=>t.t("config.account.profile"),icon:()=>n(Ue,{}),render:()=>[n(Dt,{}),n(Nt,{})]},{name:()=>t.t("config.relays.relays"),icon:()=>n(Ae,{}),render:()=>n(ir,{})},{name:()=>t.t("config.posting.posting"),icon:()=>n(Fe,{}),render:()=>n(Mt,{})},{name:()=>t.t("config.display.display"),icon:()=>n(qe,{}),render:()=>[n(We,{}),n(tt,{}),n(ct,{}),n(ot,{}),n(it,{})]},{name:()=>t.t("config.customEmoji.customEmoji"),icon:()=>n(Me,{}),render:()=>[n(xt,{}),n(pt,{})]},{name:()=>t.t("config.mute.mute"),icon:()=>n(ze,{}),render:()=>n(It,{})}],s=()=>{const l=i();return l==null?null:f[l]};return n(de,{get onClose(){return e.onClose},get children(){const l=ar();return r(l,n(S,{get when(){return s()},get fallback(){return[(()=>{const o=cr();return r(o,()=>t.t("config.config")),o})(),(()=>{const o=dr();return r(o,n(O,{each:f,children:(c,a)=>(()=>{const u=ur(),b=u.firstChild,d=b.firstChild;return b.$$click=()=>g(a),r(d,()=>c.icon()),r(b,()=>c.name(),null),u})()})),o})()]},keyed:!0,children:o=>(()=>{const c=fr(),a=c.firstChild,u=a.firstChild,b=u.firstChild,d=a.nextSibling;return u.$$click=()=>g(null),r(b,n(je,{})),r(d,()=>o.render()),c})()})),l}})};M(["click"]);export{_r as default};
//# sourceMappingURL=Config-5kpDNwS3.js.map
