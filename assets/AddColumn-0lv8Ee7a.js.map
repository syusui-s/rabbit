{"version":3,"file":"AddColumn-0lv8Ee7a.js","sources":["../../node_modules/heroicons/24/outline/server.svg","../../src/components/modal/AddColumn.tsx"],"sourcesContent":["export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21.75 17.25v-.228a4.5 4.5 0 0 0-.12-1.03l-2.268-9.64a3.375 3.375 0 0 0-3.285-2.602H7.923a3.375 3.375 0 0 0-3.285 2.602l-2.268 9.64a4.5 4.5 0 0 0-.12 1.03v.228m19.5 0a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3m19.5 0a3 3 0 0 0-3-3H5.25a3 3 0 0 0-3 3m16.5 0h.008v.008h-.008zm-3 0h.008v.008h-.008z\"/></svg>","import { Component, For, Switch, Match, createSignal, type JSX } from 'solid-js';\n\nimport Bell from 'heroicons/24/outline/bell.svg';\nimport GlobeAlt from 'heroicons/24/outline/globe-alt.svg';\nimport Heart from 'heroicons/24/outline/heart.svg';\nimport Home from 'heroicons/24/outline/home.svg';\nimport MagnifyingGlass from 'heroicons/24/outline/magnifying-glass.svg';\nimport Server from 'heroicons/24/outline/server.svg';\nimport User from 'heroicons/24/outline/user.svg';\n// import BookmarkIcon from 'heroicons/24/outline/bookmark.svg';\n// import ChatBubbleLeftRight from 'heroicons/24/outline/chat-bubble-left-right.svg';\n\nimport BasicModal from '@/components/modal/BasicModal';\nimport {\n  createFollowingColumn,\n  createJapanRelaysColumn,\n  createNotificationColumn,\n  createPostsColumn,\n  createReactionsColumn,\n  createRelaysColumn,\n  createSearchColumn,\n} from '@/core/column';\nimport useConfig from '@/core/useConfig';\nimport { useRequestCommand } from '@/hooks/useCommandBus';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport usePubkey from '@/nostr/usePubkey';\nimport ensureNonNull from '@/utils/ensureNonNull';\nimport { isWebSocketUrl } from '@/utils/url';\n\ntype AddColumnProps = {\n  onClose: () => void;\n};\n\ntype AddRelayColumnProps = {\n  addRelaysColumn: (relayUrls: string[]) => void;\n};\n\nconst AddRelaysColumn: Component<AddRelayColumnProps> = (props) => {\n  const i18n = useTranslation();\n  const { config } = useConfig();\n\n  const [relayUrl, setRelayUrl] = createSignal<string>('');\n\n  const handleSubmit: JSX.EventHandler<HTMLFormElement, Event> = (ev) => {\n    ev.preventDefault();\n\n    const url = relayUrl();\n    if (!isWebSocketUrl(url)) {\n      window.alert('Invalid url');\n      return;\n    }\n\n    props.addRelaysColumn([url]);\n  };\n\n  return (\n    <div class=\"p-8\">\n      <form class=\"flex gap-1\" onSubmit={handleSubmit}>\n        <input\n          class=\"flex-1 rounded-md border-border bg-bg placeholder:text-fg-secondary focus:border-border focus:ring-primary\"\n          type=\"text\"\n          name=\"url\"\n          placeholder=\"wss://...\"\n          pattern=\"wss?:\\/\\/.*\"\n          required\n          onChange={(ev) => setRelayUrl(ev.currentTarget.value)}\n        />\n        <button\n          class=\"rounded border border-primary px-4 py-1 font-bold text-primary\"\n          type=\"submit\"\n        >\n          {i18n.t('column.addRelayColumn.add')}\n        </button>\n      </form>\n      <div class=\"flex flex-col items-start gap-1 pt-8\">\n        <For each={config().relayUrls}>\n          {(url) => (\n            <button\n              type=\"button\"\n              class=\"text-fg-secondary hover:text-fg\"\n              onClick={() => props.addRelaysColumn([url])}\n            >\n              {url}\n            </button>\n          )}\n        </For>\n      </div>\n    </div>\n  );\n};\n\nconst AddColumn: Component<AddColumnProps> = (props) => {\n  const i18n = useTranslation();\n  const pubkey = usePubkey();\n  const { saveColumn } = useConfig();\n  const request = useRequestCommand();\n\n  const [detailComponent, setDetailComponent] = createSignal<string | undefined>(undefined);\n\n  const finish = () => {\n    props.onClose();\n    request({ command: 'moveToLastColumn' }).catch((err) => console.error(err));\n  };\n\n  const addFollowingColumn = () => {\n    ensureNonNull([pubkey()] as const)(([pubkeyNonNull]) => {\n      saveColumn(createFollowingColumn({ pubkey: pubkeyNonNull }));\n    });\n    finish();\n  };\n\n  const addNotificationColumn = () => {\n    ensureNonNull([pubkey()] as const)(([pubkeyNonNull]) => {\n      saveColumn(createNotificationColumn({ pubkey: pubkeyNonNull }));\n    });\n    finish();\n  };\n\n  const addJapanRelaysColumn = () => {\n    saveColumn(createJapanRelaysColumn());\n    finish();\n  };\n\n  const addRelaysColumn = (relayUrls: string[]) => {\n    saveColumn(\n      createRelaysColumn({\n        name: relayUrls.join(', '),\n        relayUrls,\n      }),\n    );\n    finish();\n  };\n\n  const addSearchColumn = () => {\n    saveColumn(createSearchColumn({ query: '' }));\n    finish();\n  };\n\n  const addMyPostsColumn = () => {\n    ensureNonNull([pubkey()] as const)(([pubkeyNonNull]) => {\n      saveColumn(createPostsColumn({ pubkey: pubkeyNonNull }));\n    });\n    finish();\n  };\n\n  const addMyReactionsColumn = () => {\n    ensureNonNull([pubkey()] as const)(([pubkeyNonNull]) => {\n      saveColumn(createReactionsColumn({ pubkey: pubkeyNonNull }));\n    });\n    finish();\n  };\n\n  const menu = [\n    {\n      name: () => i18n.t('column.home'),\n      icon: () => <Home />,\n      onSelect: addFollowingColumn,\n    },\n    {\n      name: () => i18n.t('column.notification'),\n      icon: () => <Bell />,\n      onSelect: addNotificationColumn,\n    },\n    {\n      name: () => i18n.t('column.relay'),\n      icon: () => <Server />,\n      onSelect: () => setDetailComponent('AddRelaysColumn'),\n    },\n    {\n      name: () => i18n.t('column.japanese'),\n      icon: () => <GlobeAlt />,\n      onSelect: addJapanRelaysColumn,\n    },\n    {\n      name: () => i18n.t('column.search'),\n      icon: () => <MagnifyingGlass />,\n      onSelect: addSearchColumn,\n    },\n    {\n      name: () => i18n.t('column.myPosts'),\n      icon: () => <User />,\n      onSelect: addMyPostsColumn,\n    },\n    {\n      name: () => i18n.t('column.myReactions'),\n      icon: () => <Heart />,\n      onSelect: addMyReactionsColumn,\n    },\n    // TODO channel <ChatBubbleLeftRight />\n    // TODO bookmark <BookmarkIcon />\n  ];\n\n  return (\n    <BasicModal onClose={props.onClose}>\n      <Switch\n        fallback={\n          <div class=\"flex flex-wrap p-4\">\n            <For each={menu}>\n              {(menuItem) => (\n                <button\n                  class=\"flex basis-1/2 flex-col items-center gap-2 py-8 hover:text-primary sm:basis-1/4\"\n                  onClick={menuItem.onSelect}\n                >\n                  <span class=\"inline-block size-8\">{menuItem.icon()}</span>\n                  {menuItem.name()}\n                </button>\n              )}\n            </For>\n          </div>\n        }\n      >\n        <Match when={detailComponent() === 'AddRelaysColumn'}>\n          <AddRelaysColumn addRelaysColumn={addRelaysColumn} />\n        </Match>\n      </Switch>\n    </BasicModal>\n  );\n};\n\nexport default AddColumn;\n"],"names":["Server","props","_el$","_tmpl$","_$spread","AddRelaysColumn","i18n","useTranslation","config","useConfig","relayUrl","setRelayUrl","createSignal","handleSubmit","ev","preventDefault","url","isWebSocketUrl","window","alert","addRelaysColumn","_el$2","firstChild","_el$3","_el$4","nextSibling","_el$5","addEventListener","currentTarget","value","_$insert","t","_$createComponent","For","each","relayUrls","children","_el$6","_tmpl$2","$$click","AddColumn","pubkey","usePubkey","saveColumn","request","useRequestCommand","detailComponent","setDetailComponent","undefined","finish","onClose","command","catch","err","console","error","addFollowingColumn","ensureNonNull","pubkeyNonNull","createFollowingColumn","addNotificationColumn","createNotificationColumn","addJapanRelaysColumn","createJapanRelaysColumn","createRelaysColumn","name","join","menu","icon","Home","onSelect","Bell","GlobeAlt","MagnifyingGlass","addSearchColumn","createSearchColumn","query","User","addMyPostsColumn","createPostsColumn","Heart","addMyReactionsColumn","createReactionsColumn","BasicModal","Switch","fallback","_el$7","_tmpl$3","menuItem","_el$8","_tmpl$4","_el$9","_$addEventListener","Match","when","_$delegateEvents"],"mappings":"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","x_google_ignoreList":[0]}