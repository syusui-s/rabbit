{"version":3,"mappings":"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","names":["EllipsisVertical","props","_el$","_tmpl$","_$spread","BasicColumnHeader","isSettingsOpened","setIsSettingOpened","createSignal","toggleSettingsOpened","current","_el$2","firstChild","_el$3","_el$4","_el$5","nextSibling","_el$6","_$createComponent","Show","when","icon","keyed","children","_el$7","_tmpl$2","_$insert","name","$$click","settings","_$delegateEvents","relatedEvents","event","ids","id","rootId","rootEvent","push","replyId","replyingToEvent","uniq","RepliesDisplay","config","useConfig","textNote","events","useSubscription","relayUrls","filters","kinds","limit","Timeline","reverse","TimelineContentDisplay","Switch","Match","timelineContent","type","replies","Column","columnDivRef","timelineState","useTimelineState","i18n","useTranslation","width","useHandleCommand","commandType","handler","command","columnIndex","scrollIntoView","behavior","inline","lastColumn","TimelineContext","Provider","value","_ref$","_$use","content","fallback","header","_tmpl$3","timeline","_tmpl$4","clearTimeline","ArrowLeft","t","_el$8","_tmpl$5","_$p","_$classList","ChevronLeft","Trash","ColumnSettingsSection","title","ColumnSettings","saveColumn","removeColumn","moveColumn","request","useRequestCommand","setColumnWidth","column","move","index","catch","console","error","err","_el$9","_el$10","_el$11","_el$12","_el$13","For","each","_el$14","_$effect","_p$","_v$5","_v$6","_v$7","_v$8","classList","toggle","undefined","ChevronRight","_v$","_v$2","_v$3","_v$4","_$setAttribute","memo","setMemo","createRoot","decrypting","setDecrypting","useDecrypt","propsProvider","pubkey","usePubkey","decrypted","setDecrypted","createEffect","encrypted","p","result","Bookmark","bookmark","createMemo","genericEvent","length","bookmarkedEventIdsPrivate","json","log","parseTags","taggedEventIds","warn","bookmarkedEventIds","ColumnItem","EventDisplayById","eventId","ensureKinds","Kind","useParameterizedReplaceableEvent","queryClient","useQueryClient","genQueryKey","query","createQuery","queryKey","signal","currentProps","kind","author","identifier","task","BatchedEventsTask","promise","latest","pickLatestEvent","registerTask","timeout","BookmarkColumn","BookmarkIcon","onClose","ev","FollowingColumn","followingPubkeys","useFollowings","loadMore","useLoadMore","duration","eose","authors","debugId","since","until","eoseLimit","continuous","onEOSE","clientEventFilter","contentFilter","applyContentFilter","setEvents","onMount","onCleanup","Home","LoadMore","ReactionDisplay","formatDate","useFormatDate","shouldMuteEvent","showProfile","useModalState","reaction","lastTaggedEventId","profile","useProfile","reactedEvent","reactedEventQuery","useEvent","ensureNonNull","eventIdNonNull","isRemoved","isSuccess","_$memo","EmojiDisplay","reactionTypes","toReactionTypes","picture","thumbnailUrl","url","UserDisplayName","createdAtAsDate","EventDisplay","ZapReceipt","lazy","__vitePreload","Notification","TextNote","Reaction","Repost","NotificationColumn","notifications","Bell","PostsColumn","User","ReactionsColumn","reactions","Heart","RelaysColumn","GlobeAlt","SearchColumnHeader","setQuery","updateQuery","handleBlur","handleChange","currentTarget","handleSubmit","preventDefault","MagnifyingGlass","addEventListener","SearchColumn","relaysForSearching","search","tags","findIndex","tagName","Columns","columns","columnType","followingColumn","notificationColumn","postsColumn","reactionsColumn","bookmarkColumn","defaultShortcut","createShortcutsMap","shortcuts","map","shortcut","useShortcutKeys","onShortcut","shortcutsMap","handleKeydown","throttle","useMountShortcutKeys","pool","usePool","initializeColumns","Promise","allSettled","relayUrl","relay","ensureRelay","onnotice","msg","onclose","onError","SideBar","GlobalModal"],"ignoreList":[0,4,5],"sources":["../../node_modules/heroicons/24/outline/ellipsis-vertical.svg","../../src/components/column/BasicColumnHeader.tsx","../../src/components/timeline/TimelineContentDisplay.tsx","../../src/components/column/Column.tsx","../../node_modules/heroicons/24/outline/chevron-left.svg","../../node_modules/heroicons/24/outline/trash.svg","../../src/components/column/ColumnSettings.tsx","../../src/nostr/useDecrypt.ts","../../src/components/timeline/Bookmark.tsx","../../src/nostr/useParameterizedReplaceableEvent.ts","../../src/components/column/BookmarkColumn.tsx","../../src/components/column/FollowingColumn.tsx","../../src/components/event/Reaction.tsx","../../src/components/timeline/Notification.tsx","../../src/components/column/NotificationColumn.tsx","../../src/components/column/PostsColumn.tsx","../../src/components/column/ReactionsColumn.tsx","../../src/components/column/RelaysColumn.tsx","../../src/components/column/SearchColumn.tsx","../../src/components/column/Columns.tsx","../../src/hooks/useShortcutKeys.ts","../../src/pages/Home.tsx"],"sourcesContent":["export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5\"/></svg>","import { Component, JSX, Show, createSignal } from 'solid-js';\n\nimport EllipsisVertical from 'heroicons/24/outline/ellipsis-vertical.svg';\n\nexport type BasicColumnHeaderProps = {\n  name: string;\n  icon?: JSX.Element;\n  settings: () => JSX.Element;\n  onClose?: () => void;\n};\n\nconst BasicColumnHeader: Component<BasicColumnHeaderProps> = (props) => {\n  const [isSettingsOpened, setIsSettingOpened] = createSignal(false);\n\n  const toggleSettingsOpened = () => setIsSettingOpened((current) => !current);\n\n  return (\n    <div class=\"flex flex-col\">\n      <div class=\"flex h-8 items-center gap-1\">\n        <h2 class=\"flex min-w-0 flex-1 items-center gap-1 ps-2\">\n          <Show when={props.icon} keyed>\n            {(icon) => <span class=\"inline-block size-4 shrink-0 text-fg-secondary\">{icon}</span>}\n          </Show>\n          <span class=\"truncate\">{props.name}</span>\n        </h2>\n        <button class=\"flex h-full place-items-center px-2\" onClick={() => toggleSettingsOpened()}>\n          <span class=\"inline-block size-4\">\n            <EllipsisVertical />\n          </span>\n        </button>\n      </div>\n      <Show when={isSettingsOpened()}>{props.settings()}</Show>\n    </div>\n  );\n};\n\nexport default BasicColumnHeader;\n","import { Switch, Match, type Component } from 'solid-js';\n\nimport uniq from 'lodash/uniq';\nimport { type Filter } from 'nostr-tools/filter';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport Timeline from '@/components/timeline/Timeline';\nimport { type TimelineContent } from '@/components/timeline/TimelineContext';\nimport useConfig from '@/core/useConfig';\nimport { textNote } from '@/nostr/event';\nimport TextNote from '@/nostr/event/TextNote';\nimport useSubscription from '@/nostr/useSubscription';\n\nconst relatedEvents = (event: TextNote) => {\n  const ids = [event.id];\n\n  const rootId = event.rootEvent()?.id;\n  if (rootId != null) ids.push(rootId);\n\n  const replyId = event.replyingToEvent()?.id;\n  if (replyId != null) ids.push(replyId);\n\n  return uniq(ids);\n};\n\nconst RepliesDisplay: Component<{ event: NostrEvent }> = (props) => {\n  const { config } = useConfig();\n\n  const event = () => textNote(props.event);\n\n  const { events } = useSubscription(() => ({\n    relayUrls: config().relayUrls,\n    filters: [\n      { kinds: [1], ids: relatedEvents(event()), limit: 25 },\n      { kinds: [1], '#e': [props.event.id], limit: 25 } as Filter,\n    ],\n    limit: 200,\n  }));\n\n  return <Timeline events={[...events()].reverse()} />;\n};\n\nconst TimelineContentDisplay: Component<{ timelineContent: TimelineContent }> = (props) => (\n  <Switch>\n    <Match when={props.timelineContent.type === 'Replies' && props.timelineContent} keyed>\n      {(replies) => <RepliesDisplay event={replies.event} />}\n    </Match>\n  </Switch>\n);\n\nexport default TimelineContentDisplay;\n","import { Show, type JSX, type Component } from 'solid-js';\n\nimport ArrowLeft from 'heroicons/24/outline/arrow-left.svg';\n\nimport TimelineContentDisplay from '@/components/timeline/TimelineContentDisplay';\nimport { TimelineContext, useTimelineState } from '@/components/timeline/TimelineContext';\nimport { ColumnWidth } from '@/core/column';\nimport { useHandleCommand } from '@/hooks/useCommandBus';\nimport { useTranslation } from '@/i18n/useTranslation';\n\nexport type ColumnProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  width: ColumnWidth;\n  header: JSX.Element;\n  children: JSX.Element;\n};\n\nconst Column: Component<ColumnProps> = (props) => {\n  let columnDivRef: HTMLDivElement | undefined;\n\n  const timelineState = useTimelineState();\n  const i18n = useTranslation();\n\n  const width = () => props.width ?? 'medium';\n\n  useHandleCommand(() => ({\n    commandType: 'moveToColumn',\n    handler: (command) => {\n      if (command.command === 'moveToColumn' && command.columnIndex === props.columnIndex) {\n        columnDivRef?.scrollIntoView({ behavior: 'smooth', inline: 'center' });\n      }\n    },\n  }));\n\n  useHandleCommand(() => ({\n    commandType: 'moveToLastColumn',\n    handler: () => {\n      if (props.lastColumn) {\n        columnDivRef?.scrollIntoView({ behavior: 'smooth' });\n      }\n    },\n  }));\n\n  return (\n    <TimelineContext.Provider value={timelineState}>\n      <div\n        ref={columnDivRef}\n        class=\"flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none\"\n        classList={{\n          'sm:w-[500px]': width() === 'widest',\n          'sm:w-[360px]': width() === 'wide',\n          'sm:w-[320px]': width() === 'medium',\n          'sm:w-[280px]': width() === 'narrow',\n        }}\n      >\n        <Show\n          when={timelineState.timelineState.content}\n          keyed\n          fallback={\n            <>\n              <div class=\"shrink-0 border-b border-border\">{props.header}</div>\n              <div class=\"scrollbar flex flex-col overflow-y-scroll pb-16\">{props.children}</div>\n            </>\n          }\n        >\n          {(timeline) => (\n            <>\n              <div class=\"flex shrink-0 items-center border-b border-border px-2\">\n                <button\n                  class=\"flex w-full items-center gap-1\"\n                  onClick={() => timelineState?.clearTimeline()}\n                >\n                  <div class=\"inline-block size-4\">\n                    <ArrowLeft />\n                  </div>\n                  <div>{i18n.t('column.back')}</div>\n                </button>\n              </div>\n              <div class=\"scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16\">\n                <TimelineContentDisplay timelineContent={timeline} />\n              </div>\n            </>\n          )}\n        </Show>\n      </div>\n    </TimelineContext.Provider>\n  );\n};\n\nexport default Column;\n","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M15.75 19.5 8.25 12l7.5-7.5\"/></svg>","export default (props = {}) => <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\" aria-hidden=\"true\" data-slot=\"icon\" viewBox=\"0 0 24 24\"{...props}><path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\"/></svg>","import { Component, JSX, For } from 'solid-js';\n\nimport ChevronLeft from 'heroicons/24/outline/chevron-left.svg';\nimport ChevronRight from 'heroicons/24/outline/chevron-right.svg';\nimport Trash from 'heroicons/24/outline/trash.svg';\n\nimport { ColumnType } from '@/core/column';\nimport useConfig from '@/core/useConfig';\nimport { useRequestCommand } from '@/hooks/useCommandBus';\nimport { useTranslation } from '@/i18n/useTranslation';\n\ntype ColumnSettingsProps = {\n  column: ColumnType;\n  columnIndex: number;\n};\n\ntype ColumnSettingsSectionProps = {\n  title: string;\n  children: JSX.Element;\n};\n\nconst ColumnSettingsSection: Component<ColumnSettingsSectionProps> = (props) => (\n  <div class=\"flex flex-col gap-2 border-b border-border p-2\">\n    <div>{props.title}</div>\n    <div>{props.children}</div>\n  </div>\n);\n\nconst ColumnSettings: Component<ColumnSettingsProps> = (props) => {\n  const i18n = useTranslation();\n  const { saveColumn, removeColumn, moveColumn } = useConfig();\n  const request = useRequestCommand();\n\n  const setColumnWidth = (width: ColumnType['width']) => {\n    saveColumn({ ...props.column, width });\n  };\n\n  const move = (index: number) => {\n    moveColumn(props.column.id, index);\n    request({ command: 'moveToColumn', columnIndex: index }).catch((err) => console.error(err));\n  };\n\n  return (\n    <div class=\"flex flex-col border-t border-border\">\n      <ColumnSettingsSection title={i18n.t('column.config.columnWidth')}>\n        <div class=\"scrollbar flex h-9 gap-2 overflow-x-auto\">\n          <For each={['widest', 'wide', 'medium', 'narrow'] as const}>\n            {(width) => (\n              <button\n                class=\"rounded-md border px-4 text-fg-secondary\"\n                classList={{\n                  'border-fg-secondary': props.column.width === width,\n                  'font-bold': props.column.width === width,\n                  'border-border': props.column.width !== width,\n                  'font-normal': props.column.width !== width,\n                }}\n                onClick={() => setColumnWidth(width)}\n              >\n                {i18n.t(`column.config.${width}`)}\n              </button>\n            )}\n          </For>\n        </div>\n      </ColumnSettingsSection>\n      <div class=\"flex h-10 items-center gap-2\">\n        <button\n          class=\"py-4 pl-2\"\n          title={i18n.t('column.config.moveLeft')}\n          onClick={() => move(props.columnIndex - 1)}\n        >\n          <span class=\"inline-block size-4\">\n            <ChevronLeft />\n          </span>\n        </button>\n        <button\n          class=\"py-4 pr-2\"\n          title={i18n.t('column.config.moveRight')}\n          onClick={() => move(props.columnIndex + 1)}\n        >\n          <span class=\"inline-block size-4\">\n            <ChevronRight />\n          </span>\n        </button>\n        <div class=\"flex-1\" />\n        <button\n          class=\"px-2 py-4 text-danger hover:text-rose-600\"\n          title={i18n.t('column.config.removeColumn')}\n          onClick={() => removeColumn(props.column.id)}\n        >\n          <span class=\"inline-block size-4\" aria-label={i18n.t('column.config.removeColumn')}>\n            <Trash />\n          </span>\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default ColumnSettings;\n","import { createEffect, createRoot, createSignal } from 'solid-js';\n\nimport usePubkey from '@/nostr/usePubkey';\n\ntype UseDecryptProps = {\n  encrypted: string;\n};\n\n// eslint-disable-next-line solid/reactivity\nconst [memo, setMemo] = createRoot(() => createSignal<Record<string, string>>({}));\n// eslint-disable-next-line solid/reactivity\nconst [decrypting, setDecrypting] = createRoot(() => createSignal<Record<string, boolean>>({}));\n\nconst useDecrypt = (propsProvider: () => UseDecryptProps | null) => {\n  const pubkey = usePubkey();\n  const [decrypted, setDecrypted] = createSignal<string | null>(null);\n\n  createEffect(() => {\n    const props = propsProvider();\n    if (props == null) return;\n\n    const { encrypted } = props;\n    if (encrypted in memo()) {\n      setDecrypted(memo()[encrypted]);\n      return;\n    }\n\n    const p = pubkey();\n    if (p == null) return;\n\n    if (decrypting()[encrypted]) {\n      return;\n    }\n\n    setDecrypting((current) => ({ ...current, [encrypted]: true }));\n\n    window.nostr?.nip04\n      ?.decrypt?.(p, encrypted)\n      ?.then((result) => {\n        setMemo((current) => ({ ...current, [encrypted]: result }));\n        setDecrypted(result);\n      })\n      .catch((err) => {\n        console.error(`failed to decrypt \"${encrypted}\"`, err);\n      });\n  });\n\n  return decrypted;\n};\n\nexport default useDecrypt;\n","import { For, type Component, createMemo } from 'solid-js';\n\nimport * as Kind from 'nostr-tools/kinds';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport ColumnItem from '@/components/ColumnItem';\nimport EventDisplayById from '@/components/event/EventDisplayById';\nimport { genericEvent } from '@/nostr/event';\nimport { parseTags } from '@/nostr/event/Tags';\nimport useDecrypt from '@/nostr/useDecrypt';\n\nexport type BookmarkProps = {\n  event: NostrEvent;\n};\n\nconst Bookmark: Component<BookmarkProps> = (props) => {\n  const bookmark = createMemo(() => genericEvent(props.event));\n\n  const decrypted = useDecrypt(() => {\n    const { content } = bookmark();\n    if (content == null || content.length === 0) return null;\n    return { id: bookmark().id, encrypted: content };\n  });\n\n  const bookmarkedEventIdsPrivate = () => {\n    const json = decrypted();\n    if (json == null) return [];\n    console.log(json);\n\n    try {\n      return parseTags(json).taggedEventIds();\n    } catch (err) {\n      console.warn(err);\n      return [];\n    }\n  };\n\n  const bookmarkedEventIds = () => bookmark().taggedEventIds();\n\n  return (\n    <For each={[...bookmarkedEventIds(), ...bookmarkedEventIdsPrivate()]}>\n      {(eventId) => (\n        <ColumnItem>\n          <EventDisplayById eventId={eventId} ensureKinds={[Kind.ShortTextNote]} />\n        </ColumnItem>\n      )}\n    </For>\n  );\n};\n\nexport default Bookmark;\n","import { createMemo } from 'solid-js';\n\nimport { createQuery, useQueryClient, type CreateQueryResult } from '@tanstack/solid-query';\nimport { Event as NostrEvent } from 'nostr-tools/pure';\n\nimport { pickLatestEvent } from '@/nostr/event/comparator';\nimport {\n  registerTask,\n  BatchedEventsTask,\n  ParameterizedReplaceableEventTask,\n} from '@/nostr/useBatchedEvents';\nimport timeout from '@/utils/timeout';\n\n// Parameterized Replaceable Event\nexport type UseParameterizedReplaceableEventProps = {\n  kind: number;\n  author: string;\n  identifier: string;\n};\n\nexport type UseParameterizedReplaceableEvent = {\n  event: () => NostrEvent | null;\n  query: CreateQueryResult<NostrEvent | null>;\n};\n\nconst useParameterizedReplaceableEvent = (\n  propsProvider: () => UseParameterizedReplaceableEventProps | null,\n): UseParameterizedReplaceableEvent => {\n  const queryClient = useQueryClient();\n  const props = createMemo(propsProvider);\n  const genQueryKey = () => ['useFollowings', props()] as const;\n\n  const query = createQuery(() => ({\n    queryKey: genQueryKey(),\n    queryFn: ({ queryKey, signal }) => {\n      console.debug('useFollowings');\n      const [, currentProps] = queryKey;\n      if (currentProps == null) return Promise.resolve(null);\n\n      const { kind, author, identifier } = currentProps;\n      const task = new BatchedEventsTask<ParameterizedReplaceableEventTask>({\n        type: 'ParameterizedReplaceableEvent',\n        kind,\n        author,\n        identifier,\n      });\n      const promise = task.firstEventPromise().catch(() => {\n        throw new Error(\n          `parameterized replaceable event not found: ${kind}:${author}:${identifier}`,\n        );\n      });\n      task.onUpdate((events) => {\n        const latest = pickLatestEvent(events);\n        queryClient.setQueryData(queryKey, latest);\n      });\n      registerTask({ task, signal });\n      return timeout(\n        15000,\n        `useParameterizedReplaceableEvent: ${kind}:${author}:${identifier}`,\n      )(promise);\n    },\n    staleTime: 5 * 60 * 1000, // 5 min\n    gcTime: 4 * 60 * 60 * 1000, // 4 hour\n  }));\n\n  const event = () => query.data ?? null;\n\n  return { event, query };\n};\n\nexport default useParameterizedReplaceableEvent;\n","import { Component, Show } from 'solid-js';\n\nimport BookmarkIcon from 'heroicons/24/outline/bookmark.svg';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport Bookmark from '@/components/timeline/Bookmark';\nimport { BookmarkColumnType } from '@/core/column';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useParameterizedReplaceableEvent from '@/nostr/useParameterizedReplaceableEvent';\n\ntype BookmarkColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: BookmarkColumnType;\n};\n\nconst BookmarkColumn: Component<BookmarkColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { removeColumn } = useConfig();\n\n  const { event } = useParameterizedReplaceableEvent(() => ({\n    kind: 30001,\n    author: props.column.pubkey,\n    identifier: props.column.identifier,\n  }));\n\n  // TODO 暗号化されたデータがある場合は復号する\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.bookmark')}\n          icon={<BookmarkIcon />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <Show when={event()} keyed>\n        {(ev) => <Bookmark event={ev} />}\n      </Show>\n    </Column>\n  );\n};\n\nexport default BookmarkColumn;\n","import { Component, createEffect, onCleanup, onMount } from 'solid-js';\n\nimport Home from 'heroicons/24/outline/home.svg';\nimport uniq from 'lodash/uniq';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Timeline from '@/components/timeline/Timeline';\nimport { FollowingColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useFollowings from '@/nostr/useFollowings';\nimport useSubscription from '@/nostr/useSubscription';\n\ntype FollowingColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: FollowingColumnType;\n};\n\nconst FollowingColumn: Component<FollowingColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { config, removeColumn } = useConfig();\n\n  const { followingPubkeys } = useFollowings(() => ({ pubkey: props.column.pubkey }));\n\n  const loadMore = useLoadMore(() => ({\n    duration: 4 * 60 * 60,\n  }));\n\n  const { events, eose } = useSubscription(() => {\n    const authors = uniq([...followingPubkeys()]);\n    if (authors.length === 0) return null;\n    return {\n      debugId: 'following',\n      relayUrls: config().relayUrls,\n      filters: [\n        {\n          kinds: [1, 6],\n          authors,\n          limit: 20,\n          since: loadMore.since(),\n          until: loadMore.until(),\n        },\n      ],\n      eoseLimit: 20,\n      continuous: loadMore.continuous(),\n      onEOSE: () => {\n        console.log('home: eose');\n      },\n      clientEventFilter: (event) => {\n        if (props.column.contentFilter == null) return true;\n        return applyContentFilter(props.column.contentFilter)(event.content);\n      },\n    };\n  });\n\n  createEffect(() => {\n    console.log('home', events());\n    loadMore.setEvents(events());\n  });\n\n  onMount(() => console.log('home timeline mounted'));\n  onCleanup(() => console.log('home timeline unmounted'));\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.home')}\n          icon={<Home />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Timeline events={events()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default FollowingColumn;\n","import { type Component, Show } from 'solid-js';\n\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport EmojiDisplay from '@/components/EmojiDisplay';\nimport EventDisplay from '@/components/event/EventDisplay';\nimport UserDisplayName from '@/components/UserDisplayName';\nimport useConfig from '@/core/useConfig';\nimport useFormatDate from '@/hooks/useFormatDate';\nimport useModalState from '@/hooks/useModalState';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport { reaction } from '@/nostr/event';\nimport useEvent from '@/nostr/useEvent';\nimport useProfile from '@/nostr/useProfile';\nimport ensureNonNull from '@/utils/ensureNonNull';\nimport { thumbnailUrl } from '@/utils/url';\n\ntype ReactionDisplayProps = {\n  event: NostrEvent;\n};\n\nconst ReactionDisplay: Component<ReactionDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const formatDate = useFormatDate();\n  const { shouldMuteEvent } = useConfig();\n  const { showProfile } = useModalState();\n  const event = () => reaction(props.event);\n  const eventId = () => event().lastTaggedEventId();\n\n  const { profile } = useProfile(() => ({\n    pubkey: props.event.pubkey,\n  }));\n\n  const { event: reactedEvent, query: reactedEventQuery } = useEvent(() =>\n    ensureNonNull([eventId()] as const)(([eventIdNonNull]) => ({\n      eventId: eventIdNonNull,\n    })),\n  );\n\n  const isRemoved = () => reactedEventQuery.isSuccess && reactedEvent() == null;\n\n  return (\n    // if the reacted event is not found, it should be a removed event\n    <Show when={!isRemoved() && !shouldMuteEvent(props.event)}>\n      <div class=\"flex items-center gap-1 pl-[2px] text-sm\">\n        <div class=\"notification-icon flex max-w-[64px] place-items-center overflow-hidden\">\n          <EmojiDisplay reactionTypes={event().toReactionTypes()} />\n        </div>\n        <div class=\"notification-user flex flex-1 gap-1 overflow-hidden\">\n          <div class=\"author-icon size-5 shrink-0 overflow-hidden rounded\">\n            <Show when={profile()?.picture} keyed>\n              {(url) => (\n                <img\n                  src={thumbnailUrl(url, 'icon')}\n                  alt=\"icon\"\n                  // TODO autofit\n                  class=\"size-full object-cover\"\n                />\n              )}\n            </Show>\n          </div>\n          <div class=\"flex min-w-0 flex-1 overflow-hidden\">\n            <button\n              class=\"select-text truncate font-bold hover:text-link hover:underline\"\n              onClick={() => showProfile(props.event.pubkey)}\n            >\n              <UserDisplayName pubkey={props.event.pubkey} />\n            </button>\n            <span class=\"shrink-0 whitespace-pre\">{i18n.t('notification.reacted')}</span>\n          </div>\n        </div>\n        <div class=\"text-xs\">{formatDate(event().createdAtAsDate())}</div>\n      </div>\n      <div class=\"notification-event py-1\">\n        <Show\n          when={reactedEvent()}\n          fallback={\n            <div class=\"truncate\">\n              {i18n.t('general.loading')} {eventId()}\n            </div>\n          }\n          keyed\n        >\n          {(ev) => <EventDisplay event={ev} />}\n        </Show>\n      </div>\n    </Show>\n  );\n};\n\nexport default ReactionDisplay;\n","import { For, Switch, Match, lazy, type Component, Show } from 'solid-js';\n\nimport * as Kind from 'nostr-tools/kinds';\nimport { type Event as NostrEvent } from 'nostr-tools/pure';\n\nimport ColumnItem from '@/components/ColumnItem';\nimport Reaction from '@/components/event/Reaction';\nimport Repost from '@/components/event/Repost';\nimport TextNote from '@/components/event/TextNote';\nimport useConfig from '@/core/useConfig';\n\nconst ZapReceipt = lazy(() => import('@/components/event/ZapReceipt'));\n\nexport type NotificationProps = {\n  events: NostrEvent[];\n};\n\nconst Notification: Component<NotificationProps> = (props) => {\n  const { shouldMuteEvent } = useConfig();\n\n  return (\n    <For each={props.events}>\n      {(event) => (\n        <Show when={!shouldMuteEvent(event)}>\n          <Switch fallback={<div>unknown event</div>}>\n            <Match when={event.kind === Kind.ShortTextNote}>\n              <ColumnItem>\n                <TextNote event={event} />\n              </ColumnItem>\n            </Match>\n            <Match when={event.kind === Kind.Reaction}>\n              <ColumnItem>\n                <Reaction event={event} />\n              </ColumnItem>\n            </Match>\n            {/* TODO ちゃんとnotification用のコンポーネント使う */}\n            <Match when={event.kind === Kind.Repost}>\n              <ColumnItem>\n                <Repost event={event} />\n              </ColumnItem>\n            </Match>\n            <Match when={event.kind === Kind.Zap}>\n              <ColumnItem>\n                <ZapReceipt event={event} />\n              </ColumnItem>\n            </Match>\n          </Switch>\n        </Show>\n      )}\n    </For>\n  );\n};\n\nexport default Notification;\n","import { createEffect, Component } from 'solid-js';\n\nimport Bell from 'heroicons/24/outline/bell.svg';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Notification from '@/components/timeline/Notification';\nimport { NotificationColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useSubscription from '@/nostr/useSubscription';\n\ntype NotificationColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: NotificationColumnType;\n};\n\nconst NotificationColumn: Component<NotificationColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { config, removeColumn } = useConfig();\n\n  const loadMore = useLoadMore(() => ({ duration: null }));\n\n  const { events: notifications, eose } = useSubscription(() => ({\n    relayUrls: config().relayUrls,\n    filters: [\n      {\n        kinds: [1, 6, 7, 9735],\n        '#p': [props.column.pubkey],\n        limit: 20,\n        since: loadMore.since(),\n        until: loadMore.until(),\n      },\n    ],\n    eoseLimit: 20,\n    clientEventFilter: (event) => {\n      if (props.column.contentFilter == null) return true;\n      return applyContentFilter(props.column.contentFilter)(event.content);\n    },\n  }));\n\n  createEffect(() => loadMore.setEvents(notifications()));\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.notification')}\n          icon={<Bell />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Notification events={notifications()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default NotificationColumn;\n","import { createEffect, Component } from 'solid-js';\n\nimport User from 'heroicons/24/outline/user.svg';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Timeline from '@/components/timeline/Timeline';\nimport { PostsColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useSubscription from '@/nostr/useSubscription';\n\ntype PostsColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: PostsColumnType;\n};\n\nconst PostsColumn: Component<PostsColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { config, removeColumn } = useConfig();\n\n  const loadMore = useLoadMore(() => ({ duration: null }));\n\n  const { events, eose } = useSubscription(() => ({\n    relayUrls: config().relayUrls,\n    filters: [\n      {\n        kinds: [1, 6],\n        authors: [props.column.pubkey],\n        limit: 10,\n        since: loadMore.since(),\n        until: loadMore.until(),\n      },\n    ],\n    eoseLimit: 10,\n    clientEventFilter: (event) => {\n      if (props.column.contentFilter == null) return true;\n      return applyContentFilter(props.column.contentFilter)(event.content);\n    },\n  }));\n\n  createEffect(() => loadMore.setEvents(events()));\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.posts')}\n          icon={<User />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Timeline events={events()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default PostsColumn;\n","import { createEffect, Component } from 'solid-js';\n\nimport Heart from 'heroicons/24/outline/heart.svg';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Notification from '@/components/timeline/Notification';\nimport { ReactionsColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useSubscription from '@/nostr/useSubscription';\n\ntype ReactionsColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: ReactionsColumnType;\n};\n\nconst ReactionsColumn: Component<ReactionsColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { config, removeColumn } = useConfig();\n\n  const loadMore = useLoadMore(() => ({ duration: null }));\n\n  const { events: reactions, eose } = useSubscription(() => ({\n    relayUrls: config().relayUrls,\n    filters: [\n      {\n        kinds: [7],\n        authors: [props.column.pubkey],\n        limit: 10,\n        since: loadMore.since(),\n        until: loadMore.until(),\n      },\n    ],\n    eoseLimit: 10,\n    clientEventFilter: (event) => {\n      if (props.column.contentFilter == null) return true;\n      return applyContentFilter(props.column.contentFilter)(event.content);\n    },\n  }));\n\n  createEffect(() => loadMore.setEvents(reactions()));\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.reactions')}\n          icon={<Heart />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Notification events={reactions()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default ReactionsColumn;\n","import { createEffect, Component } from 'solid-js';\n\nimport GlobeAlt from 'heroicons/24/outline/globe-alt.svg';\n\nimport BasicColumnHeader from '@/components/column/BasicColumnHeader';\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Timeline from '@/components/timeline/Timeline';\nimport { RelaysColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport useConfig from '@/core/useConfig';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport useSubscription from '@/nostr/useSubscription';\n\ntype RelaysColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: RelaysColumnType;\n};\n\nconst RelaysColumn: Component<RelaysColumnDisplayProps> = (props) => {\n  const i18n = useTranslation();\n  const { removeColumn } = useConfig();\n\n  const loadMore = useLoadMore(() => ({\n    duration: 4 * 60 * 60,\n  }));\n\n  const { events, eose } = useSubscription(() => ({\n    relayUrls: props.column.relayUrls,\n    filters: [\n      {\n        kinds: [1],\n        limit: 20,\n        since: loadMore.since(),\n        until: loadMore.until(),\n      },\n    ],\n    eoseLimit: 20,\n    clientEventFilter: (event) => {\n      if (props.column.contentFilter == null) return true;\n      return applyContentFilter(props.column.contentFilter)(event.content);\n    },\n  }));\n\n  createEffect(() => loadMore.setEvents(events()));\n\n  return (\n    <Column\n      header={\n        <BasicColumnHeader\n          name={props.column.name ?? i18n.t('column.relay')}\n          icon={<GlobeAlt />}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Timeline events={events()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default RelaysColumn;\n","import { Component, createEffect, createSignal, Show, JSX, onMount } from 'solid-js';\n\nimport EllipsisVertical from 'heroicons/24/outline/ellipsis-vertical.svg';\nimport MagnifyingGlass from 'heroicons/24/outline/magnifying-glass.svg';\n\nimport Column from '@/components/column/Column';\nimport ColumnSettings from '@/components/column/ColumnSettings';\nimport LoadMore, { useLoadMore } from '@/components/column/LoadMore';\nimport Timeline from '@/components/timeline/Timeline';\nimport { SearchColumnType } from '@/core/column';\nimport { applyContentFilter } from '@/core/contentFilter';\nimport { relaysForSearching } from '@/core/relayUrls';\nimport useConfig from '@/core/useConfig';\nimport useSubscription from '@/nostr/useSubscription';\n\nexport type SearchColumnHeaderProps = {\n  column: SearchColumnType;\n  settings: () => JSX.Element;\n  onClose?: () => void;\n};\n\nconst SearchColumnHeader: Component<SearchColumnHeaderProps> = (props) => {\n  const [isSettingsOpened, setIsSettingOpened] = createSignal(false);\n  const [query, setQuery] = createSignal('');\n\n  const { saveColumn } = useConfig();\n\n  const toggleSettingsOpened = () => setIsSettingOpened((current) => !current);\n\n  const updateQuery = () => {\n    if (query() === props.column.query) return;\n    saveColumn({ ...props.column, query: query() });\n  };\n\n  const handleBlur: JSX.EventHandler<HTMLInputElement, Event> = () => {\n    updateQuery();\n  };\n\n  const handleChange: JSX.EventHandler<HTMLInputElement, Event> = (ev) => {\n    setQuery(ev.currentTarget.value);\n  };\n\n  const handleSubmit: JSX.EventHandler<HTMLFormElement, SubmitEvent> = (ev) => {\n    ev.preventDefault();\n    updateQuery();\n  };\n\n  onMount(() => {\n    setQuery(props.column.query);\n  });\n\n  return (\n    <div class=\"flex flex-col\">\n      <div class=\"flex h-8 items-center gap-1 px-2\">\n        <h2 class=\"flex items-center gap-1\">\n          <span class=\"inline-block size-4 text-fg-secondary\">\n            <MagnifyingGlass />\n          </span>\n        </h2>\n        <form class=\"flex-1\" onSubmit={handleSubmit}>\n          <input\n            class=\"w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary\"\n            type=\"text\"\n            name=\"query\"\n            value={query()}\n            onChange={handleChange}\n            onBlur={handleBlur}\n          />\n        </form>\n        <button class=\"size-4\" onClick={() => toggleSettingsOpened()}>\n          <EllipsisVertical />\n        </button>\n      </div>\n      <Show when={isSettingsOpened()}>{props.settings()}</Show>\n    </div>\n  );\n};\n\nexport type SearchColumnDisplayProps = {\n  columnIndex: number;\n  lastColumn: boolean;\n  column: SearchColumnType;\n};\n\nconst SearchColumn: Component<SearchColumnDisplayProps> = (props) => {\n  const { removeColumn } = useConfig();\n\n  const loadMore = useLoadMore(() => ({\n    duration: null,\n  }));\n\n  const { events, eose } = useSubscription(() => {\n    const { query } = props.column;\n\n    if (query.length === 0) return null;\n\n    return {\n      relayUrls: relaysForSearching,\n      filters: [\n        {\n          kinds: [1],\n          search: query,\n          limit: 20,\n          since: loadMore.since(),\n          until: loadMore.until(),\n        },\n      ],\n      eoseLimit: 20,\n      clientEventFilter: (event) => {\n        if (event.tags.findIndex(([tagName]) => tagName === 'mostr' || tagName === 'proxy') >= 0)\n          return false;\n        if (props.column.contentFilter == null) return true;\n        return applyContentFilter(props.column.contentFilter)(event.content);\n      },\n    };\n  });\n\n  createEffect(() => {\n    loadMore.setEvents(events());\n  });\n\n  return (\n    <Column\n      header={\n        <SearchColumnHeader\n          column={props.column}\n          settings={() => <ColumnSettings column={props.column} columnIndex={props.columnIndex} />}\n          onClose={() => removeColumn(props.column.id)}\n        />\n      }\n      width={props.column.width}\n      columnIndex={props.columnIndex}\n      lastColumn={props.lastColumn}\n    >\n      <LoadMore loadMore={loadMore} eose={eose()}>\n        <Timeline events={events()} />\n      </LoadMore>\n    </Column>\n  );\n};\n\nexport default SearchColumn;\n","import { For, Switch, Match } from 'solid-js';\n\nimport BookmarkColumn from '@/components/column/BookmarkColumn';\nimport FollowingColumn from '@/components/column/FollowingColumn';\nimport NotificationColumn from '@/components/column/NotificationColumn';\nimport PostsColumn from '@/components/column/PostsColumn';\nimport ReactionsColumn from '@/components/column/ReactionsColumn';\nimport RelaysColumn from '@/components/column/RelaysColumn';\nimport SearchColumn from '@/components/column/SearchColumn';\nimport useConfig from '@/core/useConfig';\n\nconst Columns = () => {\n  const { config } = useConfig();\n\n  return (\n    <div class=\"scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth\">\n      <For each={config().columns}>\n        {(column, index) => {\n          const columnIndex = () => index() + 1;\n          const lastColumn = () => columnIndex() === config().columns.length;\n          return (\n            <Switch>\n              <Match when={column.columnType === 'Following' && column} keyed>\n                {(followingColumn) => (\n                  <FollowingColumn\n                    column={followingColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Notification' && column} keyed>\n                {(notificationColumn) => (\n                  <NotificationColumn\n                    column={notificationColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Posts' && column} keyed>\n                {(postsColumn) => (\n                  <PostsColumn\n                    column={postsColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Reactions' && column} keyed>\n                {(reactionsColumn) => (\n                  <ReactionsColumn\n                    column={reactionsColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Relays' && column} keyed>\n                {(reactionsColumn) => (\n                  <RelaysColumn\n                    column={reactionsColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Bookmark' && column} keyed>\n                {(bookmarkColumn) => (\n                  <BookmarkColumn\n                    column={bookmarkColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n              <Match when={column.columnType === 'Search' && column} keyed>\n                {(reactionsColumn) => (\n                  <SearchColumn\n                    column={reactionsColumn}\n                    columnIndex={columnIndex()}\n                    lastColumn={lastColumn()}\n                  />\n                )}\n              </Match>\n            </Switch>\n          );\n        }}\n      </For>\n    </div>\n  );\n};\n\nexport default Columns;\n","import { onMount, onCleanup } from 'solid-js';\n\nimport throttle from 'lodash/throttle';\n\nimport { useRequestCommand, type Command } from '@/hooks/useCommandBus';\n\ntype Shortcut = { key: string; command: Command };\n\nconst defaultShortcut: Shortcut[] = [\n  { key: 'n', command: { command: 'openPostForm' } },\n  { key: 'h', command: { command: 'moveToPrevColumn' } },\n  { key: 'j', command: { command: 'moveToNextItem' } },\n  { key: 'k', command: { command: 'moveToPrevItem' } },\n  { key: 'l', command: { command: 'moveToNextColumn' } },\n  { key: '1', command: { command: 'moveToColumn', columnIndex: 1 } },\n  { key: '2', command: { command: 'moveToColumn', columnIndex: 2 } },\n  { key: '3', command: { command: 'moveToColumn', columnIndex: 3 } },\n  { key: '4', command: { command: 'moveToColumn', columnIndex: 4 } },\n  { key: '5', command: { command: 'moveToColumn', columnIndex: 5 } },\n  { key: '6', command: { command: 'moveToColumn', columnIndex: 6 } },\n  { key: '7', command: { command: 'moveToColumn', columnIndex: 7 } },\n  { key: '8', command: { command: 'moveToColumn', columnIndex: 8 } },\n  { key: '9', command: { command: 'moveToColumn', columnIndex: 9 } },\n  { key: '0', command: { command: 'moveToLastColumn' } },\n  { key: 'ArrowLeft', command: { command: 'moveToPrevColumn' } },\n  { key: 'ArrowDown', command: { command: 'moveToNextItem' } },\n  { key: 'ArrowUp', command: { command: 'moveToPrevItem' } },\n  { key: 'ArrowRight', command: { command: 'moveToNextColumn' } },\n  { key: 'f', command: { command: 'like' } },\n  { key: 't', command: { command: 'repost' } },\n  { key: 'r', command: { command: 'openReplyForm' } },\n  { key: '?', command: { command: 'openHelp' } },\n  { key: 'Enter', command: { command: 'openItemDetail' } },\n  { key: 'Backspace', command: { command: 'closeItemDetail' } },\n];\n\ntype UseShortcutKeysProps = {\n  shortcuts?: Shortcut[];\n  onShortcut: (shortcut: Shortcut) => void;\n};\n\nconst createShortcutsMap = (shortcuts: Shortcut[]) => {\n  const map = new Map<string, Shortcut>();\n  shortcuts.forEach((shortcut) => {\n    map.set(shortcut.key, shortcut);\n  });\n  return map;\n};\n\nconst useShortcutKeys = ({ shortcuts = defaultShortcut, onShortcut }: UseShortcutKeysProps) => {\n  const shortcutsMap = createShortcutsMap(shortcuts);\n\n  onMount(() => {\n    const handleKeydown = throttle((ev: KeyboardEvent) => {\n      if (ev.type !== 'keydown') return;\n      if (ev.ctrlKey || ev.altKey || ev.metaKey) return;\n      if (ev.target instanceof HTMLTextAreaElement || ev.target instanceof HTMLInputElement) return;\n\n      const shortcut = shortcutsMap.get(ev.key);\n\n      if (shortcut == null) return;\n\n      onShortcut(shortcut);\n    }, 50);\n\n    window.addEventListener('keydown', handleKeydown);\n\n    onCleanup(() => {\n      window.removeEventListener('keydown', handleKeydown);\n    });\n  });\n};\n\nexport const useMountShortcutKeys = () => {\n  const request = useRequestCommand();\n\n  useShortcutKeys({\n    onShortcut: (shortcut) => {\n      request(shortcut.command).then(\n        () => console.debug(`shortcut key '${shortcut.key}' was processed successfully`),\n        (err) => console.error(err),\n      );\n    },\n  });\n};\n\nexport default useShortcutKeys;\n","import { createEffect, type Component, onError } from 'solid-js';\n\nimport Columns from '@/components/column/Columns';\nimport GlobalModal from '@/components/modal/GlobalModal';\nimport SideBar from '@/components/SideBar';\nimport useConfig from '@/core/useConfig';\nimport { useMountShortcutKeys } from '@/hooks/useShortcutKeys';\nimport usePool from '@/nostr/usePool';\nimport usePubkey from '@/nostr/usePubkey';\n\nconst Home: Component = () => {\n  useMountShortcutKeys();\n\n  const pool = usePool();\n  const { config, initializeColumns } = useConfig();\n  const pubkey = usePubkey();\n\n  createEffect(() => {\n    Promise.allSettled(\n      config().relayUrls.map(async (relayUrl) => {\n        try {\n          const relay = await pool().ensureRelay(relayUrl);\n          relay.onnotice = (msg: string) => {\n            console.error(`NOTICE: ${relayUrl}: ${msg}`);\n          };\n          relay.onclose = () => {\n            console.warn(`CLOSE: ${relayUrl}`);\n          };\n        } catch (err) {\n          console.error('ensureRelay failed', err);\n        }\n      }),\n    ).catch(() => {\n      /* nothing to do */\n    });\n  });\n\n  createEffect(() => {\n    // pubkeyが得られてはじめてカラムを初期化できる\n    const p = pubkey();\n    if (p != null) {\n      initializeColumns({ pubkey: p });\n    }\n  });\n\n  onError((err) => {\n    console.error('uncaught error: ', err);\n  });\n\n  return (\n    <div class=\"absolute inset-0 flex h-svh w-screen touch-manipulation flex-row overflow-hidden\">\n      <SideBar />\n      <Columns />\n      <GlobalModal />\n    </div>\n  );\n};\n\nexport default Home;\n"],"file":"assets/Home-CgKPW8A-.js"}