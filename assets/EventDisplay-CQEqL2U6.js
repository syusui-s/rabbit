const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/EventDebugModal-eDjWDaHG.js","assets/index-CZo5L9Hh.js","assets/index-COSNOKCH.css","assets/BasicModal-CAFuda6S.js","assets/SideBar-DutEIroR.js","assets/resolveAsset-CbEZsvEz.js","assets/Copy-CaQRHxEY.js","assets/UserList-Bw7olVr-.js","assets/url-DPIb-kBm.js","assets/SafeLink-hQdOkYrW.js","assets/ZapRequestModal-B_Yv__Q5.js","assets/lud16ToLnurlPayUrl-DrBG8KOA.js","assets/_baseClone-BYZ5WNP-.js","assets/useSubscription-BLu9QNA-.js"])))=>i.map(i=>d[i]);
import{s as U,t as h,w as M,a as r,i as a,f as E,h as y,aO as xe,aP as Xe,A as Q,u as D,aQ as et,j,M as x,ah as tt,S as B,c as R,m as Ee,C as V,q as Re,d as S,x as nt,o as G,F as Z,n as H,aR as rt,R as ot,z as Y,H as W,J as Ce,aS as st,I as oe,_ as se,D as L,b as P,p as K,v as lt,y as J,aT as it,ak as ct,an as at,aj as ut,ai as dt,T as ht,l as gt}from"./index-CZo5L9Hh.js";import{r as ft,t as vt,B as le,g as N,U as mt,f as ie,C as Te,q as ce,s as ae,D as Me,b as X,z as ee,E as $t,l as yt,I as bt,J as wt,i as Pe,v as Se,a as kt,m as _t,N as pt}from"./SideBar-DutEIroR.js";import{S as T}from"./SafeLink-hQdOkYrW.js";import{t as Ie,a as De,p as xt,b as Et,c as Rt,d as Ct,i as Tt}from"./url-DPIb-kBm.js";const Mt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3">'),je=(e={})=>(()=>{const t=Mt();return U(t,e,!0),t})(),Pt=h("<span>"),St=h('<a class="text-link underline">'),It=e=>{try{return xe(e)}catch(t){return console.error("failed to encode event id into Bech32 entity (NIP-19) but ignore",e,t),e}},Dt=(e,t)=>{try{return Xe({id:e,kind:t})}catch(n){return console.error("failed to encode event id into Bech32 entity (NIP-19) but ignore",e,n),e}},O=e=>{const t=M(()=>e.kind==null||e.kind===1?It(e.eventId):Dt(e.eventId,e.kind)),n=()=>t()!==e.eventId?`nostr:${t()}`:null;return r(y,{get when(){return n()},get fallback(){return(()=>{const l=Pt();return a(l,()=>e.eventId),l})()},keyed:!0,children:l=>(()=>{const o=St();return E(o,"href",l),a(o,t),o})()})},jt=e=>{const t=M(e),n=Q(()=>({queryKey:["useEvent",t()],queryFn:({queryKey:o,signal:c})=>{const[,i]=o;if(i==null)return null;const{eventId:s}=i,u=new le({type:"Event",eventId:s}),d=u.firstEventPromise().catch(()=>{throw new Error(`event not found: ${s}`)});return console.log("useEvent",t()),ft({task:u,signal:c}),vt(15e3,`useEvent: ${s}`)(d)},staleTime:4*60*60*1e3,gcTime:4*60*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{event:()=>n.data??null,query:n}},Lt=h("<span>"),At=h("<div class=truncate> "),z=e=>{const t=D(),[n,l]=et(e,["eventId"]),{shouldMuteEvent:o}=j(),{event:c,query:i}=jt(()=>N([n.eventId])(([u])=>({eventId:u}))),s=()=>{const u=c();return e.displayForcibly?!1:u!=null&&o(u)};return r(B,{get fallback(){return(()=>{const u=Lt();return a(u,()=>t.t("post.failedToFetchEvent"),null),a(u,()=>e.eventId,null),u})()},get children(){return[r(x,{get when(){return s()},children:null}),r(x,{get when(){return c()},keyed:!0,children:u=>r(Zr,tt({event:u},l))}),r(x,{get when(){return i.isLoading&&n.eventId},keyed:!0,children:u=>(()=>{const d=At(),g=d.firstChild;return a(d,()=>t.t("general.loading"),g),a(d,r(O,{eventId:u}),null),d})()})]}})},Le=e=>{const[t,n]=R(new Date);return Ee(()=>{const l=setInterval(()=>{n(new Date)},e().interval);V(()=>clearInterval(l))}),t},Ht=e=>{switch(e.kind){case"now":return"now";case"seconds":return`${e.value}s`;case"minutes":return`${e.value}m`;case"hours":return`${e.value}h`;case"days":return`${e.value}d`;case"abs":default:return e.value.toLocaleDateString()}},ge=e=>`${e.getHours()}:${e.getMinutes().toString().padStart(2,"0")}`,qt=e=>{switch(e.kind){case"today":return e.value.toLocaleTimeString();case"yesterday":case"abs":default:return e.value.toLocaleString()}},Bt=e=>{switch(e.kind){case"today":return ge(e.value);case"yesterday":return`昨日 ${ge(e.value)}`;case"abs":default:return e.value.toLocaleString()}},Ut=(e,t)=>Math.round(Number(t)-Number(e))/1e3,Ot=(e,t)=>{const n=Ut(e,t);return n<10?{kind:"now"}:n<60?{kind:"seconds",value:Math.round(n)}:n<3600?{kind:"minutes",value:Math.round(n/60)}:n<86400?{kind:"hours",value:Math.round(n/3600)}:n<604800?{kind:"days",value:Math.round(n/86400)}:{kind:"abs",value:e}},fe=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),zt=e=>new Date(+e-24*60*60*1e3),Ae=(e,t,n)=>fe(e,t)?n({kind:"today",value:e}):fe(e,zt(t))?n({kind:"yesterday",value:e}):n({kind:"abs",value:e}),Ft=(e,t=new Date)=>Ae(e,t,qt),Wt=(e,t=new Date)=>Ae(e,t,Bt),ve=(e,t=new Date,n=Ht)=>n(Ot(e,t)),me=Re(()=>Le(()=>({interval:7e3}))),$e=Re(()=>Le(()=>({interval:60*1e3}))),He=()=>{const{config:e}=j();return t=>{switch(e().dateFormat){case"absolute-long":return Ft(t,$e());case"absolute-short":return Wt(t,$e());case"relative":return ve(t,me());default:return ve(t,me())}}},Kt=h('<div><div class="flex items-center gap-1"><div class="flex shrink-0 place-items-center pl-[2px]"aria-hidden=true><span class="size-4 text-r-repost"></span></div><div class="notification-user flex min-w-0 flex-1 overflow-hidden text-xs"><button class="select-text truncate hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div><div class=text-xs></div></div><div class=pt-1>'),Nt=e=>{const t=D(),{showProfile:n}=ie(),l=He(),o=M(()=>nt(e.event)),c=()=>o().lastTaggedEventId();return(()=>{const i=Kt(),s=i.firstChild,u=s.firstChild,d=u.firstChild,g=u.nextSibling,f=g.firstChild,v=f.nextSibling,w=g.nextSibling,m=s.nextSibling;return a(d,r(je,{})),f.$$click=()=>n(e.event.pubkey),a(f,r(mt,{get pubkey(){return e.event.pubkey}})),a(v,()=>t.t("notification.reposted")),a(w,()=>l(o().createdAtAsDate())),a(m,r(z,{get eventId(){return c()}})),i})()};S(["click"]);const Qt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5z">'),Vt=(e={})=>(()=>{const t=Qt();return U(t,e,!0),t})(),Gt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741z">'),Zt=(e={})=>(()=>{const t=Gt();return U(t,e,!0),t})(),Yt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0m6 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0">'),Jt=(e={})=>(()=>{const t=Yt();return U(t,e,!0),t})(),Xt=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path d="m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z">'),qe=(e={})=>(()=>{const t=Xt();return U(t,e,!0),t})(),en=h("<span class=truncate>"),tn=h('<img class="pointer-events-none h-full w-auto object-contain">'),Be=e=>r(B,{get children(){return[r(x,{get when(){return e.emoji.type==="Emoji"&&e.emoji.content},keyed:!0,children:t=>(()=>{const n=en();return a(n,t),n})()}),r(x,{get when(){return e.emoji.type==="CustomEmoji"&&e.emoji},keyed:!0,children:({shortcode:t,url:n})=>(()=>{const l=tn();return E(l,"src",n),E(l,"alt",`:${t}:`),l})()})]}}),nn=h('<span class="inline-block size-full pt-px text-r-reaction">'),rn=h("<span class=truncate>"),on=e=>e.type==="LikeDislike"&&(e.content==="+"||e.content.length===0),Ue=e=>{if(e.type==="Emoji"||e.type==="CustomEmoji")return e},Oe=e=>r(B,{get fallback(){return(()=>{const t=rn();return a(t,()=>e.reactionTypes.content),t})()},get children(){return[r(x,{get when(){return on(e.reactionTypes)},get children(){const t=nn();return a(t,r(qe,{})),t}}),r(x,{get when(){return Ue(e.reactionTypes)},keyed:!0,children:t=>r(Be,{emoji:t})})]}}),sn=300,ln=e=>{let t,n=!1;return G(()=>{if(t==null)return;const{onLongPress:l,onClick:o,delay:c=sn}=e();let i;const s=()=>{n=!1,i=setTimeout(()=>{n=!0,l()},c)},u=()=>{i!=null&&clearTimeout(i)},d=()=>{s()},g=()=>{u()},f=()=>{n||(u(),o())};t.addEventListener("mousedown",d),t.addEventListener("mouseup",g),t.addEventListener("touchstart",d),t.addEventListener("touchend",g),t.addEventListener("click",f),V(()=>{u(),t?.removeEventListener("mouseddown",d),t?.removeEventListener("mouseup",g),t?.removeEventListener("touchstart",d),t?.removeEventListener("touchend",g),t?.removeEventListener("click",f)})}),{ref:l=>{t=l}}},cn=h('<div><div class="flex h-24 min-w-24 max-w-screen-lg items-center justify-center rounded border border-border bg-bg text-5xl shadow">'),ze=e=>{let t;const n=M(e),[l,o]=R(!1);let c;const i=()=>{setTimeout(()=>{l()||c.close()},100)},s=()=>{c.open()};c=Te(()=>({popup:()=>r(y,{get when(){return n()?.emoji},keyed:!0,children:d=>(()=>{const g=cn(),f=g.firstChild;return g.addEventListener("mouseleave",()=>{o(!1),i()}),g.addEventListener("mouseenter",()=>{o(!0)}),a(f,r(Be,{emoji:d})),g})()}),position:{x:"center",y:"top"}}));const u=ln(()=>({onLongPress:()=>s(),onClick:()=>n()?.onClick?.()}));return G(()=>{t?.addEventListener("mouseenter",s),t?.addEventListener("mouseleave",i)}),{emojiRef:d=>{t=d,c.targetRef(d),u.ref(d)},popup:c.popup}},an=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m8.25 4.5 7.5 7.5-7.5 7.5">'),un=(e={})=>(()=>{const t=an();return U(t,e,!0),t})(),dn=h('<li class="border-b border-border hover:bg-bg-tertiary"><button class="w-full px-4 py-1 text-start">'),hn=h('<li class="border-b border-border hover:bg-bg-tertiary"><button class="flex w-full items-center py-1 pe-2 ps-4 text-start"><span class=flex-1></span><span class="inline-block size-4 shrink-0">'),gn=h('<ul class="min-w-[96px] rounded border border-border bg-bg shadow-md">'),fn=e=>{const t=()=>{e.item?.onSelect?.(),e.onClose()};return(()=>{const n=dn(),l=n.firstChild;return l.$$click=t,a(l,()=>e.item.content),n})()},vn=e=>{const t=Fe(()=>({menu:e.submenu.items,position:{x:"right",y:"bottom"}})),n=()=>{t.open()};return(()=>{const l=hn(),o=l.firstChild,c=o.firstChild,i=c.nextSibling,s=t.targetRef;return typeof s=="function"?H(s,l):t.targetRef=l,o.$$click=n,a(c,()=>e.submenu.content),a(i,r(un,{})),a(l,()=>t.popup(),null),l})()},mn=e=>"onSelect"in e?e:null,$n=e=>"items"in e?e:null,Fe=e=>{const t=M(e),n=Te(()=>({ensureWidth:300,position:{x:"right",y:"bottom"},...t(),popup:(()=>{const l=gn();return a(l,r(Z,{get each(){return t().menu.filter(o=>o.when==null||o.when())},children:o=>r(B,{get children(){return[r(x,{get when(){return mn(o)},keyed:!0,children:c=>r(fn,{item:c,onClose:()=>n.close()})}),r(x,{get when(){return $n(o)},keyed:!0,children:c=>r(vn,{submenu:c,onClose:()=>n.close()})})]}})})),l})()}));return n};S(["click"]);const yn=e=>e.identifier!=null?`${e.kind}:${e.pubkey}:${e.identifier}`:`${e.kind}:${e.pubkey}`,bn=({pubkey:e,identifier:t,reason:n,kind:l})=>{const o=[];return typeof t=="string"?o.push(["e",t]):o.push(["a",yn(t)]),o.push(["k",l.toString()]),{kind:rt,pubkey:e,created_at:ce(),tags:o,content:n??""}},wn=e=>{const t=M(e),{mutation:n,wrapMutate:l}=ae(()=>({mutationKey:["useDeleteMutation",t().id]})),o=l(bn);return{mutation:n,deleteEvent:o}},kn=({pubkey:e,eventId:t,kind:n,reactionTypes:l,notifyPubkey:o})=>{const c=[["e",t,""],["p",o],["k",n.toString()]];return l.type==="CustomEmoji"&&c.push(["emoji",l.shortcode,l.url]),{kind:ot,pubkey:e,created_at:ce(),tags:c,content:l.content}},_n=/\p{Emoji_Presentation}/u,We=e=>["useReactions",e],ue=e=>{const{shouldMuteEvent:t}=j(),n=Y(),l=M(()=>We(e())),o=Q(()=>({queryKey:l(),queryFn:Me({taskProvider:([,d])=>{if(d==null)return null;const{eventId:g}=d;return new le({type:"Reactions",mentionedEventId:g})},queryClient:n}),staleTime:1*60*1e3,gcTime:4*60*60*1e3,refetchInterval:1*60*1e3})),c=()=>(o.data??[]).filter(g=>!t(g));return{reactions:c,reactionsGrouped:()=>{const d=new Map;return c().forEach(g=>{const f=W(g).isCustomEmoji()?`${g.content}${W(g).getUrl()??""}`:g.content,v=d.get(f)??[];v.push(g),d.set(f,v)}),d},isReactedBy:d=>c().findIndex(g=>g.pubkey===d)!==-1,isReactedByWithEmoji:d=>c().findIndex(g=>g.pubkey===d&&_n.test(g.content))!==-1,query:o}},Ke=e=>{const t=Y(),n=M(e),{mutation:l,wrapMutate:o}=ae(()=>({mutationKey:["useReactionMutation",n().eventId],onSuccess:()=>{const i=We({eventId:n().eventId});t.invalidateQueries({queryKey:i}).catch(s=>console.error("failed to invalidate reactions",s))}})),c=o(kn);return{mutation:l,publishReaction:c}},pn=({pubkey:e,eventId:t,kind:n,notifyPubkey:l})=>{const o=[["e",t,""],["p",l]];return n!==1&&o.push(["k",n.toString()]),{kind:n===1?Ce:st,pubkey:e,created_at:ce(),tags:o,content:""}},Ne=e=>["useReposts",e],Qe=e=>{const{shouldMuteEvent:t}=j(),n=Y(),l=M(e),o=M(()=>Ne(l())),c=Q(()=>({queryKey:o(),queryFn:Me({taskProvider:([,u])=>{if(u==null)return null;const{eventId:d}=u;return new le({type:"Reposts",mentionedEventId:d})},queryClient:n}),staleTime:1*60*1e3,gcTime:4*60*60*1e3,refetchInterval:1*60*1e3})),i=()=>(c.data??[]).filter(d=>!t(d));return{reposts:i,isRepostedBy:u=>i().findIndex(d=>d.pubkey===u)!==-1,query:c}},xn=e=>{const t=Y(),n=M(e),{mutation:l,wrapMutate:o}=ae(()=>({mutationKey:["useRepostMutation",n().eventId],onSuccess:()=>{const i=Ne({eventId:n().eventId});t.invalidateQueries({queryKey:i}).catch(s=>console.error("failed to invalidate repost",s))}})),c=o(pn);return{mutation:l,publishRepost:c}},ye=["k","M","G","T","P"],En=(e,t)=>{const n=t?.precision,o=10**((t?.minDigits??4)-1);if(e<o)return{value:e,prefix:null};const c=10**(Math.floor(Math.log10(e)/3)*3),i=e/c;let s=Math.round(i*10**n)/10**n,u=Math.max(Math.floor(Math.log10(e)/3)-1,0);return s>=1e3&&(s/=1e3,u+=1),u>=ye.length?{value:e,prefix:null}:{value:s,prefix:ye[u]}},Ve=(e,t)=>{const{value:n,prefix:l}=En(e,{precision:2,minDigits:t?.minDigits??5});if(l==null)return`${e}`;const o=t?.digits??3,c=Math.floor(Math.log10(n))+1,i=Math.max(o-c,0);return`${Math.round(n*10**i)/10**i}${l}`},Ge=h('<div class="text-sm text-fg-tertiary">'),be=h('<div class="flex shrink-0 items-center gap-1"><button class=size-4>'),Rn=h('<div class="flex shrink-0 items-center gap-1"><button><span class="flex size-4">'),Cn=h('<div class="h-4 min-w-4 max-w-8">'),Tn=h('<div class="scrollbar flex gap-2 overflow-x-auto py-1">'),Mn=h('<span class="ml-1 text-sm">'),Pn=h('<button class="webkit-touch-callout-none flex h-6 touch-pan-x select-none items-center rounded border border-border px-1"type=button><span class="flex h-5 min-w-5 max-w-[128px] items-center justify-center">'),Sn=h("<span class=text-red-500>"),In=h('<div class="actions flex w-64 max-w-full items-center justify-between pt-1"><button class="shrink-0 text-fg-tertiary hover:text-fg-tertiary/70"><span class="flex size-4"></span></button><button type=button><span class="flex size-4 text-fg-tertiary hover:text-r-zap"></span></button><button type=button class="size-4 shrink-0 text-fg-tertiary hover:text-fg-tertiary/70">'),Dn=oe(()=>se(()=>import("./EventDebugModal-eDjWDaHG.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Ze=oe(()=>se(()=>import("./UserList-Bw7olVr-.js"),__vite__mapDeps([7,1,2,4,5,8,3,9]))),jn=oe(()=>se(()=>import("./ZapRequestModal-B_Yv__Q5.js"),__vite__mapDeps([10,1,2,3,4,5,6,11,12,13,9,8]))),Ln=e=>{if(e.native!=null)return{type:"Emoji",content:e.native};if(e.src!=null)return{type:"CustomEmoji",content:`:${e.id}:`,shortcode:e.id,url:e.src};throw new Error("unknown emoji")},An=e=>{const{config:t}=j(),n=X(),[l,o]=R(!1),{reactions:c,isReactedByWithEmoji:i,isReactedBy:s}=ue(()=>({eventId:e.event.id})),u=M(()=>{const $=n();return $!=null&&s($)||l()}),d=M(()=>{const $=n();return $!=null&&i($)}),{mutation:g,publishReaction:f}=Ke(()=>({eventId:e.event.id})),v=$=>{u()||g.isPending||N([n(),e.event.id])(([_,b])=>{f({pubkey:_,reactionTypes:$??{type:"LikeDislike",content:"+"},eventId:b,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{o(!0)}).catch(I=>{window.alert(ee(I))})})},w=$=>{$.stopPropagation(),v()},m=$=>{v(Ln($))},k=$t(()=>({onEmojiSelect:m}));return[(()=>{const $=be(),_=$.firstChild;return _.$$click=w,a(_,r(y,{get when(){return L(()=>!!u())()&&!d()},get fallback(){return r(yt,{})},get children(){return r(qe,{})}})),a($,r(y,{get when(){return L(()=>!t().hideCount&&!t().showEmojiReaction)()&&c().length>0},get children(){const b=Ge();return a(b,()=>Ve(c().length,{minDigits:4})),b}}),null),P(b=>{const I={"text-fg-tertiary":!u()||d(),"hover:text-r-reaction":!u()||d(),"text-r-reaction":u()&&!d()||g.isPending},C=g.isPending;return b._v$=K($,I,b._v$),C!==b._v$2&&(_.disabled=b._v$2=C),b},{_v$:void 0,_v$2:void 0}),$})(),r(y,{get when(){return t().useEmojiReaction},get children(){const $=be(),_=$.firstChild;_.$$click=()=>k.open();const b=k.targetRef;return typeof b=="function"?H(b,_):k.targetRef=_,a(_,r(bt,{})),a($,()=>k.popup(),null),P(I=>K($,{"text-fg-tertiary":!u()||!d(),"hover:text-r-reaction":!u()||!d(),"text-r-reaction":u()&&d()||g.isPending},I)),$}})]},Hn=e=>{const{config:t}=j(),n=X(),[l,o]=R(!1),{reposts:c,isRepostedBy:i}=Qe(()=>({eventId:e.event.id})),s=M(()=>{const f=n();return f!=null&&i(f)||l()}),{mutation:u,publishRepost:d}=xn(()=>({eventId:e.event.id})),g=f=>{if(f.stopPropagation(),s()||u.isPending)return;const v=n(),{id:w}=e.event;v!=null&&w!=null&&d({pubkey:v,eventId:w,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{o(!0)}).catch(m=>{window.alert(ee(m))})};return(()=>{const f=Rn(),v=f.firstChild,w=v.firstChild;return v.$$click=g,a(w,r(je,{})),a(f,r(y,{get when(){return L(()=>!t().hideCount)()&&c().length>0},get children(){const m=Ge();return a(m,()=>Ve(c().length,{minDigits:4})),m}}),null),P(m=>{const k={"text-fg-tertiary":!s(),"hover:text-r-repost":!s(),"text-r-repost":s()||u.isPending},$=u.isPending;return m._v$3=K(f,k,m._v$3),$!==m._v$4&&(v.disabled=m._v$4=$),m},{_v$3:void 0,_v$4:void 0}),f})()},qn=e=>{const{reactions:t}=ue(()=>({eventId:e.event.id}));return r(Ze,{get data(){return t()},pubkeyExtractor:n=>n.pubkey,renderInfo:n=>(()=>{const l=Cn();return a(l,r(Oe,{get reactionTypes(){return W(n).toReactionTypes()}})),l})(),get onClose(){return e.onClose}})},Bn=e=>{const{reposts:t}=Qe(()=>({eventId:e.event.id}));return r(Ze,{get data(){return t()},pubkeyExtractor:n=>n.pubkey,get onClose(){return e.onClose}})},Un=e=>{const{config:t}=j(),n=X(),[l,o]=R(!1),{reactions:c,reactionsGrouped:i,isReactedBy:s}=ue(()=>({eventId:e.event.id})),{mutation:u,publishReaction:d}=Ke(()=>({eventId:e.event.id})),g=()=>{const v=n();return v==null?l():l()||s(v)},f=v=>{g()||u.isPending||N([n(),e.event.id])(([w,m])=>{d({pubkey:w,reactionTypes:v??{type:"LikeDislike",content:"+"},eventId:m,kind:e.event.kind,notifyPubkey:e.event.pubkey}).then(()=>{o(!0)}).catch(k=>{window.alert(ee(k))})})};return r(y,{get when(){return L(()=>!!t().showEmojiReaction)()&&c().length>0},get children(){const v=Tn();return a(v,r(Z,{get each(){return[...i().entries()]},children:([,w])=>{const m=w.findIndex(b=>b.pubkey===n())>=0,k=W(w[0]).toReactionTypes(),$=Ue(k),_=ze(()=>N([$])(([b])=>({emoji:b,onClick:()=>{g()||u.isPending||f(k)}})));return(()=>{const b=Pn(),I=b.firstChild;return H(C=>_.emojiRef(C),b),a(I,r(Oe,{reactionTypes:k})),a(b,r(y,{get when(){return!t().hideCount},get children(){const C=Mn();return a(C,()=>w.length),C}}),null),a(b,()=>_.popup(),null),P(C=>K(b,{"text-fg-tertiary":!m,"hover:bg-r-reaction/10":!m,"hover:border-r-reaction/40":!m,"bg-r-reaction/10":m,"border-r-reaction/40":m,"text-r-reaction":m},C)),b})()}})),v}})},On=e=>{const t=D(),{addMutedThread:n}=j(),l=X(),[o,c]=R(null),i=()=>c(null),{mutation:s,deleteEvent:u}=wn(()=>({id:e.event.id})),d=()=>{lt(()=>{if(n(e.event.id),e.event.kind===J){const f=new it(e.event).rootEvent()?.id;f!=null&&n(f)}})},g=Fe(()=>({menu:[{content:t.t("post.copyEventId"),onSelect:()=>{navigator.clipboard.writeText(xe(e.event.id)).catch(f=>window.alert(f))}},{content:t.t("post.showJSON"),onSelect:()=>{c("EventDebugModal")}},{content:t.t("post.muteThread"),onSelect:()=>d()},{content:t.t("post.showReposts"),onSelect:()=>{c("Reposts")}},{content:t.t("post.showReactions"),onSelect:()=>{c("Reactions")}},{when:()=>e.event.pubkey===l(),content:(()=>{const f=Sn();return a(f,()=>t.t("post.deletePost")),f})(),onSelect:()=>{const f=l();f!=null&&(s.isPending||window.confirm(t.t("post.confirmDelete"))&&u({pubkey:f,identifier:e.event.id,kind:e.event.kind}).then(v=>{v.failed.length===0?window.alert(t.t("post.deletedSuccessfully")):v.succeeded.length>0?window.alert(t.t("post.failedToDeletePartially",{count:v.failed.length})):window.alert(t.t("post.failedToDelete"))}).catch(v=>{window.alert(ee(v))}))}}]}));return[r(Un,{get event(){return e.event}}),(()=>{const f=In(),v=f.firstChild,w=v.firstChild,m=v.nextSibling,k=m.firstChild,$=m.nextSibling;v.$$click=b=>{b.stopPropagation(),e.onClickReply()},a(w,r(Zt,{})),a(f,r(Hn,{get event(){return e.event}}),m),a(f,r(An,{get event(){return e.event}}),m),m.$$click=()=>c("ZapRequest"),a(k,r(Vt,{})),$.$$click=()=>g.open();const _=g.targetRef;return typeof _=="function"?H(_,$):g.targetRef=$,a($,r(Jt,{})),a(f,()=>g.popup(),null),f})(),r(B,{get children(){return[r(x,{get when(){return o()==="EventDebugModal"},get children(){return r(Dn,{get event(){return e.event},onClose:i})}}),r(x,{get when(){return o()==="Reactions"},get children(){return r(qn,{get event(){return e.event},onClose:i})}}),r(x,{get when(){return o()==="Reposts"},get children(){return r(Bn,{get event(){return e.event},onClose:i})}}),r(x,{get when(){return o()==="ZapRequest"},get children(){return r(jn,{get zapTo(){return{event:e.event}},onClose:i})}})]}})]};S(["click"]);const zn=h("<div>"),Fn=h('<button class="text-xs text-fg-secondary hover:text-fg-secondary/70">'),Wn=h("<span>: "),Kn=h('<button class="mt-2 flex w-full flex-col items-center rounded border border-border p-2 text-center text-xs text-fg-secondary"><span class="inline-block size-4"></span><span>'),Nn=e=>{const t=D(),[n,l]=R(!1);return r(y,{get when(){return!e.contentWarning.contentWarning||n()},get fallback(){return(()=>{const o=Kn(),c=o.firstChild,i=c.nextSibling;return o.$$click=()=>l(!0),a(c,r(wt,{})),a(i,()=>t.t("post.contentWarning.show")),a(o,r(y,{get when(){return e.contentWarning.reason!=null},get children(){const s=Wn(),u=s.firstChild;return a(s,()=>t.t("post.contentWarning.reason"),u),a(s,()=>e.contentWarning.reason,null),s}}),null),o})()},get children(){return[(()=>{const o=zn();return a(o,()=>e.children),o})(),r(y,{get when(){return e.contentWarning.contentWarning},get children(){const o=Fn();return o.$$click=()=>l(!1),a(o,()=>t.t("post.contentWarning.hide")),o}})]}})};S(["click"]);const Ye=e=>{const{profile:t}=Pe(()=>({pubkey:e.pubkey}));return r(y,{get when(){return(t()?.name?.length??0)>0},get fallback(){return`@${Se(e.pubkey)}`},get children(){return["@",L(()=>t()?.name??e.pubkey)]}})},Qn=h("<div>"),A=e=>{let t;const[n,l]=R(!1);return G(()=>{const o=new IntersectionObserver(c=>{c.forEach(i=>{i.isIntersecting&&(l(!0),o.disconnect())})},{threshold:e.threshold??0});t!=null&&o.observe(t),V(()=>{o.disconnect()})}),r(y,{get when(){return n()},get fallback(){return(()=>{const o=Qn(),c=t;return typeof c=="function"?H(c,o):t=o,a(o,()=>e.fallback),o})()},keyed:!0,children:o=>e.children()})},Vn=h('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),Gn=h("<div class=max-w-full>"),Zn=h("<audio controls><a>"),Yn=e=>{const t=D(),[n,l]=R(e.initialHidden);return r(y,{get when(){return!n()},get fallback(){return(()=>{const o=Vn();return o.$$click=()=>l(!1),a(o,()=>t.t("post.showAudio")),o})()},get children(){return r(A,{get fallback(){return Gn()},children:()=>r(T,{class:"my-2 block",get href(){return e.url},get children(){const o=Zn(),c=o.firstChild;return a(c,()=>t.t("post.download")),P(i=>{const s=e.url,u=e.url;return s!==i._v$&&E(o,"src",i._v$=s),u!==i._v$2&&E(c,"href",i._v$2=u),i},{_v$:void 0,_v$2:void 0}),o}})})}})};S(["click"]);const Jn=h('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),Xn=h('<div class="aspect-video max-w-full">'),er=h('<img class="max-h-64 max-w-full rounded object-contain shadow hover:shadow-md">'),tr=e=>{let t;const n=D(),[l,o]=R(e.initialHidden),[c,i]=R(!1);return r(y,{get when(){return!l()},get fallback(){return(()=>{const s=Jn();return s.$$click=()=>o(!1),a(s,()=>n.t("post.showImage")),s})()},get children(){return r(A,{get fallback(){return(()=>{const s=Xn();return a(s,r(T,{class:"text-link underline",get href(){return e.url}})),s})()},children:()=>r(y,{get when(){return!c()},get fallback(){return r(T,{class:"text-link underline",get href(){return e.url}})},get children(){return r(T,{class:"my-2 block",get href(){return e.url},get children(){const s=er();s.addEventListener("error",()=>i(!0));const u=t;return typeof u=="function"?H(u,s):t=s,P(d=>{const g=Ie(e.url),f=e.url;return g!==d._v$&&E(s,"src",d._v$=g),f!==d._v$2&&E(s,"alt",d._v$2=f),d},{_v$:void 0,_v$2:void 0}),s}})}})})}})};S(["click"]);const nr=h('<div class="my-1 rounded border p-1">'),rr=e=>r(y,{get when(){return e.mentionedEvent.marker!=null&&e.mentionedEvent.marker.length>0},get fallback(){return r(O,{get eventId(){return e.mentionedEvent.eventId}})},get children(){const t=nr();return a(t,r(A,{children:()=>r(z,{get eventId(){return e.mentionedEvent.eventId},embedding:!1,actions:!1,get ensureKinds(){return[J]}})})),t}}),or=h('<button class="inline select-text text-link underline">'),te=e=>{const{showProfile:t}=ie(),n=()=>{t(e.pubkey)};return(()=>{const l=or();return l.$$click=n,a(l,r(Ye,{get pubkey(){return e.pubkey}})),l})()};S(["click"]);const sr=["www3.nhk.or.jp"],lr=e=>{const t=new TextDecoder("US-ASCII").decode(e.slice(0,1024)),n=t.match(/<meta\s+charset="([-A-Za-z0-9_]+)"/i);if(n!=null)return n[1].toLowerCase();const l=t.match(/<meta\s+http-equiv="Content-Type"\s*content="text\/html;\s*charset=([-A-Za-z0-9_]+)"/i);return l!=null?l[1].toLowerCase():null},ir=new Set(["utf-8","shift_jis","shift-jis","euc-jp","iso-2022-jp"]),cr=e=>{try{const t=lr(e)??"utf-8";if(!ir.has(t))throw new Error(`Unsupported encodings: ${t}`);return new TextDecoder(t).decode(e)}catch(t){throw new Error("Failed to convert charset",{cause:t})}},ar=(e,t)=>{const n={};Array.from(e.head.querySelectorAll("meta")).forEach(s=>{const u=s.getAttribute("property")||s.getAttribute("name"),d=s.getAttribute("content");u!=null&&d!=null&&(n[u]=d)});const l=n["og:image"]||n["twitter:image"],o=n["og:title"]||n["twitter:title"],c=n["og:url"]||t,i=n["og:description"]||n["twitter:description"]||"";return l&&o&&c?{title:o,description:i,image:l,url:c}:null},ur=(e,t)=>{const n=new DOMParser().parseFromString(e,"text/html");return ar(n,t)},Je=e=>new URL(e).protocol==="https:",dr=e=>{const t=new URL(e);return sr.includes(t.hostname)},hr=e=>{if(dr(e))return e;const t=new URL("https://corsproxy.io/");return t.search=new URLSearchParams({url:e}).toString(),t.toString()},gr=async e=>{try{if(!Je(e))return null;const t=hr(e),l=await(await fetch(t,{mode:"cors",headers:{Accept:"text/html"},credentials:"omit"})).arrayBuffer(),o=cr(l);return ur(o,e)}catch(t){return console.error(`failed to fetch ogp for ${e}`,t),null}},fr=e=>{const t=()=>["useOgp",e().url],n=Q(()=>({queryKey:t(),queryFn:({queryKey:[,o]})=>gr(o),staleTime:144e5,gcTime:144e5,refetchOnWindowFocus:!1,refetchOnMount:!1}));return{query:n,ogp:()=>n.data}},vr=h('<blockquote class=twitter-tweet><a class="text-link underline"target=_blank rel="noreferrer noopener">'),mr=h('<div class="my-2 rounded-lg border border-border transition-colors hover:bg-bg-tertiary"><div class="overflow-hidden rounded-t-lg"><img class="max-h-64 w-full object-cover shadow"></div><div class="mb-1 overflow-hidden p-1"><div class="text-xs text-fg-secondary"></div><div class=text-sm></div><div class="max-h-16 truncate whitespace-normal break-all text-xs text-fg-secondary">'),$r=h('<div><button class="flex flex-col items-center rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),yr=h('<div class="my-2 aspect-video w-full"><iframe loading=lazy title=YouTube class="my-2 size-full"allowfullscreen>'),br=e=>{try{const t=new URL(e);return t.host="twitter.com",t.href}catch{return e}},wr=e=>{const t=new URL("https://www.youtube-nocookie.com/embed/");return t.pathname+=e,t.searchParams.set("origin",window.location.origin),t.href},kr=()=>window.twttr!=null,_r=e=>{let t;const{getColorTheme:n}=j();Ee(()=>{De(e.url)&&window.twttr?.widgets?.load(t)});const l=()=>n().brightness==="dark"?"dark":"light";return[r(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const o=vr(),c=o.firstChild,i=t;return typeof i=="function"?H(i,o):t=o,P(s=>{const u=l(),d=br(e.url);return u!==s._v$&&E(o,"data-theme",s._v$=u),d!==s._v$2&&E(c,"href",s._v$2=d),s},{_v$:void 0,_v$2:void 0}),o})()]},pr=e=>{const{ogp:t}=fr(()=>({url:e.url}));return r(y,{get when(){return t()},get fallback(){return r(T,{class:"text-link underline",get href(){return e.url}})},keyed:!0,children:n=>[r(T,{class:"text-link underline",get href(){return e.url}}),r(T,{get href(){return e.url},get children(){const l=mr(),o=l.firstChild,c=o.firstChild,i=o.nextSibling,s=i.firstChild,u=s.nextSibling,d=u.nextSibling;return a(s,()=>new URL(n.url).host),a(u,()=>n.title),a(d,()=>n.description),P(g=>{const f=n.title,v=n.image;return f!==g._v$3&&E(c,"alt",g._v$3=f),v!==g._v$4&&E(c,"src",g._v$4=v),g},{_v$3:void 0,_v$4:void 0}),l}})]})},ne=e=>{const t=D(),[n,l]=R(e.initialHidden);return r(y,{get when(){return!n()},get fallback(){return[r(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const o=$r(),c=o.firstChild;return c.$$click=()=>l(!1),a(c,()=>t.t("post.showPreview")),o})()]},get children(){return e.children}})},xr=e=>{const{config:t}=j();return r(B,{get fallback(){return r(T,{class:"text-link underline",get href(){return e.url}})},get children(){return[r(x,{get when(){return L(()=>!!t().embedding.twitter)()&&De(e.url)},get children(){return r(y,{get when(){return kr()},get fallback(){return r(T,{class:"text-link underline",get href(){return e.url}})},get children(){return r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{children:()=>r(_r,{get url(){return e.url}})})}})}})}}),r(x,{get when(){return L(()=>!!t().embedding.youtube)()&&xt(e.url)},keyed:!0,children:({videoId:n})=>r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{get fallback(){return r(T,{class:"text-link underline",get href(){return e.url}})},children:()=>[r(T,{class:"text-link underline",get href(){return e.url}}),(()=>{const l=yr(),o=l.firstChild;return P(()=>E(o,"src",wr(n))),l})()]})}})}),r(x,{get when(){return L(()=>!!t().embedding.ogp)()&&Je(e.url)},get children(){return r(ne,{get url(){return e.url},get initialHidden(){return e.initialHidden},get children(){return r(A,{children:()=>r(pr,{get url(){return e.url}})})}})}})]}})};S(["click"]);const Er=h('<button class="rounded bg-bg-tertiary p-3 text-xs text-fg-secondary hover:shadow">'),Rr=h('<div class="aspect-video max-w-full">'),Cr=h('<video class="max-h-64 max-w-full rounded-sm object-contain shadow"controls>'),Tr=e=>{let t;const n=D(),[l,o]=R(e.initialHidden),[c,i]=R(!1);return r(y,{get when(){return!l()},get fallback(){return(()=>{const s=Er();return s.$$click=()=>o(!1),a(s,()=>n.t("post.showVideo")),s})()},get children(){return r(A,{get fallback(){return Rr()},children:()=>r(y,{get when(){return!c()},get fallback(){return r(T,{class:"text-link underline",get href(){return e.url},get children(){return e.url}})},get children(){const s=Cr();s.addEventListener("error",()=>i(!0));const u=t;return typeof u=="function"?H(u,s):t=s,a(s,r(T,{class:"text-link underline",get href(){return e.url},get children(){return n.t("post.download")}})),P(()=>E(s,"src",e.url)),s}})})}})};S(["click"]);const re=h("<span>"),we=h('<button class="select-text text-link underline">'),ke=h('<div class="my-1 rounded border border-border p-1">'),Mr=h('<span class="text-link underline">'),Pr=h('<img class="inline-block h-8 max-w-32">'),Sr=e=>{const{config:t,saveColumn:n}=j(),l=kt(),o=i=>{n(ct({query:i})),l({command:"moveToLastColumn"}).catch(s=>console.error(s))},c=i=>{n(at({name:i,relayUrls:[i]})),l({command:"moveToLastColumn"}).catch(s=>console.error(s))};return r(Z,{get each(){return e.parsed},children:i=>{if(i.type==="PlainText")return(()=>{const s=re();return a(s,()=>i.content),s})();if(i.type==="URL"){const s=()=>!t().showMedia||!e.embedding||(e.initialHidden??!1);return Et(i.content)?r(tr,{get url(){return i.content},get initialHidden(){return s()}}):Rt(i.content)?r(Tr,{get url(){return i.content},get initialHidden(){return s()}}):Ct(i.content)?r(Yn,{get url(){return i.content},get initialHidden(){return s()}}):Tt(i.content)?(()=>{const u=we();return u.$$click=()=>c(i.content),a(u,()=>i.content),u})():r(xr,{get url(){return i.content},get initialHidden(){return s()}})}if(i.type==="TagReferenceResolved"){if(i.reference==null)return(()=>{const s=re();return a(s,()=>i.content),s})();if(i.reference.type==="MentionedUser")return r(te,{get pubkey(){return i.reference.pubkey}});if(i.reference.type==="MentionedEvent")return e.embedding?r(rr,{get mentionedEvent(){return i.reference}}):r(O,{get eventId(){return i.reference.eventId}})}if(i.type==="Bech32Entity")return i.data.type==="note"&&e.embedding?(()=>{const s=ke();return a(s,r(z,{get eventId(){return i.data.data},actions:!1,embedding:!1,get ensureKinds(){return[J]}})),s})():i.data.type==="nevent"&&e.embedding?(()=>{const s=ke();return a(s,r(z,{get eventId(){return i.data.data.id},actions:!1,embedding:!1})),s})():i.data.type==="npub"?r(te,{get pubkey(){return i.data.data}}):i.data.type==="nprofile"?r(te,{get pubkey(){return i.data.data.pubkey}}):(()=>{const s=Mr();return a(s,()=>i.content),s})();if(i.type==="HashTag")return(()=>{const s=we();return s.$$click=()=>o(i.content),a(s,()=>i.content),s})();if(i.type==="CustomEmojiResolved"){const{url:s,shortcode:u,content:d}=i;if(s==null)return(()=>{const v=re();return a(v,()=>i.content),v})();const{emojiRef:g,popup:f}=ze(()=>({emoji:{type:"CustomEmoji",url:s,shortcode:u}}));return[L(f),(()=>{const v=Pr();return H(g,v),E(v,"src",s),E(v,"alt",d),E(v,"title",u),v})()]}return console.error("Not all ParsedTextNoteNodes are covered",i),null}})};S(["click"]);const _e=2,Ir=200,Dr=()=>{let e;const[t,n]=R(!1),l=c=>{e=c},o=_t(()=>{e!=null&&n(e.scrollHeight>e.clientHeight+_e||e.scrollHeight>document.documentElement.clientHeight+_e)},Ir);return G(()=>{if(e!=null){o();const c=new IntersectionObserver(s=>{s.forEach(u=>{u.isIntersecting&&o()})},{threshold:[0,.25,.5,.75,1]});c.observe(e);const i=()=>o();window.addEventListener("resize",i),V(()=>{c.disconnect(),window.removeEventListener("resize",i)})}}),{overflow:t,elementRef:l}},jr=h('<div class="author-name truncate pr-1 font-bold hover:underline">'),Lr=h('<button class="mt-2 w-full rounded border border-border p-2 text-center text-xs text-fg-secondary shadow-sm hover:bg-bg-tertiary hover:shadow">'),Ar=h('<div class="post flex flex-col"><div class="flex w-full gap-1"><button type=button class="author-icon size-10 shrink-0 overflow-hidden rounded"></button><div class="min-w-0 flex-auto"><div class="flex justify-between gap-1 text-xs"><button type=button class="author flex min-w-0 select-text truncate hover:text-link"><span class="author flex min-w-0 truncate hover:text-link"><div class="author-username truncate text-fg-secondary"></div></span></button><div class="created-at shrink-0"><button type=button class="select-text hover:underline"></button></div></div><div class=overflow-hidden></div><div class=actions>'),Hr=h('<img alt=icon referrerpolicy=no-referrer class="size-full object-cover">'),qr=e=>{const t=D(),{overflow:n,elementRef:l}=Dr(),o=He(),[c,i]=R(!1),s=()=>o(e.createdAt),u=()=>e.createdAt.toLocaleString(),{profile:d}=Pe(()=>({pubkey:e.authorPubkey}));return(()=>{const g=Ar(),f=g.firstChild,v=f.firstChild,w=v.nextSibling,m=w.firstChild,k=m.firstChild,$=k.firstChild,_=$.firstChild,b=k.nextSibling,I=b.firstChild,C=m.nextSibling,de=C.nextSibling;return v.$$click=p=>{p.preventDefault(),e.onShowProfile?.()},a(v,r(y,{get when(){return d()?.picture},keyed:!0,children:p=>r(A,{children:()=>(()=>{const q=Hr();return P(()=>E(q,"src",Ie(p,"icon"))),q})()})})),k.$$click=p=>{p.preventDefault(),e?.onShowProfile?.()},a($,r(y,{get when(){return(d()?.display_name?.length??0)>0},get children(){const p=jr();return a(p,()=>d()?.display_name),p}}),_),a(_,r(y,{get when(){return d()?.name!=null},get fallback(){return`@${Se(e.authorPubkey)}`},get children(){return["@",L(()=>d()?.name)]}})),I.$$click=p=>{p.preventDefault(),e.onShowEvent?.()},a(I,s),H(l,C),a(C,()=>e.content),a(w,r(y,{get when(){return n()},get children(){const p=Lr();return p.$$click=q=>{q.stopPropagation(),i(F=>!F)},a(p,r(y,{get when(){return!c()},get fallback(){return t.t("post.hideOverflow")},get children(){return t.t("post.showOverflow")}})),p}}),de),a(de,()=>e.actions),a(g,r(y,{get when(){return e.footer},get children(){return e.footer}}),null),P(p=>{const q=u(),F=!c(),he=!!c();return q!==p._v$&&E(I,"title",p._v$=q),F!==p._v$2&&C.classList.toggle("max-h-screen",p._v$2=F),he!==p._v$3&&C.classList.toggle("max-h-none",p._v$3=he),p},{_v$:void 0,_v$2:void 0,_v$3:void 0}),g})()};S(["click"]);const Br=dt(),Ur=()=>ut(Br),to=()=>{const[e,t]=ht({});return{timelineState:e,setTimeline:n=>t("content",n),clearTimeline:()=>t("content",void 0)}},Or=h("<div class=nostr-textnote>"),zr=h("<div class=text-xs>"),Fr=h('<div class="content whitespace-pre-wrap break-words">'),Wr=h("<div class=textnote-content>"),Kr=h('<div class="mt-1 rounded border border-border p-1">'),Nr=h("<div class=h-12>"),Qr=h('<button class="select-text pr-1 text-link hover:underline">'),Vr=h("<div class=h-5>"),Gr=e=>{let t;const n=D(),{showProfile:l}=ie(),o=Ur(),[c,i]=R(!1),s=()=>i(!1),u=()=>{i(w=>!w),c()&&t!=null&&t.focus()},d=M(()=>gt(e.event)),g=()=>e.embedding??!0,f=()=>e.actions??!0,v=()=>{if(g()){const w=d().replyingToEvent();if(w!=null&&!d().containsEventMention(w.id))return w.id;const m=d().rootEvent();if(w==null&&m!=null&&!d().containsEventMention(m.id))return m.id}};return(()=>{const w=Or();return a(w,r(qr,{get authorPubkey(){return d().pubkey},get createdAt(){return d().createdAtAsDate()},get content(){return(()=>{const m=Wr();return a(m,r(y,{get when(){return v()},keyed:!0,children:k=>(()=>{const $=Kr();return a($,r(A,{get fallback(){return Nr()},children:()=>r(z,{eventId:k,actions:!1,embedding:!1})})),$})()}),null),a(m,r(y,{get when(){return d().taggedPubkeys().length>0},get children(){const k=zr();return a(k,()=>n.t("post.replyToPre"),null),a(k,r(Z,{get each(){return d().taggedPubkeys()},children:$=>(()=>{const _=Qr();return _.$$click=b=>{b.stopPropagation(),l($)},a(_,r(Ye,{pubkey:$})),_})()}),null),a(k,()=>n.t("post.replyToPost"),null),k}}),null),a(m,r(Nn,{get contentWarning(){return d().contentWarning()},get children(){const k=Fr();return a(k,r(Sr,{get parsed(){return d().parsed()},get embedding(){return g()},get initialHidden(){return d().contentWarning().contentWarning}})),k}}),null),m})()},get actions(){return r(y,{get when(){return f()},get children(){return r(A,{get fallback(){return Vr()},children:()=>r(On,{get event(){return e.event},onClickReply:u})})}})},get footer(){return r(y,{get when(){return c()},get children(){return r(pt,{textAreaRef:m=>{t=m},mode:"reply",get replyTo(){return e.event},onClose:s,onPost:s})}})},onShowProfile:()=>{l(d().pubkey)},onShowEvent:()=>{o?.setTimeline({type:"Replies",event:e.event})}})),w})()};S(["click"]);const pe=h("<div><span>"),Zr=e=>{const t=D(),n=()=>e.ensureKinds==null||e.ensureKinds.length===0||e.ensureKinds.includes(e.event.kind);return r(B,{get fallback(){return(()=>{const l=pe(),o=l.firstChild;return a(o,()=>t.t("post.unsupportedKind",{kind:e.event.kind})),a(l,r(O,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),l})()},get children(){return[r(x,{get when(){return!n()},keyed:!0,get children(){const l=pe(),o=l.firstChild;return a(o,()=>t.t("post.unexpectedKind",{kind:e.event.kind})),a(l,r(O,{get eventId(){return e.event.id},get kind(){return e.event.kind}}),null),l}}),r(x,{get when(){return e.event.kind===J},get children(){return r(Gr,{get event(){return e.event},get embedding(){return e.actions},get actions(){return e.actions}})}}),r(x,{get when(){return e.event.kind===Ce},get children(){return r(Nt,{get event(){return e.event}})}})]}})};export{je as A,Vt as B,un as C,z as E,qe as H,A as L,Oe as R,Br as T,Fe as a,He as b,jt as c,ze as d,Zr as e,Gr as f,Nt as g,Jt as h,Sr as i,Ve as j,Ue as r,to as u};
//# sourceMappingURL=EventDisplay-CQEqL2U6.js.map
