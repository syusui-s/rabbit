const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-DLQ4h0U2.js","assets/index-CBxHEaEH.js","assets/index-C5LJtWRv.css","assets/EventDisplay-C9ZnaBJH.js","assets/SideBar-CT0pxxmn.js","assets/resolveAsset-BqhuZJOt.js","assets/SafeLink-DapxkpxV.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-BFuImneK.js","assets/_baseClone-D4l8FuFr.js","assets/arrow-left-BWCXLrJR.js","assets/useFollowings-l11AqEkm.js","assets/useSubscription-Cn5JZ--l.js","assets/NostrSet-dB61tY1F.js"])))=>i.map(i=>d[i]);
import{s as Q,t as h,d as q,c as B,i as a,a as n,h as S,M as _,S as W,j as w,k as Z,l as he,u as T,b as j,m as ve,n as ee,F as V,f as N,p as ne,q as p,r as te,v as fe,w as U,x as ye,y as oe,z as $e,A as ke,B as M,o as X,C as re,D as xe,E as we,G as be,_ as Ce,R as _e,H as Ie,Z as Te,N as le,I as Se,J as pe}from"./index-CBxHEaEH.js";import{u as Y,a as ce,b as se,d as Ee,p as ie,c as Re,r as Le,t as Fe,B as Me,e as Pe,H as ze,f as J,U as De,g as Ne,h as Ue,i as Be,j as je,k as qe,l as He,G as Oe,M as Ae,m as Ke,S as Qe,n as Ve,o as Ge}from"./SideBar-CT0pxxmn.js";import{A as Ze}from"./arrow-left-BWCXLrJR.js";import{T as H,C as K,u as Je,a as P,L as z}from"./useFollowings-l11AqEkm.js";import{u as E}from"./useSubscription-Cn5JZ--l.js";import{u as We,T as Xe,C as Ye,E as en,a as nn,b as tn,c as on,R as rn,d as ln,r as cn,e as sn,f as un,A as an,H as mn}from"./EventDisplay-C9ZnaBJH.js";import{N as dn,a as gn}from"./NostrSet-dB61tY1F.js";import{t as hn}from"./url-DPIb-kBm.js";const vn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ue=(e={})=>(()=>{const t=vn();return Q(t,e,!0),t})(),fn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"><span class=truncate></span></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),yn=h('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),D=e=>{const[t,r]=B(!1),s=()=>r(o=>!o);return(()=>{const o=fn(),l=o.firstChild,c=l.firstChild,i=c.firstChild,u=c.nextSibling,m=u.firstChild;return a(c,n(S,{get when(){return e.icon},keyed:!0,children:g=>(()=>{const d=yn();return a(d,g),d})()}),i),a(i,()=>e.name),u.$$click=()=>s(),a(m,n(ue,{})),a(o,n(S,{get when(){return t()},get children(){return e.settings()}}),null),o})()};q(["click"]);const $n=e=>{const t=[e.id],r=e.rootEvent()?.id;r!=null&&t.push(r);const s=e.replyingToEvent()?.id;return s!=null&&t.push(s),Z(t)},kn=e=>{const{config:t}=w(),r=()=>he(e.event),{events:s}=E(()=>({relayUrls:t().relayUrls,filters:[{kinds:[1],ids:$n(r()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return n(H,{get events(){return[...s()].reverse()}})},xn=e=>n(W,{get children(){return n(_,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:t=>n(kn,{get event(){return t.event}})})}}),wn=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),bn=h('<div class="shrink-0 border-b border-border">'),Cn=h('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),_n=h('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),In=h('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),R=e=>{let t;const r=We(),s=T(),o=()=>e.width??"medium";return Y(()=>({commandType:"moveToColumn",handler:l=>{l.command==="moveToColumn"&&l.columnIndex===e.columnIndex&&t?.scrollIntoView({behavior:"smooth",inline:"center"})}})),Y(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&t?.scrollIntoView({behavior:"smooth"})}})),n(Xe.Provider,{value:r,get children(){const l=wn(),c=t;return typeof c=="function"?ee(c,l):t=l,a(l,n(S,{get when(){return r.timelineState.content},keyed:!0,get fallback(){return[(()=>{const i=bn();return a(i,()=>e.header),i})(),(()=>{const i=Cn();return a(i,()=>e.children),i})()]},children:i=>[(()=>{const u=_n(),m=u.firstChild,g=m.firstChild,d=g.nextSibling;return m.$$click=()=>r?.clearTimeline(),a(g,n(Ze,{})),a(d,()=>s.t("column.back")),u})(),(()=>{const u=In();return a(u,n(xn,{timelineContent:i})),u})()]})),j(i=>ve(l,{"sm:w-[500px]":o()==="widest","sm:w-[360px]":o()==="wide","sm:w-[320px]":o()==="medium","sm:w-[280px]":o()==="narrow"},i)),l}})};q(["click"]);const Tn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),Sn=(e={})=>(()=>{const t=Tn();return Q(t,e,!0),t})(),pn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),En=(e={})=>(()=>{const t=pn();return Q(t,e,!0),t})(),Rn=h('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),Ln=h('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),Fn=h('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),Mn=h('<button class="rounded-md border px-4 text-fg-secondary">'),ae=e=>(()=>{const t=Rn(),r=t.firstChild,s=r.nextSibling;return a(r,()=>e.title),a(s,()=>e.children),t})(),L=e=>{const t=T(),{saveColumn:r,removeColumn:s,moveColumn:o}=w(),l=ce(),c=u=>{r({...e.column,width:u})},i=u=>{o(e.column.id,u),l({command:"moveToColumn",columnIndex:u}).catch(m=>console.error(m))};return(()=>{const u=Fn(),m=u.firstChild,g=m.firstChild,d=g.firstChild,k=g.nextSibling,y=k.firstChild,$=k.nextSibling,v=$.nextSibling,x=v.firstChild;return a(u,n(ae,{get title(){return t.t("column.config.columnWidth")},get children(){const f=Ln();return a(f,n(V,{each:["widest","wide","medium","narrow"],children:I=>(()=>{const b=Mn();return b.$$click=()=>c(I),a(b,()=>t.t(`column.config.${I}`)),j(C=>{const F=e.column.width===I,O=e.column.width===I,G=e.column.width!==I,A=e.column.width!==I;return F!==C._v$5&&b.classList.toggle("border-fg-secondary",C._v$5=F),O!==C._v$6&&b.classList.toggle("font-bold",C._v$6=O),G!==C._v$7&&b.classList.toggle("border-border",C._v$7=G),A!==C._v$8&&b.classList.toggle("font-normal",C._v$8=A),C},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),b})()})),f}}),m),a(u,n(S,{get when(){return e.renderOtherSettings},keyed:!0,children:f=>f({column:e.column,saveColumn:r})}),m),g.$$click=()=>i(e.columnIndex-1),a(d,n(Sn,{})),k.$$click=()=>i(e.columnIndex+1),a(y,n(Ye,{})),v.$$click=()=>s(e.column.id),a(x,n(En,{})),j(f=>{const I=t.t("column.config.moveLeft"),b=t.t("column.config.moveRight"),C=t.t("column.config.removeColumn"),F=t.t("column.config.removeColumn");return I!==f._v$&&N(g,"title",f._v$=I),b!==f._v$2&&N(k,"title",f._v$2=b),C!==f._v$3&&N(v,"title",f._v$3=C),F!==f._v$4&&N(x,"aria-label",f._v$4=F),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),u})()};q(["click"]);const[Pn,zn]=ne(()=>B({})),Dn=(e,t)=>zn(r=>({...r,[e]:t})),[Nn,Un]=ne(()=>B({})),Bn=e=>te(()=>Nn()[e]??!1),me=e=>{const t=se(),[r,s]=B(null);return p(()=>{const o=e();if(o==null||o.encrypted.length===0)return;const{encrypted:l}=o,c=te(()=>Pn()[l]);if(c!=null){s(c);return}if(Bn(l))return;const i=t();if(i==null)return;const u=m=>Un(g=>({...g,[l]:m}));u(!0),Ee(i,l).then(m=>{fe(()=>{Dn(l,m),s(m)})}).catch(m=>{console.error(`failed to decrypt "${l}"`,m)}).finally(()=>{u(!1)})}),r},jn=e=>{const t=U(()=>ye(e.event)),r=me(()=>{const{content:l}=t();return l==null||l.length===0?null:{id:t().id,encrypted:l}}),s=()=>{const l=r();if(l==null)return[];console.log(l);try{return ie(l).taggedEventIds()}catch(c){return console.warn(c),[]}},o=()=>t().taggedEventIds();return n(V,{get each(){return[...o(),...s()]},children:l=>n(K,{get children(){return n(en,{eventId:l,get ensureKinds(){return[oe]}})}})})},qn=e=>["useParameterizedReplaceableEvent",e],de=e=>{const t=$e(),r=U(e),s=()=>qn(r()),o=ke(()=>({queryKey:s(),queryFn:({queryKey:c,signal:i})=>{const[,u]=c;if(u==null)return Promise.resolve(null);const{kind:m,author:g,identifier:d}=u,k=new Me({type:"ParameterizedReplaceableEvent",kind:m,author:g,identifier:d}),y=k.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${m}:${g}:${d}`)});return k.onUpdate($=>{const v=Re($);t.setQueryData(c,v)}),Le({task:k,signal:i}),Fe(15e3,`useParameterizedReplaceableEvent: ${m}:${g}:${d}`)(y)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>o.data??null,query:o}},Hn=e=>{const t=T(),{removeColumn:r}=w(),{event:s}=de(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.bookmark")},get icon(){return n(Pe,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(S,{get when(){return s()},keyed:!0,children:o=>n(jn,{event:o})})}})},On=e=>{const t=T(),{config:r,removeColumn:s}=w(),{followingPubkeys:o}=Je(()=>({pubkey:e.column.pubkey})),l=P(()=>({duration:4*60*60})),{events:c,eose:i}=E(()=>{const u=Z([...o()]);return u.length===0?null:{debugId:"following",relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:u,limit:20,since:l.since(),until:l.until()}],eoseLimit:20,continuous:l.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:m=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(m.content)}});return p(()=>{console.log("home",c()),l.setEvents(c())}),X(()=>console.log("home timeline mounted")),re(()=>console.log("home timeline unmounted")),n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.home")},get icon(){return n(ze,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:l,get eose(){return i()},get children(){return n(H,{get events(){return c()}})}})}})},An=e=>{const t=U(e),{query:r}=de(()=>({kind:xe,author:t().author,identifier:t().identifier})),s=()=>r.data,o=me(()=>J([s()?.content])(([d])=>({encrypted:d}))),l=U(()=>{const d=o();if(d==null)return null;const k=ie(d);return new dn(k.tags)}),c=U(()=>r.data==null?null:new gn(r.data));return{event:s,followSet:c,pubkeys:()=>[...c()?.taggedPubkeys()??[],...l()?.taggedPubkeys()??[]],title:()=>c()?.title()||l()?.title(),description:()=>c()?.description()||l()?.description(),image:()=>c()?.image()||l()?.image(),query:r}},Kn=e=>{const t=T(),{config:r,removeColumn:s}=w(),{followSet:o,title:l,pubkeys:c}=An(()=>({author:e.column.author,identifier:e.column.identifier})),i=()=>e.column.name||l()||o()?.identifier()||t.t("column.followSet"),u=P(()=>({duration:null})),{events:m,eose:g}=E(()=>{const d=Z([...c()]);return d.length===0?null:{debugId:"following",relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:d,limit:20,since:u.since(),until:u.until()}],eoseLimit:20,continuous:u.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:k=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(k.content)}});return n(R,{get header(){return n(D,{get name(){return i()},get icon(){return n(De,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:u,get eose(){return g()},get children(){return n(H,{get events(){return m()}})}})}})},Qn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),Vn=(e={})=>(()=>{const t=Qn();return Q(t,e,!0),t})(),Gn=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),Zn=(e={})=>(()=>{const t=Gn();return Q(t,e,!0),t})(),Jn=h('<div class="flex items-center gap-1 pl-[2px] text-sm"><span class="webkit-touch-callout-none notification-icon flex h-4 min-w-4 max-w-[64px] shrink-0 select-none place-items-center overflow-hidden"></span><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),Wn=h('<div class="notification-event py-1">'),Xn=h('<img alt=icon class="size-full object-cover">'),Yn=h("<div class=truncate> "),et=e=>{const t=T(),r=nn(),{shouldMuteEvent:s}=w(),{showProfile:o}=Be(),l=()=>we(e.event),c=()=>l().lastTaggedEventId(),{profile:i}=Ne(()=>({pubkey:e.event.pubkey})),{event:u,query:m}=tn(()=>J([c()])(([$])=>({eventId:$}))),g=()=>m.isSuccess&&u()==null,d=()=>l().toReactionTypes(),k=()=>cn(d()),y=on(()=>J([k()])(([$])=>({emoji:$})));return n(S,{get when(){return U(()=>!g())()&&!s(e.event)},get children(){return[(()=>{const $=Jn(),v=$.firstChild,x=v.nextSibling,f=x.firstChild,I=f.nextSibling,b=I.firstChild,C=b.nextSibling,F=x.nextSibling,O=y.emojiRef;return typeof O=="function"?ee(O,v):y.emojiRef=v,a(v,n(rn,{get reactionTypes(){return d()}})),a($,()=>y.popup(),x),a(f,n(S,{get when(){return i()?.picture},keyed:!0,children:G=>(()=>{const A=Xn();return j(()=>N(A,"src",hn(G,"icon"))),A})()})),b.$$click=()=>o(e.event.pubkey),a(b,n(Ue,{get pubkey(){return e.event.pubkey}})),a(C,()=>t.t("notification.reacted")),a(F,()=>r(l().createdAtAsDate())),$})(),(()=>{const $=Wn();return a($,n(S,{get when(){return u()},get fallback(){return(()=>{const v=Yn(),x=v.firstChild;return a(v,()=>t.t("general.loading"),x),a(v,c,null),v})()},keyed:!0,children:v=>n(ln,{event:v})})),$})()]}})};q(["click"]);const nt=h("<div>unknown event"),tt=be(()=>Ce(()=>import("./ZapReceipt-DLQ4h0U2.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),ge=e=>{const{shouldMuteEvent:t}=w();return n(V,{get each(){return e.events},children:r=>n(S,{get when(){return!t(r)},get children(){return n(W,{get fallback(){return nt()},get children(){return[n(_,{get when(){return r.kind===oe},get children(){return n(K,{get children(){return n(sn,{event:r})}})}}),n(_,{get when(){return r.kind===_e},get children(){return n(K,{get children(){return n(et,{event:r})}})}}),n(_,{get when(){return r.kind===Ie},get children(){return n(K,{get children(){return n(un,{event:r})}})}}),n(_,{get when(){return r.kind===Te},get children(){return n(K,{get children(){return n(tt,{event:r})}})}})]}})}})})},ot=h('<div class="flex gap-1">'),rt=h('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),lt={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},ct=e=>{const t=T(),r=[{notificationType:"Replies",title:t.t("column.notificationSettings.types.replies"),icon:n(Vn,{})},{notificationType:"Repost",title:t.t("column.notificationSettings.types.reposts"),icon:n(an,{})},{notificationType:"Reaction",title:t.t("column.notificationSettings.types.reactions"),icon:n(mn,{})},{notificationType:"Zap",title:t.t("column.notificationSettings.types.zap"),icon:n(Zn,{})}],s=()=>e.column.notificationTypes??[...le],o=c=>s().includes(c),l=c=>{const i=[...s()];o(c)?i.splice(i.indexOf(c),1):i.push(c),e.saveColumn({...e.column,notificationTypes:i})};return n(ae,{get title(){return t.t("column.notificationSettings.notificationTypes")},get children(){const c=ot();return a(c,n(V,{each:r,children:({notificationType:i,title:u,icon:m})=>(()=>{const g=rt(),d=g.firstChild,k=d.nextSibling;return g.$$click=()=>l(i),N(g,"title",u),a(d,m),a(k,u),j(y=>{const $=!!o(i),v=!!o(i),x=!o(i),f=!o(i);return $!==y._v$&&g.classList.toggle("border-fg-secondary",y._v$=$),v!==y._v$2&&g.classList.toggle("font-bold",y._v$2=v),x!==y._v$3&&g.classList.toggle("border-border",y._v$3=x),f!==y._v$4&&g.classList.toggle("font-normal",y._v$4=f),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),g})()})),c}})},st=e=>{const t=T(),{config:r,removeColumn:s}=w(),o=P(()=>({duration:null})),l=()=>e.column.notificationTypes??[...le],c=()=>Z(l().flatMap(m=>lt[m])),{events:i,eose:u}=E(()=>c().length>0?{relayUrls:r().relayUrls,filters:[{kinds:c(),"#p":[e.column.pubkey],limit:20,since:o.since(),until:o.until()}],eoseLimit:20,clientEventFilter:m=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(m.content)}:null);return p(()=>o.setEvents(i())),n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.notification")},get icon(){return n(je,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:ct}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:o,get eose(){return u()},get children(){return n(ge,{get events(){return i()}})}})}})};q(["click"]);const it=e=>{const t=T(),{config:r,removeColumn:s}=w(),o=P(()=>({duration:null})),{events:l,eose:c}=E(()=>({relayUrls:r().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(i.content)}));return p(()=>o.setEvents(l())),n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.posts")},get icon(){return n(qe,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:o,get eose(){return c()},get children(){return n(H,{get events(){return l()}})}})}})},ut=e=>{const t=T(),{config:r,removeColumn:s}=w(),o=P(()=>({duration:null})),{events:l,eose:c}=E(()=>({relayUrls:r().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(i.content)}));return p(()=>o.setEvents(l())),n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.reactions")},get icon(){return n(He,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:o,get eose(){return c()},get children(){return n(ge,{get events(){return l()}})}})}})},at=e=>{const t=T(),{removeColumn:r}=w(),s=P(()=>({duration:4*60*60})),{events:o,eose:l}=E(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:s.since(),until:s.until()}],eoseLimit:20,clientEventFilter:c=>e.column.contentFilter==null?!0:M(e.column.contentFilter)(c.content)}));return p(()=>s.setEvents(o())),n(R,{get header(){return n(D,{get name(){return e.column.name??t.t("column.relay")},get icon(){return n(Oe,{})},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>r(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:s,get eose(){return l()},get children(){return n(H,{get events(){return o()}})}})}})},mt=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block size-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),dt=e=>{const[t,r]=B(!1),[s,o]=B(""),{saveColumn:l}=w(),c=()=>r(d=>!d),i=()=>{s()!==e.column.query&&l({...e.column,query:s()})},u=()=>{i()},m=d=>{o(d.currentTarget.value)},g=d=>{d.preventDefault(),i()};return X(()=>{o(e.column.query)}),(()=>{const d=mt(),k=d.firstChild,y=k.firstChild,$=y.firstChild,v=y.nextSibling,x=v.firstChild,f=v.nextSibling;return a($,n(Ae,{})),v.addEventListener("submit",g),x.addEventListener("blur",u),x.addEventListener("change",m),f.$$click=()=>c(),a(f,n(ue,{})),a(d,n(S,{get when(){return t()},get children(){return e.settings()}}),null),j(()=>x.value=s()),d})()},gt=e=>{const{removeColumn:t}=w(),r=P(()=>({duration:null})),{events:s,eose:o}=E(()=>{const{query:l}=e.column;return l.length===0?null:{relayUrls:Se,filters:[{kinds:[1],search:l,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:c=>c.tags.findIndex(([i])=>i==="mostr"||i==="proxy")>=0?!1:e.column.contentFilter==null?!0:M(e.column.contentFilter)(c.content)}});return p(()=>{r.setEvents(s())}),n(R,{get header(){return n(dt,{get column(){return e.column},settings:()=>n(L,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>t(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(z,{loadMore:r,get eose(){return o()},get children(){return n(H,{get events(){return s()}})}})}})};q(["click"]);const ht=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),vt=()=>{const{config:e}=w();return(()=>{const t=ht();return a(t,n(V,{get each(){return e().columns},children:(r,s)=>{const o=()=>s()+1,l=()=>o()===e().columns.length;return n(W,{get children(){return[n(_,{get when(){return r.columnType==="Following"&&r},keyed:!0,children:c=>n(On,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Notification"&&r},keyed:!0,children:c=>n(st,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Posts"&&r},keyed:!0,children:c=>n(it,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Reactions"&&r},keyed:!0,children:c=>n(ut,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Relays"&&r},keyed:!0,children:c=>n(at,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="FollowSet"&&r},keyed:!0,children:c=>n(Kn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Bookmark"&&r},keyed:!0,children:c=>n(Hn,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})}),n(_,{get when(){return r.columnType==="Search"&&r},keyed:!0,children:c=>n(gt,{column:c,get columnIndex(){return o()},get lastColumn(){return l()}})})]}})}})),t})()},ft=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],yt=e=>{const t=new Map;return e.forEach(r=>{t.set(r.key,r)}),t},$t=({shortcuts:e=ft,onShortcut:t})=>{const r=yt(e);X(()=>{const s=Ke(o=>{if(o.type!=="keydown"||o.ctrlKey||o.altKey||o.metaKey||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLInputElement)return;const l=r.get(o.key);l!=null&&t(l)},50);window.addEventListener("keydown",s),re(()=>{window.removeEventListener("keydown",s)})})},kt=()=>{const e=ce();$t({onShortcut:t=>{e(t.command).then(()=>console.debug(`shortcut key '${t.key}' was processed successfully`),r=>console.error(r))}})},xt=h('<div class="absolute inset-0 flex h-dvh w-screen touch-manipulation flex-row overflow-hidden">'),wt=()=>{kt();const e=Ge(),{config:t,initializeColumns:r}=w(),s=se();return p(()=>{Promise.allSettled(t().relayUrls.map(async o=>{try{const l=await e().ensureRelay(o);l.onnotice=c=>{console.error(`NOTICE: ${o}: ${c}`)},l.onclose=()=>{console.warn(`CLOSE: ${o}`)}}catch(l){console.error("ensureRelay failed",l)}})).catch(()=>{})}),p(()=>{const o=s();o!=null&&r({pubkey:o})}),pe(o=>{console.error("uncaught error: ",o)}),(()=>{const o=xt();return a(o,n(Qe,{}),null),a(o,n(vt,{}),null),a(o,n(Ve,{}),null),o})()},Rt=Object.freeze(Object.defineProperty({__proto__:null,default:wt},Symbol.toStringTag,{value:"Module"}));export{Zn as B,Rt as H};
//# sourceMappingURL=Home-7Q5BoFFi.js.map
