const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-EHtAXYqO.js","assets/index-DSvcZcgX.js","assets/index-FQF1QNMV.css","assets/EventDisplay-wQG78ZrS.js","assets/SideBar-CPiRocCP.js","assets/resolveAsset-DiCMPl-h.js","assets/SafeLink-DEDy3MoM.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-oHRz7rox.js","assets/_baseClone-B50zwEzT.js","assets/arrow-left-DODn_99n.js","assets/useFollowings-DsalPvCC.js","assets/useSubscription-7k0h7OgW.js","assets/NostrSet-DrOSUUwN.js"])))=>i.map(i=>d[i]);
import{s as V,t as h,d as P,c as b,i as d,a as t,h as T,M as p,S as X,j as w,k as J,l as ke,u as I,m as E,n as K,b as U,p as xe,F as G,f as F,q as oe,r as re,v as be,w as Q,x as we,y as le,z as Ce,A as _e,B as H,o as Y,C as ce,D as se,E as ie,G as Te,H as pe,I as Ie,_ as Se,R as Ee,J as Re,Z as Le,N as ue,K as Oe,L as Me}from"./index-DSvcZcgX.js";import{u as te,a as ae,b as me,d as Fe,p as de,c as Pe,r as He,t as ze,B as De,e as Ne,H as Ue,U as ge,f as he,g as W,h as Ae,i as Be,j as je,k as qe,l as Ke,G as Qe,M as Ve,m as Ge,S as Ze,n as Je,o as We}from"./SideBar-CPiRocCP.js";import{A as Xe}from"./arrow-left-DODn_99n.js";import{T as A,C as q,u as Ye,a as z,L as D}from"./useFollowings-DsalPvCC.js";import{u as R}from"./useSubscription-7k0h7OgW.js";import{u as et,T as tt,C as nt,E as ot,a as rt,b as lt,c as ct,d as st,R as it,e as ut,r as at,f as mt,g as dt,A as gt,H as ht}from"./EventDisplay-wQG78ZrS.js";import{N as ft,a as vt}from"./NostrSet-DrOSUUwN.js";import{t as yt}from"./url-DPIb-kBm.js";const $t=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),ee=(e={})=>(()=>{const n=$t();return V(n,e,!0),n})(),ne=h("<span class=truncate>"),kt=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="min-w-0 flex-1"><button type=button class="flex w-full select-text items-center gap-1 ps-2"></button></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),xt=h('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),N=e=>{const[n,o]=b(!1),i=()=>o(r=>!r);return(()=>{const r=kt(),c=r.firstChild,l=c.firstChild,s=l.firstChild,u=l.nextSibling,a=u.firstChild;return s.$$click=()=>e.onClickHeader?.(),d(s,t(T,{get when(){return e.icon},keyed:!0,children:m=>(()=>{const g=xt();return d(g,m),g})()}),null),d(s,t(T,{get when(){return e.onClickHeader},get fallback(){return(()=>{const m=ne();return d(m,()=>e.name),m})()},get children(){const m=ne();return d(m,()=>e.name),m}}),null),u.$$click=()=>i(),d(a,t(ee,{})),d(r,t(T,{get when(){return n()},get children(){return e.settings()}}),null),r})()};P(["click"]);const bt=e=>{const n=[e.id],o=e.rootEvent()?.id;o!=null&&n.push(o);const i=e.replyingToEvent()?.id;return i!=null&&n.push(i),J(n)},wt=e=>{const{config:n}=w(),o=()=>ke(e.event),{events:i}=R(()=>({relayUrls:n().relayUrls,filters:[{kinds:[1],ids:bt(o()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return t(A,{get events(){return[...i()].reverse()}})},Ct=e=>t(X,{get children(){return t(p,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:n=>t(wt,{get event(){return n.event}})})}}),_t=h('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),Tt=h('<div class="shrink-0 border-b border-border">'),pt=h('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),It=h('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),St=h('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),L=e=>{let n;const o=et(),i=I(),r=()=>e.width??"medium";te(()=>({commandType:"moveToColumn",handler:s=>{s.command==="moveToColumn"&&s.columnIndex===e.columnIndex&&n?.scrollIntoView({behavior:"smooth",inline:"center"})}})),te(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&n?.scrollIntoView({behavior:"smooth"})}}));const[c,l]=b();return E(()=>{const s={scrollToTop:()=>{c()?.scrollTo({top:0,behavior:"smooth"})}};e.columnOperatorRef?.(s)}),t(tt.Provider,{value:o,get children(){const s=_t(),u=n;return typeof u=="function"?K(u,s):n=s,d(s,t(T,{get when(){return o.timelineState.content},keyed:!0,get fallback(){return[(()=>{const a=Tt();return d(a,()=>e.header),a})(),(()=>{const a=pt();return K(l,a),d(a,()=>e.children),a})()]},children:a=>[(()=>{const m=It(),g=m.firstChild,v=g.firstChild,y=v.nextSibling;return g.$$click=()=>o?.clearTimeline(),d(v,t(Xe,{})),d(y,()=>i.t("column.back")),m})(),(()=>{const m=St();return K(l,m),d(m,t(Ct,{timelineContent:a})),m})()]})),U(a=>xe(s,{"sm:w-[500px]":r()==="widest","sm:w-[360px]":r()==="wide","sm:w-[320px]":r()==="medium","sm:w-[280px]":r()==="narrow"},a)),s}})};P(["click"]);const Et=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),Rt=(e={})=>(()=>{const n=Et();return V(n,e,!0),n})(),Lt=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),Ot=(e={})=>(()=>{const n=Lt();return V(n,e,!0),n})(),Mt=h('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),Ft=h('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),Pt=h('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),Ht=h('<button class="rounded-md border px-4 text-fg-secondary">'),fe=e=>(()=>{const n=Mt(),o=n.firstChild,i=o.nextSibling;return d(o,()=>e.title),d(i,()=>e.children),n})(),O=e=>{const n=I(),{saveColumn:o,removeColumn:i,moveColumn:r}=w(),c=ae(),l=u=>{o({...e.column,width:u})},s=u=>{r(e.column.id,u),c({command:"moveToColumn",columnIndex:u}).catch(a=>console.error(a))};return(()=>{const u=Pt(),a=u.firstChild,m=a.firstChild,g=m.firstChild,v=m.nextSibling,y=v.firstChild,k=v.nextSibling,f=k.nextSibling,x=f.firstChild;return d(u,t(fe,{get title(){return n.t("column.config.columnWidth")},get children(){const $=Ft();return d($,t(G,{each:["widest","wide","medium","narrow"],children:S=>(()=>{const C=Ht();return C.$$click=()=>l(S),d(C,()=>n.t(`column.config.${S}`)),U(_=>{const M=e.column.width===S,B=e.column.width===S,Z=e.column.width!==S,j=e.column.width!==S;return M!==_._v$5&&C.classList.toggle("border-fg-secondary",_._v$5=M),B!==_._v$6&&C.classList.toggle("font-bold",_._v$6=B),Z!==_._v$7&&C.classList.toggle("border-border",_._v$7=Z),j!==_._v$8&&C.classList.toggle("font-normal",_._v$8=j),_},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),C})()})),$}}),a),d(u,t(T,{get when(){return e.renderOtherSettings},keyed:!0,children:$=>$({column:e.column,saveColumn:o})}),a),m.$$click=()=>s(e.columnIndex-1),d(g,t(Rt,{})),v.$$click=()=>s(e.columnIndex+1),d(y,t(nt,{})),f.$$click=()=>i(e.column.id),d(x,t(Ot,{})),U($=>{const S=n.t("column.config.moveLeft"),C=n.t("column.config.moveRight"),_=n.t("column.config.removeColumn"),M=n.t("column.config.removeColumn");return S!==$._v$&&F(m,"title",$._v$=S),C!==$._v$2&&F(v,"title",$._v$2=C),_!==$._v$3&&F(f,"title",$._v$3=_),M!==$._v$4&&F(x,"aria-label",$._v$4=M),$},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),u})()};P(["click"]);const[zt,Dt]=oe(()=>b({})),Nt=(e,n)=>Dt(o=>({...o,[e]:n})),[Ut,At]=oe(()=>b({})),Bt=e=>re(()=>Ut()[e]??!1),ve=e=>{const n=me(),[o,i]=b(null);return E(()=>{const r=e();if(r==null||r.encrypted.length===0)return;const{encrypted:c}=r,l=re(()=>zt()[c]);if(l!=null){i(l);return}if(Bt(c))return;const s=n();if(s==null)return;const u=a=>At(m=>({...m,[c]:a}));u(!0),Fe(s,c).then(a=>{be(()=>{Nt(c,a),i(a)})}).catch(a=>{console.error(`failed to decrypt "${c}"`,a)}).finally(()=>{u(!1)})}),o},jt=e=>{const n=Q(()=>we(e.event)),o=ve(()=>{const{content:c}=n();return c==null||c.length===0?null:{id:n().id,encrypted:c}}),i=()=>{const c=o();if(c==null)return[];console.log(c);try{return de(c).taggedEventIds()}catch(l){return console.warn(l),[]}},r=()=>n().taggedEventIds();return t(G,{get each(){return[...r(),...i()]},children:c=>t(q,{get children(){return t(ot,{eventId:c,get ensureKinds(){return[le]}})}})})},qt=e=>["useParameterizedReplaceableEvent",e],ye=e=>{const n=Ce(),o=Q(e),i=()=>qt(o()),r=_e(()=>({queryKey:i(),queryFn:({queryKey:l,signal:s})=>{const[,u]=l;if(u==null)return Promise.resolve(null);const{kind:a,author:m,identifier:g}=u,v=new De({type:"ParameterizedReplaceableEvent",kind:a,author:m,identifier:g}),y=v.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${a}:${m}:${g}`)});return v.onUpdate(k=>{const f=Pe(k);n.setQueryData(l,f)}),He({task:v,signal:s}),ze(15e3,`useParameterizedReplaceableEvent: ${a}:${m}:${g}`)(y)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>r.data??null,query:r}},Kt=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=b(),{event:c}=ye(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.bookmark")},get icon(){return t(Ne,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(T,{get when(){return c()},keyed:!0,children:l=>t(jt,{event:l})})}})},Qt=e=>{const n=I(),{config:o,removeColumn:i}=w(),{followingPubkeys:r}=Ye(()=>({pubkey:e.column.pubkey})),[c,l]=b(),s=z(()=>({duration:4*60*60,onLoad:()=>{c()?.scrollToTop()}})),{events:u,eose:a}=R(()=>{const m=J([...r()]);return m.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:m,limit:20,since:s.since(),until:s.until()}],eoseLimit:20,continuous:s.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:g=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(g.content)}});return E(()=>{console.log("home",u()),s.setEvents(u())}),Y(()=>console.log("home timeline mounted")),ce(()=>console.log("home timeline unmounted")),t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.home")},get icon(){return t(Ue,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>c()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:l,get children(){return t(D,{loadMore:s,get eose(){return a()},get children(){return t(A,{get events(){return u()}})}})}})},Vt=h('<button type=button class="size-4 shrink-0">'),Gt=h('<div class="flex items-start gap-2 break-all border-t border-border p-1"><div class="mt-1 size-14 shrink-0 overflow-hidden rounded"></div><div class="flex flex-1 flex-col overflow-hidden"><h3 class="truncate text-lg font-bold"></h3><p class="max-h-[3.25rem] overflow-y-auto break-all text-sm">'),Zt=h('<img class="size-full object-cover"alt=icon>'),Jt=h('<div class=text-xs><button class="select-text truncate hover:text-link hover:underline">'),Wt=e=>{const{showProfile:n}=he(),o=rt(()=>({menu:e.otherActionMenuItems??[]}));return(()=>{const i=Gt(),r=i.firstChild,c=r.nextSibling,l=c.firstChild,s=l.nextSibling;return d(r,t(T,{get when(){return e.image},keyed:!0,children:u=>(()=>{const a=Zt();return F(a,"src",u),a})()})),d(l,()=>e.title),d(s,()=>e.description),d(c,t(T,{get when(){return e.authorPubkey},keyed:!0,children:u=>(()=>{const a=Jt(),m=a.firstChild;return m.$$click=()=>n(u),d(m,t(ge,{pubkey:u})),a})()}),null),d(i,t(T,{get when(){return e.otherActionMenuItems},get children(){return[(()=>{const u=Vt();u.$$click=()=>o.open();const a=o.targetRef;return typeof a=="function"?K(a,u):o.targetRef=u,d(u,t(ee,{})),u})(),se(()=>o.popup())]}}),null),i})()};P(["click"]);const Xt=e=>{const n=Q(e),{query:o}=ye(()=>({kind:ie,author:n().author,identifier:n().identifier})),i=()=>o.data,r=ve(()=>W([i()?.content])(([g])=>({encrypted:g}))),c=Q(()=>{const g=r();if(g==null)return null;const v=de(g);return new ft(v.tags)}),l=Q(()=>o.data==null?null:new vt(o.data));return{event:i,followSet:l,pubkeys:()=>[...l()?.taggedPubkeys()??[],...c()?.taggedPubkeys()??[]],title:()=>l()?.title()||c()?.title(),description:()=>l()?.description()||c()?.description(),image:()=>l()?.image()||c()?.image(),query:o}},Yt=e=>{const n=I(),o=()=>Te({pubkey:e.author,identifier:e.identifier,kind:ie}),i=[{content:n.t("column.columnInfoCommon.copyId"),onSelect:()=>{navigator.clipboard.writeText(o()).catch(r=>window.alert(r))}}];return t(Wt,{get image(){return e.image},get authorPubkey(){return e.author},get title(){return e.title??e.identifier},get description(){return e.description},otherActionMenuItems:i})},en=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),{followSet:l,image:s,title:u,description:a,pubkeys:m}=Xt(()=>({author:e.column.author,identifier:e.column.identifier})),g=()=>e.column.name||u()||l()?.identifier()||n.t("column.followSet"),v=z(()=>({duration:null})),{events:y,eose:k}=R(()=>{const f=J([...m()]);return f.length===0?null:{debugId:"following",relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:f,limit:20,since:v.since(),until:v.until()}],eoseLimit:20,continuous:v.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:x=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(x.content)}});return t(L,{get header(){return t(N,{get name(){return g()},get icon(){return t(Ae,{})},settings:()=>[t(Yt,{get author(){return e.column.author},get identifier(){return e.column.identifier},get image(){return s()},get title(){return u()},get description(){return a()}}),t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}})],onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(D,{loadMore:v,get eose(){return k()},get children(){return t(A,{get events(){return y()}})}})}})},tn=h('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),nn=(e={})=>(()=>{const n=tn();return V(n,e,!0),n})(),on=h('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),rn=(e={})=>(()=>{const n=on();return V(n,e,!0),n})(),ln=h('<div class="flex items-center gap-1 pl-[2px] text-sm"><span class="webkit-touch-callout-none notification-icon flex h-4 min-w-4 max-w-[64px] shrink-0 select-none place-items-center overflow-hidden"></span><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),cn=h('<div class="notification-event py-1">'),sn=h('<img alt=icon class="size-full object-cover">'),un=h("<div class=truncate> "),an=e=>{const n=I(),o=lt(),{shouldMuteEvent:i}=w(),{showProfile:r}=he(),c=()=>pe(e.event),l=()=>c().lastTaggedEventId(),{profile:s}=Be(()=>({pubkey:e.event.pubkey})),{event:u,query:a}=ct(()=>W([l()])(([k])=>({eventId:k}))),m=()=>a.isSuccess&&u()==null,g=()=>c().toReactionTypes(),v=()=>at(g()),y=st(()=>W([v()])(([k])=>({emoji:k})));return t(T,{get when(){return se(()=>!m())()&&!i(e.event)},get children(){return[(()=>{const k=ln(),f=k.firstChild,x=f.nextSibling,$=x.firstChild,S=$.nextSibling,C=S.firstChild,_=C.nextSibling,M=x.nextSibling,B=y.emojiRef;return typeof B=="function"?K(B,f):y.emojiRef=f,d(f,t(it,{get reactionTypes(){return g()}})),d(k,()=>y.popup(),x),d($,t(T,{get when(){return s()?.picture},keyed:!0,children:Z=>(()=>{const j=sn();return U(()=>F(j,"src",yt(Z,"icon"))),j})()})),C.$$click=()=>r(e.event.pubkey),d(C,t(ge,{get pubkey(){return e.event.pubkey}})),d(_,()=>n.t("notification.reacted")),d(M,()=>o(c().createdAtAsDate())),k})(),(()=>{const k=cn();return d(k,t(T,{get when(){return u()},get fallback(){return(()=>{const f=un(),x=f.firstChild;return d(f,()=>n.t("general.loading"),x),d(f,l,null),f})()},keyed:!0,children:f=>t(ut,{event:f})})),k})()]}})};P(["click"]);const mn=h("<div>unknown event"),dn=Ie(()=>Se(()=>import("./ZapReceipt-EHtAXYqO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),$e=e=>{const{shouldMuteEvent:n}=w();return t(G,{get each(){return e.events},children:o=>t(T,{get when(){return!n(o)},get children(){return t(X,{get fallback(){return mn()},get children(){return[t(p,{get when(){return o.kind===le},get children(){return t(q,{get children(){return t(mt,{event:o})}})}}),t(p,{get when(){return o.kind===Ee},get children(){return t(q,{get children(){return t(an,{event:o})}})}}),t(p,{get when(){return o.kind===Re},get children(){return t(q,{get children(){return t(dt,{event:o})}})}}),t(p,{get when(){return o.kind===Le},get children(){return t(q,{get children(){return t(dn,{event:o})}})}})]}})}})})},gn=h('<div class="flex gap-1">'),hn=h('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),fn={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},vn=e=>{const n=I(),o=[{notificationType:"Replies",title:n.t("column.notificationSettings.types.replies"),icon:t(nn,{})},{notificationType:"Repost",title:n.t("column.notificationSettings.types.reposts"),icon:t(gt,{})},{notificationType:"Reaction",title:n.t("column.notificationSettings.types.reactions"),icon:t(ht,{})},{notificationType:"Zap",title:n.t("column.notificationSettings.types.zap"),icon:t(rn,{})}],i=()=>e.column.notificationTypes??[...ue],r=l=>i().includes(l),c=l=>{const s=[...i()];r(l)?s.splice(s.indexOf(l),1):s.push(l),e.saveColumn({...e.column,notificationTypes:s})};return t(fe,{get title(){return n.t("column.notificationSettings.notificationTypes")},get children(){const l=gn();return d(l,t(G,{each:o,children:({notificationType:s,title:u,icon:a})=>(()=>{const m=hn(),g=m.firstChild,v=g.nextSibling;return m.$$click=()=>c(s),F(m,"title",u),d(g,a),d(v,u),U(y=>{const k=!!r(s),f=!!r(s),x=!r(s),$=!r(s);return k!==y._v$&&m.classList.toggle("border-fg-secondary",y._v$=k),f!==y._v$2&&m.classList.toggle("font-bold",y._v$2=f),x!==y._v$3&&m.classList.toggle("border-border",y._v$3=x),$!==y._v$4&&m.classList.toggle("font-normal",y._v$4=$),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),m})()})),l}})},yn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=z(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),s=()=>e.column.notificationTypes??[...ue],u=()=>J(s().flatMap(g=>fn[g])),{events:a,eose:m}=R(()=>u().length>0?{relayUrls:o().relayUrls,filters:[{kinds:u(),"#p":[e.column.pubkey],limit:20,since:l.since(),until:l.until()}],eoseLimit:20,clientEventFilter:g=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(g.content)}:null);return E(()=>l.setEvents(a())),t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.notification")},get icon(){return t(je,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:vn}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(D,{loadMore:l,get eose(){return m()},get children(){return t($e,{get events(){return a()}})}})}})};P(["click"]);const $n=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=z(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:s,eose:u}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:a=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(a.content)}));return E(()=>l.setEvents(s())),t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.posts")},get icon(){return t(qe,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(D,{loadMore:l,get eose(){return u()},get children(){return t(A,{get events(){return s()}})}})}})},kn=e=>{const n=I(),{config:o,removeColumn:i}=w(),[r,c]=b(),l=z(()=>({duration:null,onLoad:()=>{r()?.scrollToTop()}})),{events:s,eose:u}=R(()=>({relayUrls:o().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:l.since(),until:l.until()}],eoseLimit:10,clientEventFilter:a=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(a.content)}));return E(()=>l.setEvents(s())),t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.reactions")},get icon(){return t(Ke,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>i(e.column.id),onClickHeader:()=>r()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:c,get children(){return t(D,{loadMore:l,get eose(){return u()},get children(){return t($e,{get events(){return s()}})}})}})},xn=e=>{const n=I(),{removeColumn:o}=w(),[i,r]=b(),c=z(()=>({duration:4*60*60,onLoad:()=>{i()?.scrollToTop()}})),{events:l,eose:s}=R(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:c.since(),until:c.until()}],eoseLimit:20,clientEventFilter:u=>e.column.contentFilter==null?!0:H(e.column.contentFilter)(u.content)}));return E(()=>c.setEvents(l())),t(L,{get header(){return t(N,{get name(){return e.column.name??n.t("column.relay")},get icon(){return t(Qe,{})},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>o(e.column.id),onClickHeader:()=>i()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:r,get children(){return t(D,{loadMore:c,get eose(){return s()},get children(){return t(A,{get events(){return l()}})}})}})},bn=h('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center"><button type=button class="inline-block size-4 text-fg-secondary"></button></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),wn=e=>{const[n,o]=b(!1),[i,r]=b(""),{saveColumn:c}=w(),l=()=>o(g=>!g),s=()=>{i()!==e.column.query&&c({...e.column,query:i()})},u=()=>{s()},a=g=>{r(g.currentTarget.value)},m=g=>{g.preventDefault(),s()};return Y(()=>{r(e.column.query)}),(()=>{const g=bn(),v=g.firstChild,y=v.firstChild,k=y.firstChild,f=y.nextSibling,x=f.firstChild,$=f.nextSibling;return k.$$click=()=>e.onClickHeader?.(),d(k,t(Ve,{})),f.addEventListener("submit",m),x.addEventListener("blur",u),x.addEventListener("change",a),$.$$click=()=>l(),d($,t(ee,{})),d(g,t(T,{get when(){return n()},get children(){return e.settings()}}),null),U(()=>x.value=i()),g})()},Cn=e=>{const{removeColumn:n}=w(),[o,i]=b(),r=z(()=>({duration:null,onLoad:()=>{o()?.scrollToTop()}})),{events:c,eose:l}=R(()=>{const{query:s}=e.column;return s.length===0?null:{relayUrls:Oe,filters:[{kinds:[1],search:s,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,clientEventFilter:u=>u.tags.findIndex(([a])=>a==="mostr"||a==="proxy")>=0?!1:e.column.contentFilter==null?!0:H(e.column.contentFilter)(u.content)}});return E(()=>{r.setEvents(c())}),t(L,{get header(){return t(wn,{get column(){return e.column},settings:()=>t(O,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>n(e.column.id),onClickHeader:()=>o()?.scrollToTop()})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},columnOperatorRef:i,get children(){return t(D,{loadMore:r,get eose(){return l()},get children(){return t(A,{get events(){return c()}})}})}})};P(["click"]);const _n=h('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),Tn=()=>{const{config:e}=w();return(()=>{const n=_n();return d(n,t(G,{get each(){return e().columns},children:(o,i)=>{const r=()=>i()+1,c=()=>r()===e().columns.length;return t(X,{get children(){return[t(p,{get when(){return o.columnType==="Following"&&o},keyed:!0,children:l=>t(Qt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Notification"&&o},keyed:!0,children:l=>t(yn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Posts"&&o},keyed:!0,children:l=>t($n,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Reactions"&&o},keyed:!0,children:l=>t(kn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Relays"&&o},keyed:!0,children:l=>t(xn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="FollowSet"&&o},keyed:!0,children:l=>t(en,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Bookmark"&&o},keyed:!0,children:l=>t(Kt,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})}),t(p,{get when(){return o.columnType==="Search"&&o},keyed:!0,children:l=>t(Cn,{column:l,get columnIndex(){return r()},get lastColumn(){return c()}})})]}})}})),n})()},pn=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],In=e=>{const n=new Map;return e.forEach(o=>{n.set(o.key,o)}),n},Sn=({shortcuts:e=pn,onShortcut:n})=>{const o=In(e);Y(()=>{const i=Ge(r=>{if(r.type!=="keydown"||r.ctrlKey||r.altKey||r.metaKey||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLInputElement)return;const c=o.get(r.key);c!=null&&n(c)},50);window.addEventListener("keydown",i),ce(()=>{window.removeEventListener("keydown",i)})})},En=()=>{const e=ae();Sn({onShortcut:n=>{e(n.command).then(()=>console.debug(`shortcut key '${n.key}' was processed successfully`),o=>console.error(o))}})},Rn=h('<div class="absolute inset-0 flex h-dvh w-screen touch-manipulation flex-row overflow-hidden">'),Ln=()=>{En();const e=We(),{config:n,initializeColumns:o}=w(),i=me();return E(()=>{Promise.allSettled(n().relayUrls.map(async r=>{try{const c=await e().ensureRelay(r);c.onnotice=l=>{console.error(`NOTICE: ${r}: ${l}`)},c.onclose=()=>{console.warn(`CLOSE: ${r}`)}}catch(c){console.error("ensureRelay failed",c)}})).catch(()=>{})}),E(()=>{const r=i();r!=null&&o({pubkey:r})}),Me(r=>{console.error("uncaught error: ",r)}),(()=>{const r=Rn();return d(r,t(Ze,{}),null),d(r,t(Tn,{}),null),d(r,t(Je,{}),null),r})()},Un=Object.freeze(Object.defineProperty({__proto__:null,default:Ln},Symbol.toStringTag,{value:"Module"}));export{rn as B,Un as H};
//# sourceMappingURL=Home-CCpS4jCg.js.map
