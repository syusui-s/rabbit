const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ZapReceipt-BHae6NUS.js","assets/index-uFFWEN2X.js","assets/index-BbW6KRtC.css","assets/useFollowings-B0SID4sG.js","assets/SideBar-B7q7RNUP.js","assets/resolveAsset-CJbXSIVP.js","assets/LazyLoad-BSv_GT0k.js","assets/SafeLink-B4KBTbL7.js","assets/url-DPIb-kBm.js","assets/lud16ToLnurlPayUrl-DDX0zc8I.js","assets/_baseClone-dC7r_k7R.js","assets/arrow-left-Qllz301_.js"])))=>i.map(i=>d[i]);
import{s as H,t as v,d as D,c as F,i as u,a as n,h as T,M as C,S as K,j as k,k as Q,l as ie,u as S,b as P,m as ue,n as ae,F as O,f as M,p as ee,q as E,r as G,v as me,w as ne,x as de,y as ge,z,o as V,A as te,B as ve,C as he,_ as fe,R as ye,D as $e,Z as xe,N as ke,E as we,G as be}from"./index-uFFWEN2X.js";import{u as X,a as oe,b as le,p as Ce,c as _e,r as Ie,t as Te,B as Se,d as Ee,H as pe,e as Le,f as Re,U as Me,g as Fe,h as Pe,i as De,j as ze,G as Be,M as Ne,k as Ue,S as qe,l as Ae,m as He}from"./SideBar-B7q7RNUP.js";import{A as Oe}from"./arrow-left-Qllz301_.js";import{u as p,T as j,a as je,b as Ke,C as Qe,c as A,E as Ge,d as Ve,e as B,L as N,f as Ze,g as We,h as Je,i as Xe,j as Ye,R as en,A as nn,H as tn}from"./useFollowings-B0SID4sG.js";import{t as on}from"./url-DPIb-kBm.js";const ln=v('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5m0 6a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5">'),re=(e={})=>(()=>{const t=ln();return H(t,e,!0),t})(),rn=v('<div class="flex flex-col"><div class="flex h-8 items-center gap-1"><h2 class="flex min-w-0 flex-1 items-center gap-1 ps-2"><span class=truncate></span></h2><button class="flex h-full place-items-center px-2"><span class="inline-block size-4">'),cn=v('<span class="inline-block size-4 shrink-0 text-fg-secondary">'),U=e=>{const[t,l]=F(!1),s=()=>l(o=>!o);return(()=>{const o=rn(),r=o.firstChild,c=r.firstChild,i=c.firstChild,a=c.nextSibling,d=a.firstChild;return u(c,n(T,{get when(){return e.icon},keyed:!0,children:g=>(()=>{const m=cn();return u(m,g),m})()}),i),u(i,()=>e.name),a.$$click=()=>s(),u(d,n(re,{})),u(o,n(T,{get when(){return t()},get children(){return e.settings()}}),null),o})()};D(["click"]);const sn=e=>{const t=[e.id],l=e.rootEvent()?.id;l!=null&&t.push(l);const s=e.replyingToEvent()?.id;return s!=null&&t.push(s),Q(t)},un=e=>{const{config:t}=k(),l=()=>ie(e.event),{events:s}=p(()=>({relayUrls:t().relayUrls,filters:[{kinds:[1],ids:sn(l()),limit:25},{kinds:[1],"#e":[e.event.id],limit:25}],limit:200}));return n(j,{get events(){return[...s()].reverse()}})},an=e=>n(K,{get children(){return n(C,{get when(){return e.timelineContent.type==="Replies"&&e.timelineContent},keyed:!0,children:t=>n(un,{get event(){return t.event}})})}}),mn=v('<div class="flex w-[80vw] shrink-0 snap-center snap-always flex-col border-r border-border sm:snap-align-none">'),dn=v('<div class="shrink-0 border-b border-border">'),gn=v('<div class="scrollbar flex flex-col overflow-y-scroll pb-16">'),vn=v('<div class="flex shrink-0 items-center border-b border-border px-2"><button class="flex w-full items-center gap-1"><div class="inline-block size-4"></div><div>'),hn=v('<div class="scrollbar flex max-h-full flex-col overflow-y-scroll scroll-smooth pb-16">'),L=e=>{let t;const l=je(),s=S(),o=()=>e.width??"medium";return X(()=>({commandType:"moveToColumn",handler:r=>{r.command==="moveToColumn"&&r.columnIndex===e.columnIndex&&t?.scrollIntoView({behavior:"smooth",inline:"center"})}})),X(()=>({commandType:"moveToLastColumn",handler:()=>{e.lastColumn&&t?.scrollIntoView({behavior:"smooth"})}})),n(Ke.Provider,{value:l,get children(){const r=mn(),c=t;return typeof c=="function"?ae(c,r):t=r,u(r,n(T,{get when(){return l.timelineState.content},keyed:!0,get fallback(){return[(()=>{const i=dn();return u(i,()=>e.header),i})(),(()=>{const i=gn();return u(i,()=>e.children),i})()]},children:i=>[(()=>{const a=vn(),d=a.firstChild,g=d.firstChild,m=g.nextSibling;return d.$$click=()=>l?.clearTimeline(),u(g,n(Oe,{})),u(m,()=>s.t("column.back")),a})(),(()=>{const a=hn();return u(a,n(an,{timelineContent:i})),a})()]})),P(i=>ue(r,{"sm:w-[500px]":o()==="widest","sm:w-[360px]":o()==="wide","sm:w-[320px]":o()==="medium","sm:w-[280px]":o()==="narrow"},i)),r}})};D(["click"]);const fn=v('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M15.75 19.5 8.25 12l7.5-7.5">'),yn=(e={})=>(()=>{const t=fn();return H(t,e,!0),t})(),$n=v('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0">'),xn=(e={})=>(()=>{const t=$n();return H(t,e,!0),t})(),kn=v('<div class="flex flex-col gap-2 border-b border-border p-2"><div></div><div>'),wn=v('<div class="scrollbar flex h-9 gap-2 overflow-x-auto">'),bn=v('<div class="flex flex-col border-t border-border"><div class="flex h-10 items-center gap-2"><button class="py-4 pl-2"><span class="inline-block size-4"></span></button><button class="py-4 pr-2"><span class="inline-block size-4"></span></button><div class=flex-1></div><button class="px-2 py-4 text-danger hover:text-rose-600"><span class="inline-block size-4">'),Cn=v('<button class="rounded-md border px-4 text-fg-secondary">'),ce=e=>(()=>{const t=kn(),l=t.firstChild,s=l.nextSibling;return u(l,()=>e.title),u(s,()=>e.children),t})(),R=e=>{const t=S(),{saveColumn:l,removeColumn:s,moveColumn:o}=k(),r=oe(),c=a=>{l({...e.column,width:a})},i=a=>{o(e.column.id,a),r({command:"moveToColumn",columnIndex:a}).catch(d=>console.error(d))};return(()=>{const a=bn(),d=a.firstChild,g=d.firstChild,m=g.firstChild,h=g.nextSibling,y=h.firstChild,_=h.nextSibling,x=_.nextSibling,w=x.firstChild;return u(a,n(ce,{get title(){return t.t("column.config.columnWidth")},get children(){const f=wn();return u(f,n(O,{each:["widest","wide","medium","narrow"],children:I=>(()=>{const b=Cn();return b.$$click=()=>c(I),u(b,()=>t.t(`column.config.${I}`)),P($=>{const q=e.column.width===I,Z=e.column.width===I,W=e.column.width!==I,J=e.column.width!==I;return q!==$._v$5&&b.classList.toggle("border-fg-secondary",$._v$5=q),Z!==$._v$6&&b.classList.toggle("font-bold",$._v$6=Z),W!==$._v$7&&b.classList.toggle("border-border",$._v$7=W),J!==$._v$8&&b.classList.toggle("font-normal",$._v$8=J),$},{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0}),b})()})),f}}),d),u(a,n(T,{get when(){return e.renderOtherSettings},keyed:!0,children:f=>f({column:e.column,saveColumn:l})}),d),g.$$click=()=>i(e.columnIndex-1),u(m,n(yn,{})),h.$$click=()=>i(e.columnIndex+1),u(y,n(Qe,{})),x.$$click=()=>s(e.column.id),u(w,n(xn,{})),P(f=>{const I=t.t("column.config.moveLeft"),b=t.t("column.config.moveRight"),$=t.t("column.config.removeColumn"),q=t.t("column.config.removeColumn");return I!==f._v$&&M(g,"title",f._v$=I),b!==f._v$2&&M(h,"title",f._v$2=b),$!==f._v$3&&M(x,"title",f._v$3=$),q!==f._v$4&&M(w,"aria-label",f._v$4=q),f},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),a})()};D(["click"]);const[Y,_n]=ee(()=>F({})),[In,Tn]=ee(()=>F({})),Sn=e=>{const t=le(),[l,s]=F(null);return E(()=>{const o=e();if(o==null)return;const{encrypted:r}=o;if(r in Y()){s(Y()[r]);return}const c=t();c!=null&&(In()[r]||(Tn(i=>({...i,[r]:!0})),window.nostr?.nip04?.decrypt?.(c,r)?.then(i=>{_n(a=>({...a,[r]:i})),s(i)}).catch(i=>{console.error(`failed to decrypt "${r}"`,i)})))}),l},En=e=>{const t=G(()=>me(e.event)),l=Sn(()=>{const{content:r}=t();return r==null||r.length===0?null:{id:t().id,encrypted:r}}),s=()=>{const r=l();if(r==null)return[];console.log(r);try{return Ce(r).taggedEventIds()}catch(c){return console.warn(c),[]}},o=()=>t().taggedEventIds();return n(O,{get each(){return[...o(),...s()]},children:r=>n(A,{get children(){return n(Ge,{eventId:r,get ensureKinds(){return[ne]}})}})})},pn=e=>{const t=de(),l=G(e),s=()=>["useFollowings",l()],o=ge(()=>({queryKey:s(),queryFn:({queryKey:c,signal:i})=>{console.debug("useFollowings");const[,a]=c;if(a==null)return Promise.resolve(null);const{kind:d,author:g,identifier:m}=a,h=new Se({type:"ParameterizedReplaceableEvent",kind:d,author:g,identifier:m}),y=h.firstEventPromise().catch(()=>{throw new Error(`parameterized replaceable event not found: ${d}:${g}:${m}`)});return h.onUpdate(_=>{const x=_e(_);t.setQueryData(c,x)}),Ie({task:h,signal:i}),Te(15e3,`useParameterizedReplaceableEvent: ${d}:${g}:${m}`)(y)},staleTime:5*60*1e3,gcTime:4*60*60*1e3}));return{event:()=>o.data??null,query:o}},Ln=e=>{const t=S(),{removeColumn:l}=k(),{event:s}=pn(()=>({kind:30001,author:e.column.pubkey,identifier:e.column.identifier}));return n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.bookmark")},get icon(){return n(Ee,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>l(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(T,{get when(){return s()},keyed:!0,children:o=>n(En,{event:o})})}})},Rn=e=>{const t=S(),{config:l,removeColumn:s}=k(),{followingPubkeys:o}=Ve(()=>({pubkey:e.column.pubkey})),r=B(()=>({duration:4*60*60})),{events:c,eose:i}=p(()=>{const a=Q([...o()]);return a.length===0?null:{debugId:"following",relayUrls:l().relayUrls,filters:[{kinds:[1,6],authors:a,limit:20,since:r.since(),until:r.until()}],eoseLimit:20,continuous:r.continuous(),onEOSE:()=>{console.log("home: eose")},clientEventFilter:d=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(d.content)}});return E(()=>{console.log("home",c()),r.setEvents(c())}),V(()=>console.log("home timeline mounted")),te(()=>console.log("home timeline unmounted")),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.home")},get icon(){return n(pe,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:r,get eose(){return i()},get children(){return n(j,{get events(){return c()}})}})}})},Mn=v('<svg xmlns=http://www.w3.org/2000/svg fill=none stroke=currentColor stroke-width=1.5 aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0m0 0c0 1.657 1.007 3 2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25">'),Fn=(e={})=>(()=>{const t=Mn();return H(t,e,!0),t})(),Pn=v('<svg xmlns=http://www.w3.org/2000/svg fill=currentColor aria-hidden=true data-slot=icon viewBox="0 0 24 24"><path fill-rule=evenodd d="M14.615 1.595a.75.75 0 0 1 .359.852L12.982 9.75h7.268a.75.75 0 0 1 .548 1.262l-10.5 11.25a.75.75 0 0 1-1.272-.71l1.992-7.302H3.75a.75.75 0 0 1-.548-1.262l10.5-11.25a.75.75 0 0 1 .913-.143"clip-rule=evenodd>'),Dn=(e={})=>(()=>{const t=Pn();return H(t,e,!0),t})(),zn=v('<div class="flex items-center gap-1 pl-[2px] text-sm"><div class="notification-icon flex max-w-[64px] place-items-center overflow-hidden"></div><div class="notification-user flex flex-1 gap-1 overflow-hidden"><div class="author-icon size-5 shrink-0 overflow-hidden rounded"></div><div class="flex min-w-0 flex-1 overflow-hidden"><button class="select-text truncate font-bold hover:text-link hover:underline"></button><span class="shrink-0 whitespace-pre"></span></div></div><div class=text-xs>'),Bn=v('<div class="notification-event py-1">'),Nn=v('<img alt=icon class="size-full object-cover">'),Un=v("<div class=truncate> "),qn=e=>{const t=S(),l=Ze(),{shouldMuteEvent:s}=k(),{showProfile:o}=Fe(),r=()=>ve(e.event),c=()=>r().lastTaggedEventId(),{profile:i}=Le(()=>({pubkey:e.event.pubkey})),{event:a,query:d}=We(()=>Re([c()])(([m])=>({eventId:m}))),g=()=>d.isSuccess&&a()==null;return n(T,{get when(){return G(()=>!g())()&&!s(e.event)},get children(){return[(()=>{const m=zn(),h=m.firstChild,y=h.nextSibling,_=y.firstChild,x=_.nextSibling,w=x.firstChild,f=w.nextSibling,I=y.nextSibling;return u(h,n(Je,{get reactionTypes(){return r().toReactionTypes()}})),u(_,n(T,{get when(){return i()?.picture},keyed:!0,children:b=>(()=>{const $=Nn();return P(()=>M($,"src",on(b,"icon"))),$})()})),w.$$click=()=>o(e.event.pubkey),u(w,n(Me,{get pubkey(){return e.event.pubkey}})),u(f,()=>t.t("notification.reacted")),u(I,()=>l(r().createdAtAsDate())),m})(),(()=>{const m=Bn();return u(m,n(T,{get when(){return a()},get fallback(){return(()=>{const h=Un(),y=h.firstChild;return u(h,()=>t.t("general.loading"),y),u(h,c,null),h})()},keyed:!0,children:h=>n(Xe,{event:h})})),m})()]}})};D(["click"]);const An=v("<div>unknown event"),Hn=he(()=>fe(()=>import("./ZapReceipt-BHae6NUS.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),se=e=>{const{shouldMuteEvent:t}=k();return n(O,{get each(){return e.events},children:l=>n(T,{get when(){return!t(l)},get children(){return n(K,{get fallback(){return An()},get children(){return[n(C,{get when(){return l.kind===ne},get children(){return n(A,{get children(){return n(Ye,{event:l})}})}}),n(C,{get when(){return l.kind===ye},get children(){return n(A,{get children(){return n(qn,{event:l})}})}}),n(C,{get when(){return l.kind===$e},get children(){return n(A,{get children(){return n(en,{event:l})}})}}),n(C,{get when(){return l.kind===xe},get children(){return n(A,{get children(){return n(Hn,{event:l})}})}})]}})}})})},On=v('<div class="flex gap-1">'),jn=v('<button type=button class="flex flex-1 flex-col items-center rounded-md border py-1 text-fg-secondary"><span class="inline-block size-4"></span><span class=text-xs>'),Kn={Replies:[1],Repost:[6],Reaction:[7],Zap:[9735]},Qn=e=>{const t=S(),l=[{notificationType:"Replies",title:t.t("column.notificationSettings.types.replies"),icon:n(Fn,{})},{notificationType:"Repost",title:t.t("column.notificationSettings.types.reposts"),icon:n(nn,{})},{notificationType:"Reaction",title:t.t("column.notificationSettings.types.reactions"),icon:n(tn,{})},{notificationType:"Zap",title:t.t("column.notificationSettings.types.zap"),icon:n(Dn,{})}],s=()=>e.column.notificationTypes??[...ke],o=c=>s().includes(c),r=c=>{const i=[...s()];o(c)?i.splice(i.indexOf(c),1):i.push(c),e.saveColumn({...e.column,notificationTypes:i})};return n(ce,{get title(){return t.t("column.notificationSettings.notificationTypes")},get children(){const c=On();return u(c,n(O,{each:l,children:({notificationType:i,title:a,icon:d})=>(()=>{const g=jn(),m=g.firstChild,h=m.nextSibling;return g.$$click=()=>r(i),M(g,"title",a),u(m,d),u(h,a),P(y=>{const _=!!o(i),x=!!o(i),w=!o(i),f=!o(i);return _!==y._v$&&g.classList.toggle("border-fg-secondary",y._v$=_),x!==y._v$2&&g.classList.toggle("font-bold",y._v$2=x),w!==y._v$3&&g.classList.toggle("border-border",y._v$3=w),f!==y._v$4&&g.classList.toggle("font-normal",y._v$4=f),y},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),g})()})),c}})},Gn=e=>{const t=S(),{config:l,removeColumn:s}=k(),o=B(()=>({duration:null})),r=()=>e.column.notificationTypes??[],c=()=>Q(r().flatMap(d=>Kn[d])),{events:i,eose:a}=p(()=>c().length>0?{relayUrls:l().relayUrls,filters:[{kinds:c(),"#p":[e.column.pubkey],limit:20,since:o.since(),until:o.until()}],eoseLimit:20,clientEventFilter:d=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(d.content)}:null);return E(()=>o.setEvents(i())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.notification")},get icon(){return n(Pe,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex},renderOtherSettings:Qn}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:o,get eose(){return a()},get children(){return n(se,{get events(){return i()}})}})}})};D(["click"]);const Vn=e=>{const t=S(),{config:l,removeColumn:s}=k(),o=B(()=>({duration:null})),{events:r,eose:c}=p(()=>({relayUrls:l().relayUrls,filters:[{kinds:[1,6],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(i.content)}));return E(()=>o.setEvents(r())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.posts")},get icon(){return n(De,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:o,get eose(){return c()},get children(){return n(j,{get events(){return r()}})}})}})},Zn=e=>{const t=S(),{config:l,removeColumn:s}=k(),o=B(()=>({duration:null})),{events:r,eose:c}=p(()=>({relayUrls:l().relayUrls,filters:[{kinds:[7],authors:[e.column.pubkey],limit:10,since:o.since(),until:o.until()}],eoseLimit:10,clientEventFilter:i=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(i.content)}));return E(()=>o.setEvents(r())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.reactions")},get icon(){return n(ze,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>s(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:o,get eose(){return c()},get children(){return n(se,{get events(){return r()}})}})}})},Wn=e=>{const t=S(),{removeColumn:l}=k(),s=B(()=>({duration:4*60*60})),{events:o,eose:r}=p(()=>({relayUrls:e.column.relayUrls,filters:[{kinds:[1],limit:20,since:s.since(),until:s.until()}],eoseLimit:20,clientEventFilter:c=>e.column.contentFilter==null?!0:z(e.column.contentFilter)(c.content)}));return E(()=>s.setEvents(o())),n(L,{get header(){return n(U,{get name(){return e.column.name??t.t("column.relay")},get icon(){return n(Be,{})},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>l(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:s,get eose(){return r()},get children(){return n(j,{get events(){return o()}})}})}})},Jn=v('<div class="flex flex-col"><div class="flex h-8 items-center gap-1 px-2"><h2 class="flex items-center gap-1"><span class="inline-block size-4 text-fg-secondary"></span></h2><form class=flex-1><input class="w-full rounded border border-border bg-bg px-1 py-0 ring-border focus:border-border focus:ring-primary"type=text name=query></form><button class=size-4>'),Xn=e=>{const[t,l]=F(!1),[s,o]=F(""),{saveColumn:r}=k(),c=()=>l(m=>!m),i=()=>{s()!==e.column.query&&r({...e.column,query:s()})},a=()=>{i()},d=m=>{o(m.currentTarget.value)},g=m=>{m.preventDefault(),i()};return V(()=>{o(e.column.query)}),(()=>{const m=Jn(),h=m.firstChild,y=h.firstChild,_=y.firstChild,x=y.nextSibling,w=x.firstChild,f=x.nextSibling;return u(_,n(Ne,{})),x.addEventListener("submit",g),w.addEventListener("blur",a),w.addEventListener("change",d),f.$$click=()=>c(),u(f,n(re,{})),u(m,n(T,{get when(){return t()},get children(){return e.settings()}}),null),P(()=>w.value=s()),m})()},Yn=e=>{const{removeColumn:t}=k(),l=B(()=>({duration:null})),{events:s,eose:o}=p(()=>{const{query:r}=e.column;return r.length===0?null:{relayUrls:we,filters:[{kinds:[1],search:r,limit:20,since:l.since(),until:l.until()}],eoseLimit:20,clientEventFilter:c=>c.tags.findIndex(([i])=>i==="mostr"||i==="proxy")>=0?!1:e.column.contentFilter==null?!0:z(e.column.contentFilter)(c.content)}});return E(()=>{l.setEvents(s())}),n(L,{get header(){return n(Xn,{get column(){return e.column},settings:()=>n(R,{get column(){return e.column},get columnIndex(){return e.columnIndex}}),onClose:()=>t(e.column.id)})},get width(){return e.column.width},get columnIndex(){return e.columnIndex},get lastColumn(){return e.lastColumn},get children(){return n(N,{loadMore:l,get eose(){return o()},get children(){return n(j,{get events(){return s()}})}})}})};D(["click"]);const et=v('<div class="scrollbar flex h-full snap-x snap-mandatory flex-row overflow-x-scroll scroll-smooth">'),nt=()=>{const{config:e}=k();return(()=>{const t=et();return u(t,n(O,{get each(){return e().columns},children:(l,s)=>{const o=()=>s()+1,r=()=>o()===e().columns.length;return n(K,{get children(){return[n(C,{get when(){return l.columnType==="Following"&&l},keyed:!0,children:c=>n(Rn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Notification"&&l},keyed:!0,children:c=>n(Gn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Posts"&&l},keyed:!0,children:c=>n(Vn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Reactions"&&l},keyed:!0,children:c=>n(Zn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Relays"&&l},keyed:!0,children:c=>n(Wn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Bookmark"&&l},keyed:!0,children:c=>n(Ln,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})}),n(C,{get when(){return l.columnType==="Search"&&l},keyed:!0,children:c=>n(Yn,{column:c,get columnIndex(){return o()},get lastColumn(){return r()}})})]}})}})),t})()},tt=[{key:"n",command:{command:"openPostForm"}},{key:"h",command:{command:"moveToPrevColumn"}},{key:"j",command:{command:"moveToNextItem"}},{key:"k",command:{command:"moveToPrevItem"}},{key:"l",command:{command:"moveToNextColumn"}},{key:"1",command:{command:"moveToColumn",columnIndex:1}},{key:"2",command:{command:"moveToColumn",columnIndex:2}},{key:"3",command:{command:"moveToColumn",columnIndex:3}},{key:"4",command:{command:"moveToColumn",columnIndex:4}},{key:"5",command:{command:"moveToColumn",columnIndex:5}},{key:"6",command:{command:"moveToColumn",columnIndex:6}},{key:"7",command:{command:"moveToColumn",columnIndex:7}},{key:"8",command:{command:"moveToColumn",columnIndex:8}},{key:"9",command:{command:"moveToColumn",columnIndex:9}},{key:"0",command:{command:"moveToLastColumn"}},{key:"ArrowLeft",command:{command:"moveToPrevColumn"}},{key:"ArrowDown",command:{command:"moveToNextItem"}},{key:"ArrowUp",command:{command:"moveToPrevItem"}},{key:"ArrowRight",command:{command:"moveToNextColumn"}},{key:"f",command:{command:"like"}},{key:"t",command:{command:"repost"}},{key:"r",command:{command:"openReplyForm"}},{key:"?",command:{command:"openHelp"}},{key:"Enter",command:{command:"openItemDetail"}},{key:"Backspace",command:{command:"closeItemDetail"}}],ot=e=>{const t=new Map;return e.forEach(l=>{t.set(l.key,l)}),t},lt=({shortcuts:e=tt,onShortcut:t})=>{const l=ot(e);V(()=>{const s=Ue(o=>{if(o.type!=="keydown"||o.ctrlKey||o.altKey||o.metaKey||o.target instanceof HTMLTextAreaElement||o.target instanceof HTMLInputElement)return;const r=l.get(o.key);r!=null&&t(r)},50);window.addEventListener("keydown",s),te(()=>{window.removeEventListener("keydown",s)})})},rt=()=>{const e=oe();lt({onShortcut:t=>{e(t.command).then(()=>console.debug(`shortcut key '${t.key}' was processed successfully`),l=>console.error(l))}})},ct=v('<div class="absolute inset-0 flex h-svh w-screen touch-manipulation flex-row overflow-hidden">'),st=()=>{rt();const e=He(),{config:t,initializeColumns:l}=k(),s=le();return E(()=>{Promise.allSettled(t().relayUrls.map(async o=>{try{const r=await e().ensureRelay(o);r.onnotice=c=>{console.error(`NOTICE: ${o}: ${c}`)},r.onclose=()=>{console.warn(`CLOSE: ${o}`)}}catch(r){console.error("ensureRelay failed",r)}})).catch(()=>{})}),E(()=>{const o=s();o!=null&&l({pubkey:o})}),be(o=>{console.error("uncaught error: ",o)}),(()=>{const o=ct();return u(o,n(qe,{}),null),u(o,n(nt,{}),null),u(o,n(Ae,{}),null),o})()},gt=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"}));export{Dn as B,gt as H};
//# sourceMappingURL=Home-Dd0KpmNT.js.map
