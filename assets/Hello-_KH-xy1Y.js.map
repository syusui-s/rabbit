{"version":3,"file":"Hello-_KH-xy1Y.js","sources":["../../src/pages/Hello.tsx"],"sourcesContent":["import { createSignal, onMount, For, Switch, Match, type Component } from 'solid-js';\n\nimport { useNavigate } from '@solidjs/router';\nimport { UAParser } from 'ua-parser-js';\n\nimport SafeLink from '@/components/utils/SafeLink';\nimport usePersistStatus from '@/hooks/usePersistStatus';\nimport { useTranslation } from '@/i18n/useTranslation';\nimport resolveAsset from '@/utils/resolveAsset';\n\ntype SignerStatus = 'checking' | 'available' | 'unavailable';\n\nconst Browsers = ['pc-chrome', 'pc-firefox', 'ios', 'android'] as const;\n\ntype Browser = (typeof Browsers)[number];\n\ntype ExtensionDefinition = {\n  name: string;\n  url: string;\n  browsers: Browser[];\n  guides: {\n    title: string;\n    url: string;\n    lang: 'ja' | 'en';\n  }[];\n};\n\nconst BrowserToString: Record<Browser, string> = {\n  'pc-chrome': 'Chrome',\n  'pc-firefox': 'Firefox',\n  ios: 'iOS',\n  android: 'Android',\n};\n\nconst browserAsString = (browser: Browser) => BrowserToString[browser];\n\nconst Extensions: ExtensionDefinition[] = [\n  {\n    name: 'nos2x',\n    url: 'https://chrome.google.com/webstore/detail/nos2x/kpgefcfmnafjgpblomihpgmejjdanjjp',\n    browsers: ['pc-chrome', 'android'],\n    guides: [\n      {\n        title: 'nos2xのセットアップと使い方',\n        url: 'https://scrapbox.io/nostr/nos2x%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E3%81%A8%E4%BD%BF%E3%81%84%E6%96%B9',\n        lang: 'ja',\n      },\n    ],\n  },\n  {\n    name: 'nos2x-fox',\n    browsers: ['pc-firefox', 'android'],\n    url: 'https://addons.mozilla.org/firefox/addon/nos2x-fox/',\n    guides: [\n      {\n        title: 'nos2x-foxのセットアップと使い方',\n        url: 'https://scrapbox.io/nostr/nos2x-fox%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97%E3%81%A8%E4%BD%BF%E3%81%84%E6%96%B9',\n        lang: 'ja',\n      },\n    ],\n  },\n  {\n    name: 'nostore',\n    browsers: ['ios'],\n    url: 'https://apps.apple.com/jp/app/nostore/id1666553677',\n    guides: [\n      {\n        title: 'nostore(iOS Safari用NIP-07拡張機能)のセットアップ',\n        url: 'https://scrapbox.io/nostr/nostore(iOS_Safari%E7%94%A8NIP-07%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD)%E3%81%AE%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97',\n        lang: 'ja',\n      },\n    ],\n  },\n];\n\nconst useSignerStatus = () => {\n  const [signerStatus, setSignerStatus] = createSignal<SignerStatus>('checking');\n\n  const checkStatus = () => {\n    if (window.nostr != null) {\n      setSignerStatus('available');\n    } else {\n      setSignerStatus('unavailable');\n    }\n  };\n\n  onMount(() => {\n    let count = 0;\n    const intervalId = setInterval(() => {\n      checkStatus();\n      if (count >= 10) clearInterval(intervalId);\n      count += 1;\n    }, 1000);\n  });\n\n  return signerStatus;\n};\n\nconst getBrowsers = () => {\n  const parsed = UAParser(window.navigator.userAgent);\n  const result = new Set<Browser>();\n  if (parsed.os.name === 'Android') result.add('android');\n  if (parsed.os.name === 'iOS') result.add('ios');\n  if (\n    (parsed.device.type === undefined || parsed.device.type === 'console') &&\n    (parsed.browser.name === 'Chromium' ||\n      parsed.browser.name === 'Chrome' ||\n      parsed.browser.name === 'Vivaldi' ||\n      parsed.browser.name === 'Brave')\n  )\n    result.add('pc-chrome');\n  if (parsed.browser.name === 'Firefox') result.add('pc-firefox');\n  return result;\n};\n\nconst ExtensionList = () => {\n  const [selectedBrowsers, setSelectedBrowsers] = createSignal(getBrowsers());\n  const toggleBrowser = (browser: Browser) =>\n    setSelectedBrowsers((current) => {\n      const newSet = new Set(current);\n      if (!newSet.has(browser)) newSet.add(browser);\n      else newSet.delete(browser);\n      return newSet;\n    });\n\n  const extensions = (): ExtensionDefinition[] => {\n    const browsers = selectedBrowsers();\n    if (browsers.size === 0) return Extensions;\n    return Extensions.filter((extension) =>\n      extension.browsers.some((browser) => browsers.has(browser)),\n    );\n  };\n\n  return (\n    <div>\n      <div class=\"pt-2\">\n        <ul class=\"flex gap-1\">\n          <For each={Browsers}>\n            {(browser) => (\n              <li>\n                <button\n                  class=\"rounded-xl border px-2 text-sm\"\n                  classList={{\n                    'border-fg': selectedBrowsers().has(browser),\n                    'font-bold': selectedBrowsers().has(browser),\n                    'text-fg': selectedBrowsers().has(browser),\n                    'border-border': !selectedBrowsers().has(browser),\n                    'font-normal': !selectedBrowsers().has(browser),\n                    'text-fg-secondary': !selectedBrowsers().has(browser),\n                  }}\n                  type=\"button\"\n                  onClick={() => toggleBrowser(browser)}\n                >\n                  {browserAsString(browser)}\n                </button>\n              </li>\n            )}\n          </For>\n        </ul>\n      </div>\n      <div>\n        <For each={extensions()}>\n          {(extension) => (\n            <div class=\"my-2 rounded-lg border border-border p-2 hover:shadow\">\n              <div>\n                <SafeLink class=\"font-bold hover:text-fg-secondary\" href={extension.url}>\n                  <h3>{extension.name}</h3>\n                </SafeLink>\n                <div class=\"flex items-center\">\n                  <ul class=\"flex items-center gap-1 text-xs\">\n                    <For each={extension.guides}>\n                      {(guide) => (\n                        <li class=\"text-link underline\">\n                          <SafeLink href={guide.url}>{guide.title}</SafeLink>\n                        </li>\n                      )}\n                    </For>\n                  </ul>\n                </div>\n                <ul class=\"flex gap-1 pt-1 text-xs\">\n                  <For each={extension.browsers}>\n                    {(browser) => (\n                      <li class=\"rounded-lg border border-border px-1 text-fg-secondary\">\n                        {browserAsString(browser)}\n                      </li>\n                    )}\n                  </For>\n                </ul>\n              </div>\n            </div>\n          )}\n        </For>\n      </div>\n    </div>\n  );\n};\n\nconst Hello: Component = () => {\n  const i18n = useTranslation();\n  const signerStatus = useSignerStatus();\n  const navigate = useNavigate();\n  const { persistStatus, loggedIn } = usePersistStatus();\n\n  const handleLogin = () => {\n    loggedIn();\n    navigate('/');\n  };\n\n  onMount(() => {\n    if (persistStatus().loggedIn) {\n      navigate('/');\n    }\n  });\n\n  return (\n    <div class=\"mx-auto flex max-w-[640px] flex-col items-center p-4 text-fg\">\n      <div class=\"flex flex-col items-center gap-4 rounded p-4\">\n        <img src={resolveAsset('images/rabbit_256.png')} width=\"96\" alt=\"logo\" height=\"96\" />\n        <h1 class=\"text-5xl font-black text-primary\">Rabbit</h1>\n        <div>Rabbit is a Web client for Nostr.</div>\n      </div>\n      <div class=\"rounded-md p-8 shadow-md\">\n        <Switch>\n          <Match when={signerStatus() === 'checking'}>\n            <p>{i18n()('hello.signerChecking')}</p>\n          </Match>\n          <Match when={signerStatus() === 'unavailable'}>\n            <h2 class=\"font-bold\">{i18n()('hello.signerUnavailable')}</h2>\n            <p>{i18n()('hello.signerUnavailableMessage')}</p>\n            <ExtensionList />\n          </Match>\n          <Match when={signerStatus() === 'available'}>\n            <button\n              class=\"rounded bg-primary p-4 text-lg font-bold text-primary-fg hover:shadow-md\"\n              onClick={handleLogin}\n            >\n              {i18n()('hello.loginWithSigner')}\n            </button>\n          </Match>\n        </Switch>\n      </div>\n    </div>\n  );\n};\n\nexport default Hello;\n"],"names":["Browsers","BrowserToString","ios","android","browserAsString","browser","Extensions","name","url","browsers","guides","title","lang","useSignerStatus","signerStatus","setSignerStatus","createSignal","checkStatus","window","nostr","onMount","count","intervalId","setInterval","clearInterval","getBrowsers","parsed","UAParser","navigator","userAgent","result","Set","os","add","device","type","undefined","ExtensionList","selectedBrowsers","setSelectedBrowsers","toggleBrowser","current","newSet","has","delete","extensions","size","filter","extension","some","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_$insert","_$createComponent","For","each","children","_el$5","_tmpl$2","_el$6","$$click","_$effect","_p$","_v$","_v$2","_v$3","_v$4","_v$5","_v$6","classList","toggle","_el$7","_tmpl$4","_el$8","_el$10","_el$11","_el$12","SafeLink","href","_el$9","_tmpl$3","guide","_el$13","_tmpl$5","_el$14","_tmpl$6","Hello","i18n","useTranslation","navigate","useNavigate","persistStatus","loggedIn","usePersistStatus","handleLogin","_el$15","_tmpl$10","_el$16","_el$17","_el$18","Switch","Match","when","_el$19","_tmpl$7","_el$20","_tmpl$8","_el$21","_el$22","_tmpl$9","_$setAttribute","resolveAsset","_$delegateEvents"],"mappings":"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"}